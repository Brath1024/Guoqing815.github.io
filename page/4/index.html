<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Brath-Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Brath-Blog"><meta name="msapplication-TileImage" content="https://brath.cloud/me.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Brath-Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Brath-Blog"><meta property="og:url" content="http://example.com/"><meta property="og:site_name" content="Brath-Blog"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://example.com/img/og_image.png"><meta property="article:author" content="Brath"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://example.com/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com"},"headline":"Brath-Blog","image":["http://example.com/img/og_image.png"],"author":{"@type":"Person","name":"Brath"},"publisher":{"@type":"Organization","name":"Brath-Blog","logo":{"@type":"ImageObject","url":"https://brath.cloud/me.png"}},"description":""}</script><link rel="icon" href="https://brath.cloud/me.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://brath.cloud/me.png" alt="Brath-Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">文章列表</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">更多</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Guoqing815"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-03-02T05:23:32.725Z" title="2023-3-2 13:23:32">2023-03-02</time>发表</span><span class="level-item"><time dateTime="2023-03-02T05:25:02.659Z" title="2023-3-2 13:25:02">2023-03-02</time>更新</span><span class="level-item">4 分钟读完 (大约591个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/03/02/%E3%80%90Java%E3%80%91SpringBoot%E6%95%B4%E5%90%88knife4j%E6%A1%86%E6%9E%B6(%E5%8F%AF%E7%94%9F%E6%88%90%E7%A6%BB%E7%BA%BF%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3)%EF%BC%8C%E5%B9%B6%E8%AE%BE%E7%BD%AE%E6%8E%A5%E5%8F%A3%E8%AF%B7%E6%B1%82%E5%A4%B4token%E9%BB%98%E8%AE%A4%E5%80%BC/">SpringBoot整合knife4j框架(可生成离线接口文档)，并设置接口请求头token默认值</a></p><div class="content"><h1 id="springboot整合knife4j框架可生成离线接口文档并设置接口请求头token默认值"><a class="markdownIt-Anchor" href="#springboot整合knife4j框架可生成离线接口文档并设置接口请求头token默认值">#</a> SpringBoot 整合 knife4j 框架 (可生成离线接口文档)，并设置接口请求头 token 默认值</h1>
<p>功能和 swagger 类似</p>
<p>官网地址：<a target="_blank" rel="noopener" href="https://doc.xiaominfo.com/knife4j/">https://doc.xiaominfo.com/knife4j/</a></p>
<p>引入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.xiaoymin<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>knife4j-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Knife4jConfig .java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.env.Environment;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.env.Profiles;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.ParameterBuilder;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.RequestHandlerSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.schema.ModelRef;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.ApiInfo;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.Contact;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.Parameter;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spi.DocumentationType;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spring.web.plugins.Docket;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.swagger2.annotations.EnableSwagger2; <span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List; <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yvioo。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span>  <span class="comment">//开启Swagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Knife4jConfig</span> &#123;     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置Swagger的Docket的bean实例</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Docket <span class="title function_">docket</span><span class="params">(Environment environment)</span> &#123;         <span class="comment">//设置只在开发中环境中启动swagger</span></span><br><span class="line">        Profiles profiles=Profiles.of(<span class="string">&quot;dev&quot;</span>);         <span class="comment">//表示如果现在是dev环境，则返回true 开启swagger</span></span><br><span class="line">        <span class="type">boolean</span> flag=environment.acceptsProfiles(profiles);         <span class="comment">/*添加接口请求头参数配置 没有的话 可以忽略*/</span></span><br><span class="line">        <span class="type">ParameterBuilder</span> <span class="variable">tokenPar</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ParameterBuilder</span>();</span><br><span class="line">        List&lt;Parameter&gt; pars = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        tokenPar.name(<span class="string">&quot;token&quot;</span>).description(<span class="string">&quot;令牌&quot;</span>).defaultValue(<span class="string">&quot;设置token默认值&quot;</span>).modelRef(<span class="keyword">new</span> <span class="title class_">ModelRef</span>(<span class="string">&quot;string&quot;</span>)).parameterType(<span class="string">&quot;header&quot;</span>).required(<span class="literal">false</span>).build();</span><br><span class="line">        pars.add(tokenPar.build());         <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo())</span><br><span class="line">                <span class="comment">//是否启动swagger 默认启动</span></span><br><span class="line">                .enable(flag)</span><br><span class="line">                <span class="comment">//所在分组</span></span><br><span class="line">                .groupName(<span class="string">&quot;yvioo&quot;</span>)</span><br><span class="line">                .select()</span><br><span class="line">                <span class="comment">//指定扫描的包路径</span></span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.example.demo.controller&quot;</span>))</span><br><span class="line">                <span class="comment">//指定扫描的请求，这里表示扫描 /hello/ 的请求</span></span><br><span class="line">                <span class="comment">//.paths(PathSelectors.ant(&quot;/hello/**&quot;))</span></span><br><span class="line">                .build()</span><br><span class="line">                .globalOperationParameters(pars);</span><br><span class="line">    &#125;     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置ApiInfo信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> ApiInfo <span class="title function_">apiInfo</span><span class="params">()</span> &#123;         <span class="comment">//作者信息</span></span><br><span class="line">        <span class="type">Contact</span> <span class="variable">author</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Contact</span>(<span class="string">&quot;yvioo&quot;</span>, <span class="string">&quot;https://www.cnblogs.com/pxblog/&quot;</span>, <span class="string">&quot;111@qq.com&quot;</span>);         <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ApiInfo</span>(</span><br><span class="line">                <span class="string">&quot;Knife4j测试&quot;</span>,</span><br><span class="line">                <span class="string">&quot;Knife4j描述&quot;</span>,</span><br><span class="line">                <span class="string">&quot;1.0&quot;</span>,</span><br><span class="line">                <span class="string">&quot;urn:tos&quot;</span>,</span><br><span class="line">                author,</span><br><span class="line">                <span class="string">&quot;Apache 2.0&quot;</span>,</span><br><span class="line">                <span class="string">&quot;http://www.apache.org/licenses/LICENSE-2.0&quot;</span>,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ArrayList</span>()</span><br><span class="line">        );     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>控制器的写法和 swagger 基本类似</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Api(tags = &quot;首页模块&quot;)</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IndexController</span> &#123;     <span class="meta">@ApiImplicitParam(name = &quot;name&quot;,value = &quot;姓名&quot;,required = true)</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;向客人问好&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/sayHi&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;String&gt; <span class="title function_">sayHi</span><span class="params">(<span class="meta">@RequestParam(value = &quot;name&quot;)</span>String name)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.ok(<span class="string">&quot;Hi:&quot;</span>+name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是如果有其他配置继承了 WebMvcConfigurationSupport 就需要增加资源映射 不然会失效</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebMvcConfigurer</span> <span class="keyword">extends</span> <span class="title class_">WebMvcConfigurationSupport</span> &#123;     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发现如果继承了WebMvcConfigurationSupport， 需要重新指定静态资源</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;/**&quot;</span>).addResourceLocations(</span><br><span class="line">                <span class="string">&quot;classpath:/static/&quot;</span>);</span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;doc.html&quot;</span>).addResourceLocations(</span><br><span class="line">                <span class="string">&quot;classpath:/META-INF/resources/&quot;</span>);</span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;/webjars/**&quot;</span>).addResourceLocations(</span><br><span class="line">                <span class="string">&quot;classpath:/META-INF/resources/webjars/&quot;</span>);</span><br><span class="line">        <span class="built_in">super</span>.addResourceHandlers(registry);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>效果</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/1092624-20210531140148243-852424753.png" alt="img"></p>
<p>离线接口文档</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/1092624-20210531141839463-1322211712.png" alt="img"></p>
<p>浏览器访问</p>
<p>使用 dev 环境 启动项目后 浏览器打开 http://localhost:8081/doc.html#/  我这里用的端口是 8081</p>
<p>整合 swagger 框架参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/pxblog/p/12942825.html">https://www.cnblogs.com/pxblog/p/12942825.html</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-03-02T04:45:17.527Z" title="2023-3-2 12:45:17">2023-03-02</time>发表</span><span class="level-item"><time dateTime="2023-03-02T04:44:42.278Z" title="2023-3-2 12:44:42">2023-03-02</time>更新</span><span class="level-item">8 分钟读完 (大约1185个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/03/02/%E3%80%90ELK%E3%80%91%E4%BD%BF%E7%94%A8Docker%E6%90%AD%E5%BB%BAELK/">【ELK】使用Docker搭建ELK</a></p><div class="content"><h3 id="文章目录"><a class="markdownIt-Anchor" href="#文章目录">#</a> 文章目录</h3>
<ul>
<li>
<ul>
<li><a href="#_1">概念：</a></li>
<li><a href="#elkdocker_7">安装 elk (这里通过 docker 进行安装)</a></li>
<li>
<ul>
<li>
<ul>
<li><a href="#es_8">安装 es</a></li>
<li><a href="#kikana_35">安装 kikana</a></li>
<li><a href="#logstash_59">安装 logstash</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="概念"><a class="markdownIt-Anchor" href="#概念">#</a> 概念：</h2>
<blockquote>
<p>那么，<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=ELK&amp;spm=1001.2101.3001.7020">ELK</a> 到底是什么呢？ “ELK” 是三个开源项目的首字母缩写，这三个项目分别是：Elasticsearch、Logstash 和 Kibana。Elasticsearch 是一个搜索和分析引擎。Logstash 是服务器端数据处理管道，能够同时从多个来源采集数据，转换数据，然后将数据发送到诸如 Elasticsearch 等 “存储库” 中。Kibana 则可以让用户在 Elasticsearch 中使用图形和图表对数据进行可视化</p>
</blockquote>
<ul>
<li>工作流程<br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/18dbff4e772c4bff918a06fc22562782.png" alt="在这里插入图片描述"></li>
<li>在后续 elk 引入了 beats (数据采集器) 后被称为 Elastic Stack 或者 ELK</li>
</ul>
<h2 id="安装elk这里通过docker进行安装"><a class="markdownIt-Anchor" href="#安装elk这里通过docker进行安装">#</a> 安装 elk (这里通过 docker 进行安装)</h2>
<h4 id="安装es"><a class="markdownIt-Anchor" href="#安装es">#</a> 安装 es</h4>
<ul>
<li>在 dockerhub 上搜索 es<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/6f76e4d9d5504501902ef113cc4bbc69.png" alt="在这里插入图片描述"></li>
<li>找到需要的 es 版本<br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/6d5331d1e29649c8b784fd82a01a078c.png" alt="在这里插入图片描述"></li>
<li>拉取 es 镜像 <code>docker pull elasticsearch:tag</code> <br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/da59ef5b031243f094ef24340170bb99.png" alt="在这里插入图片描述"><br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/44544fc5864a4db7a11b4864768446f4.png" alt="在这里插入图片描述"></li>
<li>在 dockerhub 官网上可以看到 es 的启动命令<br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/d0a24c581d37472b9f6b51e2946902c3.png" alt="在这里插入图片描述"></li>
<li>先创建自定义 docker 网络 <code>docker network create elastic</code> ，默认是桥接模式<br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/2e96d2e71e594a28bfbf5c14a7e50bbc.png" alt="在这里插入图片描述"></li>
<li>查看创建的网络<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/1335acab2ae14d908a9c70249c11d1a8.png" alt="在这里插入图片描述"></li>
<li>启动 es 镜像，这里我以单机的形式启动 <code>docker run -d --name elasticsearch --net elastic -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; elasticsearch:tag</code> <br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/cab7b5b16f7444f98587b73977f5784f.png" alt="在这里插入图片描述"></li>
<li>启动之后访问 <code>localhost:9200</code> ，有数据返回说明启动成功，如下图<br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/b007a9897a384d45b4f99719a8e80d2b.png" alt="在这里插入图片描述"></li>
<li>修改 es 配置，进入容器 <code>docker exec -it a804 /bin/sh</code> <br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/f3b2629fdf69469eb752ce1b23d60ab5.png" alt="在这里插入图片描述"></li>
<li>在 <code>config</code>  目录下的 <code>elasticsearch.yml</code>  文件添加</li>
</ul>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">http.cors.enabled:</span> <span class="literal">true</span> </span><br><span class="line"><span class="attr">http.cors.allow-origin:</span> <span class="string">&quot;*&quot;</span></span><br><span class="line"><span class="number">12</span></span><br></pre></td></tr></table></figure>
<ul>
<li>修改完配置之后，退出容器并重启<br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/18e0f04b59144d16bf0c19f730cbfe72.png" alt="在这里插入图片描述"></li>
</ul>
<h4 id="安装kikana"><a class="markdownIt-Anchor" href="#安装kikana">#</a> 安装 kikana</h4>
<ul>
<li>从 dockerhub 拉取与 es 对应版本的 kibana  <code>docker pull kibana:tag</code> <br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/786540852f3848ef91b6dc9172c62e06.png" alt="在这里插入图片描述"></li>
<li>启动 kibana  <code>docker run --name kib-7.6 --net elastic -d -p 5601:5601 kibana:tag</code></li>
<li>启动之后访问<br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/aed86ba45de34bbdb960c67a10eba2e1.png" alt="在这里插入图片描述"></li>
<li>出现上图是由于 kibanakibana.yml，默认的地址是 http://elasticsearch:9200, 需要修改为 es 服务 ip</li>
<li>进入到 es 容器里面 <code>docker -it 容器编号 /bin/sh</code> <br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/30cda118f3b344b6ac611f143d8cb941.png" alt="在这里插入图片描述"></li>
<li>查看 es 的容器详情 <code>docker inspect a80402dbe9f5</code></li>
<li>找到网络详情，找到 es 服务的 ip 地址<br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/810fc12347fd4c4fbb02cb2ca219e4d6.png" alt="在这里插入图片描述"></li>
<li>也可以通过 <code>docker inspect -f '&#123;&#123;range .NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;' a804</code>  获取 ip<br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/61ff14db933c4b4889fa6d6eb5d6d17d.png" alt="在这里插入图片描述"></li>
<li>进入到 kibana 容器，切换到 <code>/usr/share/kibana/config</code>  目录<br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/41867b50de204c558b90c08d0fdd8e88.png" alt="在这里插入图片描述"></li>
<li>修改 kibana.yml 文件<br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/0941ebe9bb9445aa9e715440a490e0a2.png" alt="在这里插入图片描述"><br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/3f1b21a66c2b48a8bc46e391f39a1fa6.png" alt="在这里插入图片描述"></li>
<li>修改完 kibana.yml 之后重启 kibana 容器</li>
<li>访问 kibana <code>localhost:5601</code> <br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/b179a708ace346fca404be4c1ada73ef.png" alt="在这里插入图片描述"><br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/d0756690b86f4f57be7919f08210b388.png" alt="在这里插入图片描述"></li>
<li>到这里 kibana 就安装成功了</li>
</ul>
<h4 id="安装logstash"><a class="markdownIt-Anchor" href="#安装logstash">#</a> 安装<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=logstash&amp;spm=1001.2101.3001.7020"> logstash</a></h4>
<ul>
<li>从 dockerhub 拉取 logstash <code>docker pull logstash:7.6.2</code> <br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/b1ec7cb4c13b48a188e45bcd0d125d58.png" alt="在这里插入图片描述"></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-03-02T03:15:01.797Z" title="2023-3-2 11:15:01">2023-03-02</time>发表</span><span class="level-item"><time dateTime="2023-03-02T03:44:54.269Z" title="2023-3-2 11:44:54">2023-03-02</time>更新</span><span class="level-item">18 分钟读完 (大约2721个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/03/02/%E3%80%90MYSQL%E3%80%91%E6%B0%B4%E5%B9%B3%E5%88%86%E8%A1%A8%E3%80%81%E5%88%86%E5%BA%93%E5%92%8C%E5%9E%82%E7%9B%B4%E5%88%86%E8%A1%A8%E3%80%81%E5%88%86%E5%BA%93%E5%92%8C%E5%85%AC%E5%85%B1%E8%A1%A8%E7%9A%84%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%92%8C%E8%AE%B2%E8%A7%A3/">【MYSQL】水平分表、分库和垂直分表、分库和公共表的代码实现和讲解</a></p><div class="content"><h3 id="文章目录"><a class="markdownIt-Anchor" href="#文章目录">#</a> 文章目录</h3>
<ul>
<li><a href="#_1">一、教学讲解视频</a></li>
<li><a href="#_3">二、环境准备</a></li>
<li><a href="#_99">三、水平分表</a></li>
<li>
<ul>
<li><a href="#1_100">1. 概念</a></li>
<li><a href="#2_114">2. 代码</a></li>
</ul>
</li>
<li><a href="#_221">四、水平分库</a></li>
<li>
<ul>
<li><a href="#1_223">1. 概念</a></li>
<li><a href="#2_229">2. 代码</a></li>
</ul>
</li>
<li><a href="#_351">五、垂直分表</a></li>
<li>
<ul>
<li><a href="#1_352">1. 概念</a></li>
<li><a href="#2_356">2. 代码</a></li>
</ul>
</li>
<li><a href="#_358">六、垂直分库</a></li>
<li>
<ul>
<li><a href="#1_359">1. 概念</a></li>
<li><a href="#2_362">2. 代码</a></li>
</ul>
</li>
<li><a href="#_364">七、公共表</a></li>
<li>
<ul>
<li><a href="#1_365">1. 概念</a></li>
<li><a href="#2_367">2. 代码</a></li>
</ul>
</li>
</ul>
<h1 id="一-教学讲解视频"><a class="markdownIt-Anchor" href="#一-教学讲解视频">#</a> 一、教学讲解视频</h1>
<p>教学讲解视频地址：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1tx4y1371w">视频地址</a></p>
<h1 id="二-环境准备"><a class="markdownIt-Anchor" href="#二-环境准备">#</a> 二、环境准备</h1>
<ul>
<li>
<p>操作系统：Win10</p>
</li>
<li>
<p>数据库：MySQL5.7</p>
</li>
<li>
<p>JDK：64 位 jdk1.8.0_202</p>
</li>
<li>
<p>应用框架：spring-boot-2.1.3.RELEASE</p>
</li>
<li>
<p>Sharding-JDBC：sharding-jdbc-spring-boot-starter-4.0.0-RC1</p>
</li>
</ul>
<p>对应的 pom.xml 依赖代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.3.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.yjq.programmer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ShardingJDBC<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>ShardingJDBC<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 引入mysql连接依赖 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 引入sharding-jdbc连接依赖 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shardingsphere<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sharding-jdbc-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.0-RC1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--引入阿里巴巴druid连接池--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.19<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 引入测试依赖 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 集成mybatis --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 集成junit测试 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">pluginManagement</span>&gt;</span><span class="comment">&lt;!-- lock down plugins versions to avoid using Maven defaults (may be moved to parent pom) --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">pluginManagement</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="三-水平分表"><a class="markdownIt-Anchor" href="#三-水平分表">#</a> 三、水平分表</h1>
<h2 id="1概念"><a class="markdownIt-Anchor" href="#1概念">#</a> 1. 概念</h2>
<p>水平分表是在 <code>同一个</code> 数据库内，把同一个表的数据 <code>按一定规则</code> 拆分到多个 <code>表</code> 中。<br>
因此，目前我在一个数据库中准备了两个表， <code>t_user_1</code>  和 <code>t_user_2</code> ，如下图。<br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/b9b8ccb2a36e4028bb013590fc3e84ea.png" alt="在这里插入图片描述"><br>
表结构：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `t_user_1` (</span><br><span class="line">  `<span class="built_in">id</span>` bigint(20) NOT NULL,</span><br><span class="line">  `name` varchar(100) DEFAULT NULL,</span><br><span class="line">  `sex` int(2) DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (`<span class="built_in">id</span>`)</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8;</span><br></pre></td></tr></table></figure>
<h2 id="2代码"><a class="markdownIt-Anchor" href="#2代码">#</a> 2. 代码</h2>
<p>①我们先来看下我们的 SpringBoot 的 <code>配置文件</code> 代码。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">server.port=8081</span><br><span class="line"><span class="comment">#1800s</span></span><br><span class="line">server.servlet.session.timeout=1800</span><br><span class="line">spring.jackson.time-zone=GMT+8</span><br><span class="line">spring.jackson.date-format=yyyy-MM-<span class="built_in">dd</span> HH:mm:ss</span><br><span class="line"></span><br><span class="line"><span class="comment">#定义数据源</span></span><br><span class="line">spring.shardingsphere.datasource.names=m1</span><br><span class="line"></span><br><span class="line">spring.shardingsphere.datasource.m1.url=jdbc:mysql://127.0.0.1:3306/db_user1?serverTimezone=GMT%2b8&amp;useUnicode=<span class="literal">true</span>&amp;characterEncoding=utf8</span><br><span class="line">spring.shardingsphere.datasource.m1.username=root</span><br><span class="line">spring.shardingsphere.datasource.m1.password=</span><br><span class="line">spring.shardingsphere.datasource.m1.driver‐class‐name=com.mysql.jdbc.Driver</span><br><span class="line">spring.shardingsphere.datasource.m1.type=com.alibaba.druid.pool.DruidDataSource</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定t_user表的数据分布情况，配置数据节点</span></span><br><span class="line">spring.shardingsphere.sharding.tables.t_user.actual‐data‐nodes=m1.t_user_$-&gt;&#123;1..2&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定t_user表的主键生成策略为SNOWFLAKE</span></span><br><span class="line">spring.shardingsphere.sharding.tables.t_user.key‐generator.column=<span class="built_in">id</span></span><br><span class="line">spring.shardingsphere.sharding.tables.t_user.key‐generator.type=SNOWFLAKE</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定t_user表的分表策略，分表策略包括分片键和分片算法</span></span><br><span class="line">spring.shardingsphere.sharding.tables.t_user.table‐strategy.inline.sharding‐column=<span class="built_in">id</span></span><br><span class="line">spring.shardingsphere.sharding.tables.t_user.table‐strategy.inline.algorithm‐expression=t_user_$-&gt;&#123;<span class="built_in">id</span> % 2 + 1&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 控制台日志配置</span></span><br><span class="line">logging.level.root=info</span><br><span class="line">logging.level.com.yjq.programmer.dao=debug</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开sql输出日志</span></span><br><span class="line">spring.shardingsphere.props.sql.show=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#mapper文件扫描路径</span></span><br><span class="line">mybatis.mapper-locations=classpath*:mappers/**/*.xml</span><br></pre></td></tr></table></figure>
<ul>
<li>首先定义数据源 m1，并对 m1 进行实际的参数配置。</li>
<li>指定 t_user 表的数据分布情况，他分布在 m1.t_user_1，m1.t_user_2。</li>
<li>指定 t_user 表的主键生成策略为 SNOWFLAKE，SNOWFLAKE 是一种分布式自增算法，保证 id 全局唯一。</li>
<li>定义 t_user 分表策略，id 为偶数的数据落在 t_user_1，为奇数的落在 t_user_2，所以分表策略的表达式为 t_user_$-&gt;{id% 2 + 1}。</li>
</ul>
<p><strong>踩坑注意！</strong> 如果启动项目有如下报错，可能是配置文件中的 <code>-&gt;</code>  没有用英文类型的。<br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/1b3e0aca06df43c4bb2671eabc7a2e9d.png" alt="在这里插入图片描述"><br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/9a9e406ab2bd4e3db3c55aac18a9b178.png" alt="在这里插入图片描述"></p>
<p>②然后接下来就写我们的 <code>dao</code>  层、 <code>mapper</code>  层和 <code>单元测试</code> 的代码，去测试我们的水平分表情况下 <code>插入</code> 和 <code>查询</code> 的结果。</p>
<p><code>dao</code>  层</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public interface UserDao &#123;</span><br><span class="line"></span><br><span class="line">    int insertUser(User user);</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; selectUser();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>mapper</code>  层</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="line">&lt;mapper namespace=<span class="string">&quot;com.yjq.programmer.dao.UserDao&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;insert <span class="built_in">id</span>=<span class="string">&quot;insertUser&quot;</span> parameterType=<span class="string">&quot;com.yjq.programmer.entity.User&quot;</span>&gt;</span><br><span class="line">        insert into t_user(name) values (<span class="comment">#&#123;name&#125;)</span></span><br><span class="line">    &lt;/insert&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;select <span class="built_in">id</span>=<span class="string">&quot;selectUser&quot;</span> resultType=<span class="string">&quot;com.yjq.programmer.entity.User&quot;</span>&gt;</span><br><span class="line">        select * from t_user</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br><span class="line">12345678910111213</span><br><span class="line">单元测试</span><br><span class="line">@Test</span><br><span class="line">public void <span class="function"><span class="title">testShardingJDBCInsert</span></span>() &#123;</span><br><span class="line">    User user = new User();</span><br><span class="line">    <span class="keyword">for</span>(int i=0; i&lt;10; i++) &#123;</span><br><span class="line">        user.setName(<span class="string">&quot;小明&quot;</span> + i);</span><br><span class="line">        <span class="keyword">if</span>(userDao.insertUser(user) == 1) &#123;</span><br><span class="line">            logger.info(<span class="string">&quot;插入成功！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            logger.info(<span class="string">&quot;插入失败！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@Test</span><br><span class="line">public void <span class="function"><span class="title">testShardingJDBCSelect</span></span>() &#123;</span><br><span class="line">    List&lt;User&gt; userList = userDao.selectUser();</span><br><span class="line">    logger.info(<span class="string">&quot;查询结果：&#123;&#125;&quot;</span>, JSONObject.toJSONString(userList));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>③结果说明<br>
 <code>插入</code> <br>
 id 为奇数的被插入到 t_user_2 表，为偶数的被插入到 t_user_1 表，达到预期目标。<br>
 <code>查询</code> <br>
<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=sharding-jdbc&amp;spm=1001.2101.3001.7020"> sharding-jdbc</a> 分别去不同的表检索数据，达到预期目标；<strong>如果有传入 id 进行查询，sharding-jdbc 也会根据 t_user 的分表策略去不同的表检索数据</strong>。</p>
<h1 id="四-水平分库"><a class="markdownIt-Anchor" href="#四-水平分库">#</a> 四、水平分库</h1>
<h2 id="1概念-2"><a class="markdownIt-Anchor" href="#1概念-2">#</a> 1. 概念</h2>
<p>水平分库是把同一个表的数据按 <code>一定规则</code> 拆分到不同的 <code>数据库</code> 中，每个库可以放在不同的服务器上。<br>
现在，我在 <code>水平分表</code> 的基础上多加了一个 db_user2 的数据库。<br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/80d1a3af2700414b9a0850ae9172034a.png" alt="在这里插入图片描述"><br>
然后两个数据库中的表结构是一致的，表结构和上面水平分表用的保持一样。<br>
<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/9354ea1b1af043238412581e0769b3dd.png" alt="在这里插入图片描述"></p>
<h2 id="2代码-2"><a class="markdownIt-Anchor" href="#2代码-2">#</a> 2. 代码</h2>
<p>①我们先来看下我们的 SpringBoot 的 <code>配置文件</code> 代码。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">server.port=8081</span><br><span class="line"><span class="comment">#1800s</span></span><br><span class="line">server.servlet.session.timeout=1800</span><br><span class="line">spring.jackson.time-zone=GMT+8</span><br><span class="line">spring.jackson.date-format=yyyy-MM-<span class="built_in">dd</span> HH:mm:ss</span><br><span class="line"></span><br><span class="line"><span class="comment">#定义数据源</span></span><br><span class="line">spring.shardingsphere.datasource.names=m1,m2</span><br><span class="line"></span><br><span class="line">spring.shardingsphere.datasource.m1.url=jdbc:mysql://127.0.0.1:3306/db_user1?serverTimezone=GMT%2b8&amp;useUnicode=<span class="literal">true</span>&amp;characterEncoding=utf8</span><br><span class="line">spring.shardingsphere.datasource.m1.username=root</span><br><span class="line">spring.shardingsphere.datasource.m1.password=</span><br><span class="line">spring.shardingsphere.datasource.m1.driver‐class‐name=com.mysql.jdbc.Driver</span><br><span class="line">spring.shardingsphere.datasource.m1.type=com.alibaba.druid.pool.DruidDataSource</span><br><span class="line"></span><br><span class="line">spring.shardingsphere.datasource.m2.url=jdbc:mysql://127.0.0.1:3306/db_user2?serverTimezone=GMT%2b8&amp;useUnicode=<span class="literal">true</span>&amp;characterEncoding=utf8</span><br><span class="line">spring.shardingsphere.datasource.m2.username=root</span><br><span class="line">spring.shardingsphere.datasource.m2.password=</span><br><span class="line">spring.shardingsphere.datasource.m2.driver‐class‐name=com.mysql.jdbc.Driver</span><br><span class="line">spring.shardingsphere.datasource.m2.type=com.alibaba.druid.pool.DruidDataSource</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分库策略</span></span><br><span class="line">spring.shardingsphere.sharding.tables.t_user.database‐strategy.inline.sharding‐column=sex</span><br><span class="line">spring.shardingsphere.sharding.tables.t_user.database‐strategy.inline.algorithm‐expression=m$-&gt;&#123;sex % 2 + 1&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定t_user表的数据分布情况，配置数据节点</span></span><br><span class="line">spring.shardingsphere.sharding.tables.t_user.actual‐data‐nodes=m$-&gt;&#123;1..2&#125;.t_user_$-&gt;&#123;1..2&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定t_user表的主键生成策略为SNOWFLAKE</span></span><br><span class="line">spring.shardingsphere.sharding.tables.t_user.key‐generator.column=<span class="built_in">id</span></span><br><span class="line">spring.shardingsphere.sharding.tables.t_user.key‐generator.type=SNOWFLAKE</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定t_user表的分表策略，分表策略包括分片键和分片算法</span></span><br><span class="line">spring.shardingsphere.sharding.tables.t_user.table‐strategy.inline.sharding‐column=<span class="built_in">id</span></span><br><span class="line">spring.shardingsphere.sharding.tables.t_user.table‐strategy.inline.algorithm‐expression=t_user_$-&gt;&#123;<span class="built_in">id</span> % 2 + 1&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 控制台日志配置</span></span><br><span class="line">logging.level.root=info</span><br><span class="line">logging.level.com.yjq.programmer.dao=debug</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开sql输出日志</span></span><br><span class="line">spring.shardingsphere.props.sql.show=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#mapper文件扫描路径</span></span><br><span class="line">mybatis.mapper-locations=classpath*:mappers/**/*.xml</span><br></pre></td></tr></table></figure>
<ul>
<li>配置了两个数据源，分配指向两个不同的数据库 db_user1 和 db_user2。</li>
<li>配置分库策略，sex 字段为偶数的数据落在 m1 数据源，为奇数的落在 m2 数据源，所以分库策略的表达式为 m$-&gt;{sex % 2 + 1}。</li>
<li>配置分表策略，分表策略和上面水平分表保持一致。</li>
<li>也就是当有数据来时，先根据 sex 字段判断落入哪个数据源，然后再根据 id 字段来判断落入哪个表中。</li>
</ul>
<p>②然后接下来就写我们的 <code>dao</code>  层、 <code>mapper</code>  层和 <code>单元测试</code> 的代码，去测试我们的水平分表情况下 <code>插入</code> 和 <code>查询</code> 的结果。</p>
<p><code>dao</code>  层</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public interface UserDao &#123;</span><br><span class="line"></span><br><span class="line">    int insertUser(User user);</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; selectUser(User user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>mapper</code>  层</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="line">&lt;mapper namespace=<span class="string">&quot;com.yjq.programmer.dao.UserDao&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;insert <span class="built_in">id</span>=<span class="string">&quot;insertUser&quot;</span> parameterType=<span class="string">&quot;com.yjq.programmer.entity.User&quot;</span>&gt;</span><br><span class="line">        insert into t_user(name, sex) values (<span class="comment">#&#123;name&#125;, #&#123;sex&#125;)</span></span><br><span class="line">    &lt;/insert&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;select <span class="built_in">id</span>=<span class="string">&quot;selectUser&quot;</span> parameterType=<span class="string">&quot;com.yjq.programmer.entity.User&quot;</span> resultType=<span class="string">&quot;com.yjq.programmer.entity.User&quot;</span>&gt;</span><br><span class="line">        select * from t_user t <span class="built_in">where</span> t.sex = <span class="comment">#&#123;sex&#125; and t.id = #&#123;id&#125;</span></span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br><span class="line">12345678910111213</span><br><span class="line">单元测试</span><br><span class="line">@Test</span><br><span class="line">public void <span class="function"><span class="title">testShardingJDBCInsert</span></span>() &#123;</span><br><span class="line">    User user = new User();</span><br><span class="line">    <span class="keyword">for</span>(int i=0; i&lt;10; i++) &#123;</span><br><span class="line">        user.setName(<span class="string">&quot;小明&quot;</span> + i);</span><br><span class="line">        user.setSex(1);</span><br><span class="line">        <span class="keyword">if</span>(userDao.insertUser(user) == 1) &#123;</span><br><span class="line">            logger.info(<span class="string">&quot;插入成功！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            logger.info(<span class="string">&quot;插入失败！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@Test</span><br><span class="line">public void <span class="function"><span class="title">testShardingJDBCSelect</span></span>() &#123;</span><br><span class="line">    User user = new User();</span><br><span class="line">    user.setSex(1);</span><br><span class="line">    user.setId(821357967667363840L);</span><br><span class="line">    List&lt;User&gt; userList = userDao.selectUser(user);</span><br><span class="line">    logger.info(<span class="string">&quot;查询结果：&#123;&#125;&quot;</span>, JSONObject.toJSONString(userList));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>③结果说明<br>
 <code>插入</code> <br>
 sex 字段为奇数的数据落入 m2 数据源，为偶数的落入 m1 数据源。同时 id 字段值为奇数的，插入 t_user_2 表中，为偶数的插入 t_user_1 表中，达到预期目标。<br>
 <code>查询</code> <br>
 sharding-jdbc 分别去不同的表检索数据，达到预期目标；<strong>如果有传入 sex 进行查询，sharding-jdbc 会根据 t_user 的分库策略去锁定查哪个库，如果有传入 id 进行查询，sharding-jdbc 会根据 t_user 的分表策略去锁定查哪个表</strong>。</p>
<h1 id="五-垂直分表"><a class="markdownIt-Anchor" href="#五-垂直分表">#</a> 五、垂直分表</h1>
<h2 id="1概念-3"><a class="markdownIt-Anchor" href="#1概念-3">#</a> 1. 概念</h2>
<p>垂直分表一般就是把表的结构进行改造，关于如何改造，可以浏览我的另一篇博客：<br>
<a target="_blank" rel="noopener" href="https://blog.csdn.net/dgfdhgghd/article/details/128426013">分库分表：垂直分库、垂直分表、水平分库、水平分表四个概念</a><br>
<strong>大致的思路就是：将一个表按照字段分成多表，每个表存储其中一部分字段。</strong></p>
<h2 id="2代码-3"><a class="markdownIt-Anchor" href="#2代码-3">#</a> 2. 代码</h2>
<p>无代码，垂直分表属于表结构设计层面。</p>
<h1 id="六-垂直分库"><a class="markdownIt-Anchor" href="#六-垂直分库">#</a> 六、垂直分库</h1>
<h2 id="1概念-4"><a class="markdownIt-Anchor" href="#1概念-4">#</a> 1. 概念</h2>
<p>垂直分库就是在 <code>垂直分表</code> 把表进行分类后，放到 <code>不同的数据库</code> 中。每个库可以放在不同的服务器上，它的核心理念是 <code>专库专用</code> 。关于如何改造，同样可以浏览我的另一篇博客：<br>
<a target="_blank" rel="noopener" href="https://blog.csdn.net/dgfdhgghd/article/details/128426013">分库分表：垂直分库、垂直分表、水平分库、水平分表四个概念</a></p>
<h2 id="2代码-4"><a class="markdownIt-Anchor" href="#2代码-4">#</a> 2. 代码</h2>
<p>无代码，垂直分库属于数据库设计层面。</p>
<h1 id="七-公共表"><a class="markdownIt-Anchor" href="#七-公共表">#</a> 七、公共表</h1>
<h2 id="1概念-5"><a class="markdownIt-Anchor" href="#1概念-5">#</a> 1. 概念</h2>
<p>公共表属于系统中数据量较小，变动少，而且属于高频联合查询的依赖表。参数表、数据字典表等属于此类型。 <code>可以将这类表在每个数据库都保存一份</code> ，所有更新操作都同时发送到所有分库执行。</p>
<h2 id="2代码-5"><a class="markdownIt-Anchor" href="#2代码-5">#</a> 2. 代码</h2>
<p>①只需要在 SpringBoot 的 <code>配置文件</code> 中加入下面这行来指明公共表就行。<br>
 <code>如果有多个公共表，用逗号拼接就行</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#公共表设置</span></span><br><span class="line">spring.shardingsphere.sharding.broadcast‐tables=t_dict</span><br><span class="line">12</span><br></pre></td></tr></table></figure>
<p>②然后接下来就写我们的 <code>dao</code>  层、 <code>mapper</code>  层和 <code>单元测试</code> 的代码，去测试我们的公共表的 <code>插入</code> 的结果。<br>
 <code>dao</code>  层</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface DictDao &#123;</span><br><span class="line"></span><br><span class="line">    int insertDict(Dict dict);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>mapper</code>  层</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="line">&lt;mapper namespace=<span class="string">&quot;com.yjq.programmer.dao.DictDao&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;insert <span class="built_in">id</span>=<span class="string">&quot;insertDict&quot;</span> parameterType=<span class="string">&quot;com.yjq.programmer.entity.Dict&quot;</span>&gt;</span><br><span class="line">        insert into t_dict(<span class="built_in">id</span>, name) values (<span class="comment">#&#123;id&#125;, #&#123;name&#125;)</span></span><br><span class="line">    &lt;/insert&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/mapper&gt;</span><br><span class="line">12345678910</span><br><span class="line">单元测试</span><br><span class="line">@Test</span><br><span class="line">public void <span class="function"><span class="title">testShardingJDBCInsertDict</span></span>() &#123;</span><br><span class="line">    Dict dict = new Dict();</span><br><span class="line">    dict.setId(1);</span><br><span class="line">    dict.setName(<span class="string">&quot;字典名称&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(dictDao.insertDict(dict) == 1) &#123;</span><br><span class="line">        logger.info(<span class="string">&quot;插入成功！&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        logger.info(<span class="string">&quot;插入失败！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>③结果说明<br>
 <code>插入</code> <br>
插入的数据在 <code>每个库中的对应的公共表</code> 中都能看到，达到预期目标。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-02-24T05:44:16.909Z" title="2023-2-24 13:44:16">2023-02-24</time>发表</span><span class="level-item"><time dateTime="2023-02-24T05:44:01.609Z" title="2023-2-24 13:44:01">2023-02-24</time>更新</span><span class="level-item">41 分钟读完 (大约6183个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/02/24/%E3%80%90Flutter&amp;SpringBoot%E3%80%91%E5%A6%82%E4%BD%95%E7%94%A8Flutter%E5%92%8CJava%E6%9D%A5%E5%BC%80%E5%8F%91%E4%B8%80%E4%B8%AA%E6%8A%BD%E5%A5%96APP/">如何使用Flutter+SpringBoot+Mysql开发一个简易的抽奖APP（Android教学</a></p><div class="content"><h2 id="微信公众号搜索interviewcoder回复关键词吃啥获取源码以及开发教程~"><a class="markdownIt-Anchor" href="#微信公众号搜索interviewcoder回复关键词吃啥获取源码以及开发教程~">#</a> 微信公众号搜索 InterviewCoder 回复关键词《吃啥》获取源码以及开发教程～</h2>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/%E4%BA%8C%E7%BB%B4%E7%A0%81mini.png" alt="二维码mini"></p>
<h1 id="前言"><a class="markdownIt-Anchor" href="#前言">#</a> 前言：</h1>
<h3 id="weat-中文译为吃啥"><a class="markdownIt-Anchor" href="#weat-中文译为吃啥">#</a> Weat 中文译为：吃啥</h3>
<h5 id="吃啥来自于女朋友的一个问题问我可不可以做个抽奖的app奖品都是菜抽中那个今天就做那个菜吃我灵机一动使用interviewcoder公众号里面的chatgpt小程序编辑了下面的文案"><a class="markdownIt-Anchor" href="#吃啥来自于女朋友的一个问题问我可不可以做个抽奖的app奖品都是菜抽中那个今天就做那个菜吃我灵机一动使用interviewcoder公众号里面的chatgpt小程序编辑了下面的文案">#</a> 吃啥来自于女朋友的一个问题，问我可不可以做个抽奖的 APP，奖品都是菜，抽中那个今天就做那个菜吃，我灵机一动，使用 InterviewCoder 公众号里面的 chatGPT 小程序编辑了下面的文案：</h5>
<h5 id="吃啥是一款新奇有趣的应用旨在帮助你找到今天吃什么菜-它通过精心的菜谱抽奖模式为你提供多样而有色彩的食物让你的用餐经历变得更加美好-不仅如此它还可以添加朋友和家人的偏好为大家带来更多惊喜-加入吃啥让你的用餐经历变得更加完美"><a class="markdownIt-Anchor" href="#吃啥是一款新奇有趣的应用旨在帮助你找到今天吃什么菜-它通过精心的菜谱抽奖模式为你提供多样而有色彩的食物让你的用餐经历变得更加美好-不仅如此它还可以添加朋友和家人的偏好为大家带来更多惊喜-加入吃啥让你的用餐经历变得更加完美">#</a> 吃啥是一款新奇有趣的应用，旨在帮助你找到今天吃什么菜。它通过精心的菜谱抽奖模式，为你提供多样而有色彩的食物，让你的用餐经历变得更加美好。不仅如此，它还可以添加朋友和家人的偏好，为大家带来更多惊喜。加入吃啥，让你的用餐经历变得更加完美！</h5>
<h3 id="架构方面"><a class="markdownIt-Anchor" href="#架构方面">#</a> 架构方面：</h3>
<p>移动端：Flutter</p>
<p>后台服务：SpringBoot、Mysql</p>
<h3 id="没有安装dart-flutter-android-studio-vscode的同学可以看看以前的教程这里就不-一-一-介绍了"><a class="markdownIt-Anchor" href="#没有安装dart-flutter-android-studio-vscode的同学可以看看以前的教程这里就不-一-一-介绍了">#</a> 没有安装 dart、flutter、Android Studio、vscode 的同学可以看看以前的教程，这里就不 一 一 介绍了</h3>
<p>本文将详细介绍 weatapp 的开发流程，前后端代码编写阶段，以及后台代码部署。</p>
<h2 id="一-app创建"><a class="markdownIt-Anchor" href="#一-app创建">#</a> 一、APP 创建：</h2>
<ol>
<li>
<p>打开项目路径，输入 cmd 进入到命令行，输入 flutter create weat 进行 flutter 项目创建。</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230223201656540.png" alt="image-20230223201656540"></p>
</li>
<li>
<p>打开 Android Studio 整理项目，修改仓库配置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">maven &#123; url <span class="string">&#x27;https://maven.aliyun.com/repository/google&#x27;</span> &#125;</span><br><span class="line">maven &#123; url <span class="string">&#x27;https://maven.aliyun.com/repository/jcenter&#x27;</span> &#125;</span><br><span class="line">maven &#123; url <span class="string">&#x27;http://maven.aliyun.com/nexus/content/groups/public&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230223201935306.png" alt="image-20230223201935306"></p>
<p>3. 点击 Open for Editing in Android Studio 进入安卓视图，拉取 gradle 库</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230223202038338.png" alt="image-20230223202038338"></p>
<p>4. 当 Android 主文件不暴红，说明配置完毕了，gradle 库已经拉下来了</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230223202433131.png" alt="image-20230223202433131"></p>
<h2 id="二-app启动"><a class="markdownIt-Anchor" href="#二-app启动">#</a> 二、APP 启动：</h2>
<p>​	1. 打开一个安卓模拟器，有条件的同学可以直接使用真机，老师这里为了方便就直接用模拟器了</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230223202625528.png" alt="image-20230223202625528"></p>
<p>​	2. 使用 vscode 打开项目并启动 flutter 项目</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230223203129146.png" alt="image-20230223203129146"></p>
<p>至此，一个 flutter 项目，创建完成，并启动了！</p>
<h2 id="三-app图标配置"><a class="markdownIt-Anchor" href="#三-app图标配置">#</a> 三、APP 图标配置</h2>
<p>需要打开两个网址：</p>
<p><a target="_blank" rel="noopener" href="https://logo.aliyun.com/logo#/name">https://logo.aliyun.com/logo#/name</a>  阿里云 LOGO 服务</p>
<p><a target="_blank" rel="noopener" href="https://icon.wuruihong.com/">https://icon.wuruihong.com/</a> 图标工厂</p>
<p>1. 打开阿里云 LOGO 输入 APP 名字，吃啥</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230223203651967.png" alt="image-20230223203651967"></p>
<p>2. 生成图标：</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230223203733745.png" alt="image-20230223203733745"></p>
<p>购买一个你喜欢的图标，如果不购买的话，自己在网上找一个也行，但是一定要有商业授权！</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230223204102921.png" alt="image-20230223204102921"></p>
<p>得到图标后，进入图标工厂，生成一套 ios 和一套 Android 的图标文件：</p>
<p><img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20230223205448783.png" alt="image-20230223205448783"></p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230223205507890.png" alt="image-20230223205507890"></p>
<p>进入安卓文件夹，将该目录的文件复制到你的项目下面 \android\app\src\main\res</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230223205604112.png" alt="image-20230223205604112"></p>
<h4 id="成效"><a class="markdownIt-Anchor" href="#成效">#</a> 成效：</h4>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230223210003933.png" alt="image-20230223210003933"></p>
<p>至此，APP 图标设置完成！</p>
<h2 id="四-app后台开发springbootmysql"><a class="markdownIt-Anchor" href="#四-app后台开发springbootmysql">#</a> 四、APP 后台开发（SpringBoot+Mysql）</h2>
<h4 id="为什么先开发app部分这个纯属个人习惯我比较喜欢先有数据和接口直接开发app的感觉会更轻松"><a class="markdownIt-Anchor" href="#为什么先开发app部分这个纯属个人习惯我比较喜欢先有数据和接口直接开发app的感觉会更轻松">#</a> 为什么先开发 APP 部分？，这个纯属个人习惯，我比较喜欢先有数据和接口，直接开发 APP 的感觉会更轻松！</h4>
<h4 id="整理需求"><a class="markdownIt-Anchor" href="#整理需求">#</a> 整理需求：</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">每次进入app随机获取食物列表</span><br><span class="line">点击开始抽奖 随机跳转 点击停止 按钮回显食物名称 点击查看菜谱 弹窗提示做法</span><br></pre></td></tr></table></figure>
<p>根据如上需求，我明确了客户到底想要什么</p>
<p>1. 这是一个服务类型的 APP，服务于不知道吃什么的客户</p>
<p>2. 每次进入抽奖页面需要获取不同的菜谱奖品列表</p>
<p>3. 这个页面需要有个按钮，可以来重置奖品，并且要限制次数</p>
<p>4. 点击抽奖按钮，开始抽奖，再次点击，或者超过限制时间，停止选择，并将按钮置为：查看食谱</p>
<p>5. 点击查看食谱，进入食谱详情，展示过程</p>
<p>根据我的聪明思考，画出了如下 UI：</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230223210734630.png" alt="image-20230223210734630"></p>
<h3 id="开玩笑画的很烂但是就是这个意思"><a class="markdownIt-Anchor" href="#开玩笑画的很烂但是就是这个意思">#</a> 开玩笑，画的很烂，但是就是这个意思！。</h3>
<p>那么，开始开发后台数据，为我们的 APP 提供一个接口～！</p>
<p>经过一系列操作，得到以下数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> NAMES utf8mb4;</span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for iv_dishes</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `iv_dishes`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `iv_dishes`  (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;唯一ID&#x27;</span>,</span><br><span class="line">  `dishes_name` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;菜品名字&#x27;</span>,</span><br><span class="line">  `dishes_step` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;菜品做法&#x27;</span>,</span><br><span class="line">  `dishes_url` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;菜品图片地址&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">9</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci COMMENT <span class="operator">=</span> <span class="string">&#x27;菜品表&#x27;</span> ROW_FORMAT <span class="operator">=</span> Compact;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of iv_dishes</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `iv_dishes` <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;凉拌黄瓜虾仁&#x27;</span>, <span class="string">&#x27;1.小米辣 白芝麻蒜未辣椒面 淋上少许热油\r\n2.生抽2勺 油 醋各1代糖半勺搅匀备用\r\n3.虾煮熟去壳 木耳焯水捞出 黄瓜拍块\r\n4.淋上酱汁拌匀即可&#x27;</span>, <span class="string">&#x27;https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230224081935481.png&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `iv_dishes` <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;低卡酱油鸡蛋&#x27;</span>, <span class="string">&#x27;1.生抽4勺 醋2香油1勺一把葱花\r\n2.鸡蛋冷水下锅煮8分钟盖盖焖1分钟后泡冷水\r\n3.温开水4勺搅匀\r\n4.鸡蛋剥壳切对半淋上酱汁拌匀即可&#x27;</span>, <span class="string">&#x27;https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230224082035768.png&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `iv_dishes` <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;低卡葱香鸡腿&#x27;</span>, <span class="string">&#x27;1.蒜末 葱花 白艺麻小米辣淋上少许热油\r\n2.生抽1勺 许盐搅匀\r\n3.鸡腿熟捞出微凉后撕成小块\r\n4.淋上酱汁拌匀即可&#x27;</span>, <span class="string">&#x27;https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230224082101091.png&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `iv_dishes` <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;低卡平菇炒蛋&#x27;</span>, <span class="string">&#x27;1.鸡蛋炒熟盛出\r\n2.油热下从蒜炒香\r\n3.下平菇炒出汁，倒入炒好的鸡蛋\r\n4.生抽 油 辣椒粉各1勺 少许盐炒匀即可&#x27;</span>, <span class="string">&#x27;https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230224082137439.png&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `iv_dishes` <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="string">&#x27;凉拌虾仁西兰花&#x27;</span>, <span class="string">&#x27;1.蒜未 葱花 辣椒面白芝麻淋上少许热油\r\n2.生抽2勺 醋各1勺搅拌均匀\r\n3.西兰花焯水捞出，虾焯水去壳鸡蛋白切块\r\n4.淋上酱汁拌匀即可&#x27;</span>, <span class="string">&#x27;https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230224082204322.png&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `iv_dishes` <span class="keyword">VALUES</span> (<span class="number">6</span>, <span class="string">&#x27;凉拌黄瓜木耳鸡蛋&#x27;</span>, <span class="string">&#x27;1.木耳鸡蛋各煮熟捞出 黄瓜拍块\r\n2.生抽2勺醋香油各11勺温开水拌匀即可开吃&#x27;</span>, <span class="string">&#x27;https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230224082230282.png&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `iv_dishes` <span class="keyword">VALUES</span> (<span class="number">7</span>, <span class="string">&#x27;凉拌黄瓜豆腐&#x27;</span>, <span class="string">&#x27;1.白芝麻辣椒面小米辣,蒜未 葱花 淋少许热油\r\n2.生抽2勺 醋油各1勺 少许盐代糖拌匀\r\n3.黄瓜拍块去籽豆腐煮熟捞出\r\n4.撒上香葱淋上酱汁拌匀即可&#x27;</span>, <span class="string">&#x27;https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230224082404878.png&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `iv_dishes` <span class="keyword">VALUES</span> (<span class="number">8</span>, <span class="string">&#x27;木耳炒鸡蛋&#x27;</span>, <span class="string">&#x27;1.鸡蛋炒熟盛出\r\n2.蒜未和胡萝人炒软倒木耳炒熟再倒鸡蛋\r\n3.耗油生抽各1勺少许盐-小半碗淀粉水\r\n4.炒匀下葱段即可&#x27;</span>, <span class="string">&#x27;https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230224082512562.png&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>接下来创建一个 SpringBoot 项目，并写出 entity、 controller、service、impl、mapper、xml 等需要的代码</p>
<p>entity：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * &lt;p&gt;</span><br><span class="line"> * 菜品表</span><br><span class="line"> * &lt;/p&gt;</span><br><span class="line"> *</span><br><span class="line"> * @author Brath</span><br><span class="line"> * @since 2023-02-23</span><br><span class="line"> */</span><br><span class="line">@Data</span><br><span class="line">@EqualsAndHashCode(callSuper = false)</span><br><span class="line">@TableName(&quot;iv_dishes&quot;)</span><br><span class="line">@ApiModel(value=&quot;IvDishes对象&quot;, description=&quot;菜品表&quot;)</span><br><span class="line">public class IvDishes implements Serializable &#123;</span><br><span class="line"></span><br><span class="line">    private static final long serialVersionUID = 1L;</span><br><span class="line"></span><br><span class="line">    @ApiModelProperty(value = &quot;唯一ID&quot;)</span><br><span class="line">    @TableId(value = &quot;id&quot;, type = IdType.AUTO)</span><br><span class="line">    private Integer id;</span><br><span class="line"></span><br><span class="line">    @ApiModelProperty(value = &quot;菜品名字&quot;)</span><br><span class="line">    private String dishesName;</span><br><span class="line"></span><br><span class="line">    @ApiModelProperty(value = &quot;菜品做法&quot;)</span><br><span class="line">    private String dishesStep;</span><br><span class="line"></span><br><span class="line">    @ApiModelProperty(value = &quot;菜品图片地址&quot;)</span><br><span class="line">    private String dishesUrl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>controller：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 菜品表 前端控制器</span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Brath</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2023-02-23</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/dishes&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IvDishesController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * SLF4J日志</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(IvDishesController.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 菜品服务接口</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IvDishesService dishesService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * 获取菜品列表</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> page</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> size</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/getDishes&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getDishes</span><span class="params">(<span class="meta">@RequestParam(value = &quot;page&quot;, defaultValue = &quot;1&quot;)</span> Integer page, <span class="meta">@RequestParam(value = &quot;size&quot;, defaultValue = &quot;8&quot;)</span> Integer size)</span> &#123;</span><br><span class="line">        logger.info(<span class="string">&quot;【用户服务】获取菜品列表,开始&quot;</span>);</span><br><span class="line">        Map&lt;Object, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        IPage&lt;IvDishes&gt; prizeRecords = dishesService.getDishes(page, size);</span><br><span class="line">        <span class="keyword">if</span> (CollectionUtils.isEmpty(prizeRecords.getRecords())) &#123;</span><br><span class="line">            result.put(<span class="string">&quot;fail&quot;</span>, ResponseCode.DATA_DOES_NOT_EXIST);</span><br><span class="line">            logger.error(<span class="string">&quot;【用户服务】获取菜品列表,服务错误:&#123;&#125;&quot;</span>, ResponseCode.DATA_DOES_NOT_EXIST);</span><br><span class="line">        &#125;</span><br><span class="line">        result.put(<span class="string">&quot;prizeRecords&quot;</span>, prizeRecords.getRecords());</span><br><span class="line">        logger.info(<span class="string">&quot;【用户服务】获取菜品列表,完毕&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ResponseUtil.ok(result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>service：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 菜品表 服务类</span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Brath</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2023-02-23</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IvDishesService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;IvDishes&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取菜品列表</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> page</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> size</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    IPage&lt;IvDishes&gt; <span class="title function_">getDishes</span><span class="params">(Integer page, Integer size)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>impl：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 菜品表 服务实现类</span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Brath</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2023-02-23</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IvDishesServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;IvDishesMapper, IvDishes&gt; <span class="keyword">implements</span> <span class="title class_">IvDishesService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取菜品列表</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> page</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> size</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> IPage&lt;IvDishes&gt; <span class="title function_">getDishes</span><span class="params">(Integer page, Integer size)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> baseMapper.getDishes(<span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(page, size), <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>mapper：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 菜品表 Mapper 接口</span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Brath</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2023-02-23</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IvDishesMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;IvDishes&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取菜品列表</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> objectPage</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> objectQueryWrapper</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    IPage&lt;IvDishes&gt; <span class="title function_">getDishes</span><span class="params">(Page&lt;Object&gt; objectPage, QueryWrapper&lt;Object&gt; objectQueryWrapper)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>xml：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;cn.brath.mapper.IvDishesMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 通用查询映射结果 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;DishesMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;cn.brath.entity.IvDishes&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;dishes_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;dishesName&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;dishes_step&quot;</span> <span class="attr">property</span>=<span class="string">&quot;dishesStep&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;dishes_url&quot;</span> <span class="attr">property</span>=<span class="string">&quot;dishesUrl&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getDishes&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;cn.brath.entity.IvDishes&quot;</span>&gt;</span></span><br><span class="line">        select d.*</span><br><span class="line">        from iv_dishes d</span><br><span class="line">        ORDER BY RAND()</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>application.yaml 配置：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9999</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">druid:</span></span><br><span class="line">      <span class="attr">driver-class-name:</span> <span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line">      <span class="attr">url:</span> <span class="string">jdbc:mysql://127.0.0.1:3306/iv-user-services?createDatabaseIfNotExist=true&amp;useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=Asia/Shanghai&amp;nullCatalogMeansCurrent=true</span></span><br><span class="line">      <span class="attr">username:</span> <span class="string">&#x27;root&#x27;</span></span><br><span class="line">      <span class="attr">password:</span> <span class="string">&#x27;root&#x27;</span></span><br><span class="line">      <span class="attr">initial-size:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">max-active:</span> <span class="number">100</span></span><br><span class="line">      <span class="attr">min-idle:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">max-wait:</span> <span class="number">6000</span></span><br><span class="line">      <span class="attr">pool-prepared-statements:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">max-pool-prepared-statement-per-connection-size:</span> <span class="number">20</span></span><br><span class="line">      <span class="attr">time-between-eviction-runs-millis:</span> <span class="number">60000</span></span><br><span class="line">      <span class="attr">min-evictable-idle-time-millis:</span> <span class="number">300000</span></span><br><span class="line">      <span class="comment">#Oracle需要打开注释</span></span><br><span class="line">      <span class="comment">#      validation-query: SELECT 1 FROM DUAL</span></span><br><span class="line">      <span class="attr">test-while-idle:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">test-on-borrow:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">test-on-return:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">stat-view-servlet:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">url-pattern:</span> <span class="string">/druid/*</span></span><br><span class="line">        <span class="comment">#login-username: admin</span></span><br><span class="line">        <span class="comment">#login-password: admin</span></span><br><span class="line">        <span class="comment">#达梦数据库，需要注释掉，其他数据库可以打开</span></span><br><span class="line">      <span class="attr">filter:</span></span><br><span class="line">        <span class="attr">stat:</span></span><br><span class="line">          <span class="attr">log-slow-sql:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">slow-sql-millis:</span> <span class="number">1000</span></span><br><span class="line">          <span class="attr">merge-sql:</span> <span class="literal">false</span></span><br><span class="line">        <span class="attr">wall:</span></span><br><span class="line">          <span class="attr">config:</span></span><br><span class="line">            <span class="attr">multi-statement-allow:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>经过如上一系列配置，我们项目启动成功并可以访问到接口：</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230224124319493.png" alt="image-20230224124319493"></p>
<p>接下来只要把程序部署上线就搞定了！</p>
<p>部署后台程序：</p>
<p>将我们的 Dockerfile、运行脚本、jar 包传入服务器</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230224124656682.png" alt="image-20230224124656682"></p>
<p>Dockerfile:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#java8环境</span></span><br><span class="line"><span class="keyword">FROM</span> openkbs/jdk11-mvn-py3</span><br><span class="line"></span><br><span class="line"><span class="comment">#root用户</span></span><br><span class="line"><span class="keyword">USER</span> root</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置时区</span></span><br><span class="line"><span class="keyword">ENV</span> TZ=Asia/Shanghai</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">ln</span> -snf /usr/share/zoneinfo/<span class="variable">$TZ</span> /etc/localtime &amp;&amp; <span class="built_in">echo</span> <span class="variable">$TZ</span> &gt; /etc/timezone</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Auth</span></span><br><span class="line"><span class="keyword">MAINTAINER</span> Brath</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置工作目录集</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /root/weatWork</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#复制jars和命令</span></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> *.jar /root/weatWork/</span></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> run.sh /root/weatWork/run.sh</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#脚本权限设置</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">chmod</span> +x /root/weatWork/run.sh</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#暴露端口</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">9999</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="1dockerfile打包镜像"><a class="markdownIt-Anchor" href="#1dockerfile打包镜像">#</a> 1.Dockerfile 打包镜像</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.进入工作目录</span><br><span class="line">2.docker build -t weat .</span><br></pre></td></tr></table></figure>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230224124821870.png" alt="image-20230224124821870"></p>
<h3 id="2运行容器"><a class="markdownIt-Anchor" href="#2运行容器">#</a> 2. 运行容器</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -dit -p 9999:9999 --privileged=true -P  --name  weat weat /bin/bash -c &quot;tail -f /dev/null&quot; -g &quot;daemon off;&quot;</span><br></pre></td></tr></table></figure>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230224124959281.png" alt="image-20230224124959281"></p>
<h3 id="3启动jar包"><a class="markdownIt-Anchor" href="#3启动jar包">#</a> 3. 启动 Jar 包</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">进入容器</span></span><br><span class="line">docker exec -it weat bash</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">运行脚本</span></span><br><span class="line">sh run.sh</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看日志</span></span><br><span class="line">tail -100f weatlog.log</span><br></pre></td></tr></table></figure>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230224125037992.png" alt="image-20230224125037992"></p>
<h3 id="4联调接口"><a class="markdownIt-Anchor" href="#4联调接口">#</a> 4. 联调接口</h3>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230224125210437.png" alt="image-20230224125210437"></p>
<h2 id="五-app移动端开发flutter"><a class="markdownIt-Anchor" href="#五-app移动端开发flutter">#</a> 五、APP 移动端开发（Flutter）</h2>
<h4 id="weatapp架构设计大概如下"><a class="markdownIt-Anchor" href="#weatapp架构设计大概如下">#</a> weatApp 架构设计大概如下：</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">lib:</span><br><span class="line"></span><br><span class="line">​	common 通用层</span><br><span class="line"></span><br><span class="line">​	core 核心层</span><br><span class="line"></span><br><span class="line">​	routers 路由曾</span><br><span class="line"></span><br><span class="line">​	utils 工具层</span><br><span class="line"></span><br><span class="line">​	viewmodel 视图模型层</span><br><span class="line"></span><br><span class="line">​	views 视图层</span><br></pre></td></tr></table></figure>
<p>需要安装的依赖：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#网络请求</span></span><br><span class="line"><span class="attr">dio:</span> <span class="string">^4.0.6</span></span><br><span class="line"><span class="comment">#getx </span></span><br><span class="line"><span class="attr">get:</span> <span class="string">^4.6.5</span></span><br><span class="line"><span class="comment">#透明弹出框</span></span><br><span class="line"><span class="attr">fluttertoast:</span> <span class="string">^8.0.8</span></span><br><span class="line"><span class="comment">#屏幕适配</span></span><br><span class="line"><span class="attr">flutter_screenutil:</span> <span class="string">^5.5.3+2</span></span><br><span class="line"><span class="comment">#全局状态管理</span></span><br><span class="line"><span class="attr">provider:</span> <span class="string">^6.0.1</span></span><br><span class="line"><span class="comment">#轮播图</span></span><br><span class="line"><span class="attr">flutter_swiper_plus:</span> <span class="string">^2.0.4</span></span><br><span class="line"><span class="comment"># GET WIDGET UI库</span></span><br><span class="line"><span class="attr">getwidget:</span> <span class="string">^2.0.5</span></span><br><span class="line"><span class="comment">#图片缓存</span></span><br><span class="line"><span class="attr">cached_network_image:</span> <span class="string">^3.2.0</span></span><br><span class="line"><span class="comment">#图片放大缩小</span></span><br><span class="line"><span class="attr">photo_view:</span> <span class="string">^0.13.0</span></span><br><span class="line"><span class="comment">#权限申请</span></span><br><span class="line"><span class="attr">permission_handler:</span> <span class="string">^9.2.0</span></span><br><span class="line"><span class="comment">#贝壳组件库</span></span><br><span class="line"><span class="attr">bruno:</span> <span class="string">^2.2.0</span></span><br><span class="line"><span class="comment">#easyloading</span></span><br><span class="line"><span class="attr">flutter_easyloading:</span> <span class="string">^3.0.3</span></span><br></pre></td></tr></table></figure>
<h3 id="代码如下"><a class="markdownIt-Anchor" href="#代码如下">#</a> 代码如下：</h3>
<h4 id="commondart"><a class="markdownIt-Anchor" href="#commondart">#</a> common.dart</h4>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;dart:io&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;dart:math&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:bruno/bruno.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter_screenutil/flutter_screenutil.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:get/get.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:getwidget/getwidget.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:provider/provider.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:weat/main.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Common组件库</span></span><br><span class="line"><span class="comment"> * @Auth: Brath</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 获取title的AppBar</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">AppBar getAppBar(<span class="built_in">String</span> title, &#123;<span class="keyword">required</span> context&#125;) &#123;</span><br><span class="line">  <span class="keyword">return</span> AppBar(</span><br><span class="line">      toolbarHeight: <span class="number">40.0</span>.h,</span><br><span class="line">      centerTitle: <span class="keyword">true</span>,</span><br><span class="line">      shadowColor: Color.fromARGB(<span class="number">255</span>, <span class="number">59</span>, <span class="number">82</span>, <span class="number">76</span>),</span><br><span class="line">      backgroundColor: Colors.transparent,</span><br><span class="line">      leading: <span class="keyword">null</span>,</span><br><span class="line">      leadingWidth: <span class="number">30.</span>w,</span><br><span class="line">      elevation: <span class="number">0.0</span>,</span><br><span class="line">      actions: [],</span><br><span class="line">      title: (Text(</span><br><span class="line">        title,</span><br><span class="line">        style: TextStyle(</span><br><span class="line">            fontSize: <span class="number">16.</span>sp,</span><br><span class="line">            color: Colors.black,</span><br><span class="line">            fontFamily: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            fontWeight: FontWeight.bold),</span><br><span class="line">      )));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 获取卡片圆形背景容器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">getCardContainer</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  getCardContainer(&#123;</span><br><span class="line">    Key? key,</span><br><span class="line">    <span class="keyword">this</span>.isBorder,</span><br><span class="line">    <span class="keyword">this</span>.BorderCircular,</span><br><span class="line">    <span class="keyword">this</span>.width,</span><br><span class="line">    <span class="keyword">this</span>.height,</span><br><span class="line">    <span class="keyword">this</span>.widget,</span><br><span class="line">    <span class="keyword">this</span>.margin,</span><br><span class="line">  &#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">bool?</span> isBorder;</span><br><span class="line">  <span class="built_in">double?</span> BorderCircular;</span><br><span class="line">  <span class="built_in">double?</span> height;</span><br><span class="line">  <span class="built_in">double?</span> width;</span><br><span class="line">  Widget? widget;</span><br><span class="line">  EdgeInsetsGeometry? margin;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Container(</span><br><span class="line">      margin: margin,</span><br><span class="line">      decoration: isBorder == <span class="keyword">true</span></span><br><span class="line">          ? BoxDecoration(</span><br><span class="line">              color: Colors.white,</span><br><span class="line">              shape: BoxShape.rectangle,</span><br><span class="line">              boxShadow: [</span><br><span class="line">                BoxShadow(</span><br><span class="line">                  color: Colors.grey[<span class="number">200</span>]!,</span><br><span class="line">                  offset: Offset(<span class="number">1.</span>w, <span class="number">1.</span>h),</span><br><span class="line">                  blurRadius: <span class="number">1.</span>r,</span><br><span class="line">                  spreadRadius: <span class="number">1.</span>r,</span><br><span class="line">                ),</span><br><span class="line">              ],</span><br><span class="line">              border: Border.all(color: Colors.white, width: <span class="number">1.</span>w), <span class="comment">// border</span></span><br><span class="line">              borderRadius:</span><br><span class="line">                  BorderRadius.circular((BorderCircular ?? <span class="number">15.</span>r)), <span class="comment">// 圆角</span></span><br><span class="line">            )</span><br><span class="line">          : <span class="keyword">null</span>,</span><br><span class="line">      width: width,</span><br><span class="line">      height: height,</span><br><span class="line">      child: widget,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="zoomimagedart"><a class="markdownIt-Anchor" href="#zoomimagedart">#</a> ZoomImage.dart</h4>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;dart:ui&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/services.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter_screenutil/flutter_screenutil.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ZoomImage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  ZoomImage(&#123;Key? key, <span class="keyword">this</span>.url&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line">  <span class="built_in">String?</span> url;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  State&lt;StatefulWidget&gt; createState() &#123;</span><br><span class="line">    <span class="keyword">return</span> _ZoomImage();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_ZoomImage</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">ZoomImage</span>&gt; <span class="title">with</span> <span class="title">SingleTickerProviderStateMixin</span> </span>&#123;</span><br><span class="line">  AnimationController? _controller;</span><br><span class="line">  Animation&lt;Offset&gt;? _animation;</span><br><span class="line">  Offset _offset = Offset.zero;</span><br><span class="line">  <span class="built_in">double</span> _scale = <span class="number">1.0</span>;</span><br><span class="line">  Offset? _normalizedOffset;</span><br><span class="line">  <span class="built_in">double?</span> _previousScale;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">double</span> _kMinFlingVelocity = <span class="number">600.0</span>;</span><br><span class="line">  <span class="built_in">bool</span> _isEnlarge = <span class="keyword">false</span>;</span><br><span class="line">  <span class="built_in">bool</span> _isHideTitleBar = <span class="keyword">false</span>;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    _controller = AnimationController(vsync: <span class="keyword">this</span>);</span><br><span class="line">    _controller?.addListener(() &#123;</span><br><span class="line">      setState(() &#123;</span><br><span class="line">        _offset = _animation!.value;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">    _controller!.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Offset _clampOffset(Offset offset) &#123;</span><br><span class="line">    <span class="keyword">final</span> Size size = context.size!;</span><br><span class="line">    <span class="comment">// widget的屏幕宽度</span></span><br><span class="line">    <span class="keyword">final</span> Offset minOffset = Offset(size.width, size.height) * (<span class="number">1.0</span> - _scale);</span><br><span class="line">    <span class="comment">// 限制他的最小尺寸</span></span><br><span class="line">    <span class="keyword">return</span> Offset(</span><br><span class="line">        offset.dx.clamp(minOffset.dx, <span class="number">0.0</span>), offset.dy.clamp(minOffset.dy, <span class="number">0.0</span>));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _handleOnScaleStart(ScaleStartDetails details) &#123;</span><br><span class="line">    setState(() &#123;</span><br><span class="line">      _isHideTitleBar = <span class="keyword">true</span>;</span><br><span class="line">      _previousScale = _scale;</span><br><span class="line">      _normalizedOffset = (details.focalPoint - _offset) / _scale;</span><br><span class="line">      <span class="comment">// 计算图片放大后的位置</span></span><br><span class="line">      _controller!.stop();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _handleOnScaleUpdate(ScaleUpdateDetails details) &#123;</span><br><span class="line">    setState(() &#123;</span><br><span class="line">      _scale = (_previousScale! * details.scale).clamp(<span class="number">1.0</span>, <span class="number">3.0</span>);</span><br><span class="line">      <span class="comment">// 限制放大倍数 1~3倍</span></span><br><span class="line">      _offset = _clampOffset(details.focalPoint - _normalizedOffset! * _scale);</span><br><span class="line">      <span class="comment">// 更新当前位置</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _handleOnScaleEnd(ScaleEndDetails details) &#123;</span><br><span class="line">    _setSystemUi();</span><br><span class="line">    <span class="keyword">final</span> <span class="built_in">double</span> magnitude = details.velocity.pixelsPerSecond.distanceSquared;</span><br><span class="line">    <span class="keyword">if</span> (magnitude &lt; _kMinFlingVelocity) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">final</span> Offset direction = details.velocity.pixelsPerSecond / magnitude;</span><br><span class="line">    <span class="comment">// 计算当前的方向</span></span><br><span class="line">    <span class="keyword">final</span> <span class="built_in">double</span> distance = (Offset.zero &amp; context.size!).shortestSide;</span><br><span class="line">    <span class="comment">// 计算放大倍速，并相应的放大宽和高，比如原来是600*480的图片，放大后倍数为1.25倍时，宽和高是同时变化的</span></span><br><span class="line">    _animation = _controller!.drive(Tween&lt;Offset&gt;(</span><br><span class="line">        begin: _offset, end: _clampOffset(_offset + direction * distance)));</span><br><span class="line">    _controller!</span><br><span class="line">      ..value = <span class="number">0.0</span></span><br><span class="line">      ..fling(velocity: magnitude / <span class="number">1000.0</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _onDoubleTap() &#123;</span><br><span class="line">    _isHideTitleBar = <span class="keyword">true</span>;</span><br><span class="line">    _setSystemUi();</span><br><span class="line">    Size size = context.size!;</span><br><span class="line">    _isEnlarge = !_isEnlarge;</span><br><span class="line">    setState(() &#123;</span><br><span class="line">      <span class="keyword">if</span> (!_isEnlarge) &#123;</span><br><span class="line">        _scale = <span class="number">2.0</span>;</span><br><span class="line">        _offset = Offset(-(size.width / <span class="number">2</span>), -(size.height / <span class="number">2</span>));</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        _scale = <span class="number">1.0</span>;</span><br><span class="line">        _offset = Offset.zero;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _onTap() &#123;</span><br><span class="line">    setState(() &#123;</span><br><span class="line">      _isHideTitleBar = !_isHideTitleBar;</span><br><span class="line">    &#125;);</span><br><span class="line">    _setSystemUi();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Stack(</span><br><span class="line">      children: [_bodyView(), _titleBar()],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _bodyView() &#123;</span><br><span class="line">    <span class="keyword">return</span> GestureDetector(</span><br><span class="line">      onScaleStart: _handleOnScaleStart,</span><br><span class="line">      onScaleUpdate: _handleOnScaleUpdate,</span><br><span class="line">      onScaleEnd: _handleOnScaleEnd,</span><br><span class="line">      onDoubleTap: _onDoubleTap,</span><br><span class="line">      onTap: _onTap,</span><br><span class="line">      child: Container(</span><br><span class="line">        color: _isHideTitleBar ? Colors.black : Colors.white,</span><br><span class="line">        child: SizedBox.expand(</span><br><span class="line">          child: ClipRect(</span><br><span class="line">            child: Transform(</span><br><span class="line">              transform: Matrix4.identity()</span><br><span class="line">                ..translate(_offset.dx, _offset.dy)</span><br><span class="line">                ..scale(_scale),</span><br><span class="line">              child: Column(</span><br><span class="line">                mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">                children: [</span><br><span class="line">                  SizedBox(</span><br><span class="line">                      width: <span class="number">700.0</span>.w,</span><br><span class="line">                      height: <span class="number">600.0</span>.h,</span><br><span class="line">                      child: Image.network(widget.url!)),</span><br><span class="line">                  Container()</span><br><span class="line">                ],</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _titleBar() &#123;</span><br><span class="line">    <span class="keyword">return</span> Offstage(</span><br><span class="line">      child: Container(</span><br><span class="line">        alignment: Alignment.centerLeft,</span><br><span class="line">        padding: EdgeInsets.only(</span><br><span class="line">            top: MediaQueryData.fromWindow(<span class="built_in">window</span>).padding.top,</span><br><span class="line">            left: ScreenUtil().setWidth(<span class="number">24</span>)),</span><br><span class="line">        color: <span class="keyword">const</span> Color.fromARGB(<span class="number">255</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">32</span>),</span><br><span class="line">        height: MediaQuery.of(context).size.height * <span class="number">0.1</span>,</span><br><span class="line">        width: MediaQuery.of(context).size.width,</span><br><span class="line">        child: GestureDetector(</span><br><span class="line">          child: Icon(</span><br><span class="line">            Icons.arrow_back,</span><br><span class="line">            size: <span class="number">30.0</span>.w,</span><br><span class="line">            color: Colors.white,</span><br><span class="line">          ),</span><br><span class="line">          onTap: () &#123;</span><br><span class="line">            Navigator.pop(context);</span><br><span class="line">          &#125;,</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">      offstage: _isHideTitleBar,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _setSystemUi() &#123;</span><br><span class="line">    <span class="keyword">if</span> (_isHideTitleBar) &#123;</span><br><span class="line">      SystemChrome.setEnabledSystemUIMode(SystemUiMode.edgeToEdge);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      SystemChrome.setEnabledSystemUIMode(SystemUiMode.manual);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="globaldart"><a class="markdownIt-Anchor" href="#globaldart">#</a> Global.dart</h4>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:dio/dio.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Global</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="built_in">String</span> BaseUrl = <span class="string">&#x27;http://127.0.0.1:9999/&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*请求dio对象 */</span></span><br><span class="line">  <span class="keyword">late</span> Dio dio;</span><br><span class="line">  <span class="comment">/*通用超时 */</span></span><br><span class="line">  <span class="built_in">int</span> timeOut = <span class="number">50000</span>;</span><br><span class="line">  <span class="comment">/*请求单例 */</span></span><br><span class="line">  <span class="keyword">static</span> Global? _instance;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*获取实例 */</span></span><br><span class="line">  <span class="keyword">static</span> Global? getInstance() &#123;</span><br><span class="line">    <span class="keyword">if</span> (_instance == <span class="keyword">null</span>) _instance = Global();</span><br><span class="line">    <span class="keyword">return</span> _instance;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Global() &#123;</span><br><span class="line">    dio = Dio();</span><br><span class="line">    dio.options = BaseOptions(</span><br><span class="line">        baseUrl: BaseUrl,</span><br><span class="line">        connectTimeout: timeOut,</span><br><span class="line">        sendTimeout: timeOut,</span><br><span class="line">        receiveTimeout: timeOut,</span><br><span class="line">        contentType: Headers.jsonContentType,</span><br><span class="line">        headers: &#123;</span><br><span class="line">          <span class="string">&quot;Access-Control-Allow-Origin&quot;</span>: <span class="string">&quot;*&quot;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">    <span class="comment">// 请求拦截器 and 响应拦截机 and 错误处理</span></span><br><span class="line">    dio.interceptors.add(InterceptorsWrapper(onRequest: (options, handler) &#123;</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;\n================== 请求数据 ==========================&quot;</span>);</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;url = <span class="subst">$&#123;options.uri.toString()&#125;</span>&quot;</span>);</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;headers = <span class="subst">$&#123;options.headers&#125;</span>&quot;</span>);</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;params = <span class="subst">$&#123;options.data&#125;</span>&quot;</span>);</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;\n================== 请求数据 ==========================&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> handler.next(options);</span><br><span class="line">    &#125;, onResponse: (response, handler) &#123;</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;\n================== 响应数据 ==========================&quot;</span>);</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;code = <span class="subst">$&#123;response.statusCode&#125;</span>&quot;</span>);</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;data = <span class="subst">$&#123;response.data&#125;</span>&quot;</span>);</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;\n================== 响应数据 ==========================&quot;</span>);</span><br><span class="line">      handler.next(response);</span><br><span class="line">    &#125;, onError: (DioError e, handler) &#123;</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;\n================== 错误响应数据 ======================&quot;</span>);</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;type = <span class="subst">$&#123;e.type&#125;</span>&quot;</span>);</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;message = <span class="subst">$&#123;e.message&#125;</span>&quot;</span>);</span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;\n================== 错误响应数据 ======================&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> handler.next(e);</span><br><span class="line">    &#125;));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="routesdart"><a class="markdownIt-Anchor" href="#routesdart">#</a> routes.dart</h4>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ignore_for_file: prefer_const_constructors</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/cupertino.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:weat/views/index/IndexView.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Map</span>&lt;<span class="built_in">String</span>, WidgetBuilder&gt; routes = &#123;</span><br><span class="line">  <span class="string">&quot;/&quot;</span>: (context) =&gt; IndexView(),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 渐隐跳转路由</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> opcityPush(BuildContext context, Widget view, &#123;<span class="built_in">int?</span> milliseconds&#125;) &#123;</span><br><span class="line">  Navigator.push(</span><br><span class="line">    context,</span><br><span class="line">    PageRouteBuilder(</span><br><span class="line">      transitionDuration:</span><br><span class="line">          <span class="built_in">Duration</span>(milliseconds: milliseconds ?? <span class="number">300</span>), <span class="comment">//动画时间为300毫秒</span></span><br><span class="line">      pageBuilder: (BuildContext context, Animation&lt;<span class="built_in">double</span>&gt; animation,</span><br><span class="line">          Animation secondaryAnimation) &#123;</span><br><span class="line">        <span class="keyword">return</span> FadeTransition(</span><br><span class="line">          <span class="comment">//使用渐隐渐入过渡,</span></span><br><span class="line">          opacity: animation,</span><br><span class="line">          child: view, <span class="comment">//路由B</span></span><br><span class="line">        );</span><br><span class="line">      &#125;,</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 带路由树跳转</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> Push(BuildContext context, Widget view) &#123;</span><br><span class="line">  Navigator.push(</span><br><span class="line">      context,</span><br><span class="line">      CupertinoPageRoute(</span><br><span class="line">        builder: (context) =&gt; view,</span><br><span class="line">      ));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> NavigatorPop(BuildContext context) &#123;</span><br><span class="line">  Navigator.of(context).pop();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 返回上一级路由树，没有上级会黑屏</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> Pop(BuildContext context, Widget view) &#123;</span><br><span class="line">  Navigator.pop(</span><br><span class="line">      context,</span><br><span class="line">      CupertinoPageRoute(</span><br><span class="line">        builder: (context) =&gt; view,</span><br><span class="line">      ));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="showmessage_utildart"><a class="markdownIt-Anchor" href="#showmessage_utildart">#</a> showmessage_util.dart</h4>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ignore_for_file: prefer_equal_for_default_values, sized_box_for_whitespace</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter_screenutil/flutter_screenutil.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:fluttertoast/fluttertoast.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// <span class="language-markdown">@author brath</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">@创建时间：2022/5/10</span></span></span><br><span class="line"><span class="comment">/// <span class="language-markdown">封装自定义弹框</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DialogUtils</span> </span>&#123;</span><br><span class="line">  <span class="comment">/// <span class="language-markdown">显示普通消息</span></span></span><br><span class="line">  <span class="keyword">static</span> showMessage(<span class="built_in">String</span> msg,</span><br><span class="line">      &#123;toastLength: Toast.LENGTH_LONG,</span><br><span class="line">      gravity: ToastGravity.CENTER,</span><br><span class="line">      timeInSecForIosWeb: <span class="number">2</span>,</span><br><span class="line">      textColor: Colors.black,</span><br><span class="line">      backgroundColor: Colors.grey,</span><br><span class="line">      fontSize: <span class="number">16.0</span>&#125;) &#123;</span><br><span class="line">    <span class="comment">// 先关闭弹框再显示对应弹框</span></span><br><span class="line">    Fluttertoast.cancel();</span><br><span class="line">    Fluttertoast.showToast(</span><br><span class="line">      msg: msg,</span><br><span class="line">      toastLength: toastLength,</span><br><span class="line">      webShowClose: <span class="keyword">true</span>,</span><br><span class="line">      gravity: gravity,</span><br><span class="line">      textColor: textColor,</span><br><span class="line">      timeInSecForIosWeb: timeInSecForIosWeb,</span><br><span class="line">      backgroundColor: Colors.grey[<span class="number">50</span>],</span><br><span class="line">      fontSize: <span class="number">13.0</span>.sp,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h4 id="index_viewmodeldart"><a class="markdownIt-Anchor" href="#index_viewmodeldart">#</a> index_viewmodel.dart</h4>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:dio/dio.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IndexViewModel</span> <span class="keyword">extends</span> <span class="title">ChangeNotifier</span> </span>&#123;</span><br><span class="line">  <span class="built_in">bool?</span> isLotte = <span class="keyword">false</span>;</span><br><span class="line">  <span class="built_in">Map?</span> currentDishes = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">bool?</span> <span class="keyword">get</span> getIsLotte &#123;</span><br><span class="line">    <span class="keyword">return</span> isLotte;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> setIsLotte(<span class="built_in">bool</span> isLotte) &#123;</span><br><span class="line">    <span class="keyword">this</span>.isLotte = isLotte;</span><br><span class="line">    notifyListeners();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">Map?</span> <span class="keyword">get</span> getCurrentDishes &#123;</span><br><span class="line">    <span class="keyword">return</span> currentDishes;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> setCurrentDishes(<span class="built_in">Map</span> currentDishes) &#123;</span><br><span class="line">    <span class="keyword">this</span>.currentDishes = currentDishes;</span><br><span class="line">    notifyListeners();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="indexviewdart"><a class="markdownIt-Anchor" href="#indexviewdart">#</a> IndexView.dart</h4>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;dart:math&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter_screenutil/flutter_screenutil.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:getwidget/getwidget.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:provider/provider.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:weat/common/ZoomImage.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:weat/core/Global.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:weat/routers/routes.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:weat/utils/showmessage_util.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:weat/viewmodel/index_viewmodel.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:weat/views/index/DishesDetail.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 首页视图</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IndexView</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> IndexView(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  State&lt;IndexView&gt; createState() =&gt; _IndexViewState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_IndexViewState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">IndexView</span>&gt; </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">const</span> LotterView();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 轮播抽奖页面</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LotterView</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> LotterView(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  State&lt;LotterView&gt; createState() =&gt; _LotterViewState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_LotterViewState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">LotterView</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">//抽奖控制器</span></span><br><span class="line">  <span class="keyword">final</span> SimpleLotteryController _simpleLotteryController =</span><br><span class="line">      SimpleLotteryController();</span><br><span class="line"></span><br><span class="line">  <span class="built_in">int</span> page = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">int</span> size = <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//奖品列表</span></span><br><span class="line">  <span class="built_in">List</span> dishesList = [];</span><br><span class="line"></span><br><span class="line">  <span class="comment">//奖品loding</span></span><br><span class="line">  <span class="built_in">bool</span> load = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//初始化奖品列表</span></span><br><span class="line">  _initPrizeList() <span class="keyword">async</span> &#123;</span><br><span class="line">    Global.getInstance()!.dio.<span class="keyword">get</span>(<span class="string">&quot;dishes/getDishes&quot;</span>, queryParameters: &#123;</span><br><span class="line">      <span class="string">&#x27;page&#x27;</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="string">&#x27;size&#x27;</span>: <span class="number">8</span>,</span><br><span class="line">    &#125;).then((value) =&gt; &#123;</span><br><span class="line">          dishesList = value.data[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;prizeRecords&#x27;</span>],</span><br><span class="line">          load = <span class="keyword">true</span>,</span><br><span class="line">          setState(() &#123;&#125;)</span><br><span class="line">        &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    _initPrizeList();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    _simpleLotteryController.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      body: MediaQuery.removePadding(</span><br><span class="line">        removeTop: <span class="keyword">true</span>,</span><br><span class="line">        context: context,</span><br><span class="line">        child: ListView(</span><br><span class="line">          children: [</span><br><span class="line">            Container(</span><br><span class="line">              width: MediaQuery.of(context).size.width,</span><br><span class="line">              height: MediaQuery.of(context).size.height,</span><br><span class="line">              decoration: BoxDecoration(</span><br><span class="line">                gradient: LinearGradient(</span><br><span class="line">                    begin: Alignment.topLeft, <span class="comment">//左中</span></span><br><span class="line">                    end: Alignment.bottomRight, <span class="comment">//右中</span></span><br><span class="line">                    colors: [</span><br><span class="line">                      Theme.of(context).primaryColor,</span><br><span class="line">                      <span class="keyword">const</span> Color.fromRGBO(<span class="number">180</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>),</span><br><span class="line">                      <span class="keyword">const</span> Color.fromRGBO(<span class="number">187</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>),</span><br><span class="line">                      Theme.of(context).primaryColor</span><br><span class="line">                    ]),</span><br><span class="line">              ),</span><br><span class="line">              child: Column(</span><br><span class="line">                children: [</span><br><span class="line">                  Container(</span><br><span class="line">                    padding: EdgeInsets.only(top: <span class="number">50.</span>h),</span><br><span class="line">                    child: Wrap(</span><br><span class="line">                      children: [</span><br><span class="line">                        Text(<span class="string">&#x27;今日菜品&#x27;</span>,</span><br><span class="line">                            style: TextStyle(</span><br><span class="line">                              fontSize: <span class="number">32.</span>sp,</span><br><span class="line">                              fontWeight: FontWeight.w600,</span><br><span class="line">                              fontFamily: <span class="string">&#x27;jinbu&#x27;</span>,</span><br><span class="line">                              color: Colors.white,</span><br><span class="line">                            )),</span><br><span class="line">                        Text(</span><br><span class="line">                          <span class="string">&#x27;大放送&#x27;</span>,</span><br><span class="line">                          style: TextStyle(</span><br><span class="line">                              fontSize: <span class="number">32.</span>sp,</span><br><span class="line">                              fontWeight: FontWeight.w600,</span><br><span class="line">                              fontFamily: <span class="string">&#x27;jinbu&#x27;</span>,</span><br><span class="line">                              color: <span class="keyword">const</span> Color.fromARGB(<span class="number">255</span>, <span class="number">252</span>, <span class="number">217</span>, <span class="number">61</span>)),</span><br><span class="line">                        )</span><br><span class="line">                      ],</span><br><span class="line">                    ),</span><br><span class="line">                  ),</span><br><span class="line">                  Container(</span><br><span class="line">                    margin: EdgeInsets.only(top: <span class="number">10.</span>h),</span><br><span class="line">                    alignment: Alignment.center,</span><br><span class="line">                    child: Text(</span><br><span class="line">                      <span class="string">&#x27;猜猜今天是什么菜系？&#x27;</span>,</span><br><span class="line">                      style: TextStyle(</span><br><span class="line">                        fontSize: <span class="number">12.</span>sp,</span><br><span class="line">                        color: Colors.white,</span><br><span class="line">                        fontFamily: <span class="string">&#x27;jinbu&#x27;</span>,</span><br><span class="line">                      ),</span><br><span class="line">                    ),</span><br><span class="line">                  ),</span><br><span class="line">                  SizedBox(</span><br><span class="line">                    height: <span class="number">10.</span>h,</span><br><span class="line">                  ),</span><br><span class="line">                  Padding(</span><br><span class="line">                    padding: EdgeInsets.all(<span class="number">12.0</span>.sp),</span><br><span class="line">                    child: Container(</span><br><span class="line">                      height: <span class="number">400.</span>h,</span><br><span class="line">                      padding: EdgeInsets.all(<span class="number">14.</span>sp),</span><br><span class="line">                      decoration: BoxDecoration(</span><br><span class="line">                          gradient: LinearGradient(</span><br><span class="line">                              begin: Alignment.topLeft, <span class="comment">//左中</span></span><br><span class="line">                              end: Alignment.bottomRight, <span class="comment">//右中</span></span><br><span class="line">                              colors: [</span><br><span class="line">                                Theme.of(context).primaryColor,</span><br><span class="line">                                <span class="keyword">const</span> Color.fromRGBO(<span class="number">180</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>),</span><br><span class="line">                                <span class="keyword">const</span> Color.fromRGBO(<span class="number">187</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>),</span><br><span class="line">                                Theme.of(context).primaryColor</span><br><span class="line">                              ]),</span><br><span class="line">                          <span class="comment">// color: const Color.fromARGB(255, 205, 221, 235),</span></span><br><span class="line">                          border: Border.all(</span><br><span class="line">                              color: Colors.transparent, width: <span class="number">14.</span>w),</span><br><span class="line">                          borderRadius:</span><br><span class="line">                              BorderRadius.all(Radius.elliptical(<span class="number">20.</span>r, <span class="number">20.</span>r))),</span><br><span class="line">                      child: Column(</span><br><span class="line">                        mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">                        children: [</span><br><span class="line">                          load</span><br><span class="line">                              ? SimpleLotteryWidget(</span><br><span class="line">                                  dishesList: dishesList,</span><br><span class="line">                                  simpleLotteryController:</span><br><span class="line">                                      _simpleLotteryController)</span><br><span class="line">                              : SizedBox(</span><br><span class="line">                                  width: <span class="built_in">double</span>.infinity,</span><br><span class="line">                                  height: <span class="number">260.</span>h,</span><br><span class="line">                                  child: <span class="keyword">const</span> GFLoader(</span><br><span class="line">                                      type: GFLoaderType.ios,</span><br><span class="line">                                      loaderColorOne: Colors.blue,</span><br><span class="line">                                      loaderColorTwo: Colors.blue,</span><br><span class="line">                                      loaderColorThree: Colors.blue,</span><br><span class="line">                                      duration: <span class="built_in">Duration</span>(milliseconds: <span class="number">300</span>)),</span><br><span class="line">                                ),</span><br><span class="line">                          <span class="comment">//抽奖按钮</span></span><br><span class="line">                          AnimatedSwitcher(</span><br><span class="line">                            duration: <span class="keyword">const</span> <span class="built_in">Duration</span>(milliseconds: <span class="number">400</span>),</span><br><span class="line">                            child: Provider.of&lt;IndexViewModel&gt;(context,</span><br><span class="line">                                        listen: <span class="keyword">true</span>)</span><br><span class="line">                                    .getIsLotte!</span><br><span class="line">                                ? SizedBox(</span><br><span class="line">                                    height: <span class="number">34.</span>h,</span><br><span class="line">                                    width: MediaQuery.of(context).size.width -</span><br><span class="line">                                        <span class="number">120.</span>w,</span><br><span class="line">                                    child: ElevatedButton(</span><br><span class="line">                                      style: ElevatedButton.styleFrom(</span><br><span class="line">                                        primary: Colors.red[<span class="number">200</span>], <span class="comment">//chan</span></span><br><span class="line">                                        onPrimary: Colors</span><br><span class="line">                                            .white, <span class="comment">//change text color of button</span></span><br><span class="line">                                        shape: RoundedRectangleBorder(</span><br><span class="line">                                          borderRadius:</span><br><span class="line">                                              BorderRadius.circular(<span class="number">30.</span>r),</span><br><span class="line">                                        ),</span><br><span class="line">                                        elevation: <span class="number">3.0</span>.h,</span><br><span class="line">                                      ),</span><br><span class="line">                                      onPressed: () &#123;</span><br><span class="line">                                        <span class="comment">//跳转详情页面</span></span><br><span class="line">                                        Push(</span><br><span class="line">                                            context,</span><br><span class="line">                                            DishesDetailView(</span><br><span class="line">                                                dishes:</span><br><span class="line">                                                    Provider.of&lt;IndexViewModel&gt;(</span><br><span class="line">                                                            context,</span><br><span class="line">                                                            listen: <span class="keyword">false</span>)</span><br><span class="line">                                                        .getCurrentDishes));</span><br><span class="line">                                        <span class="comment">//设置状态</span></span><br><span class="line">                                        Provider.of&lt;IndexViewModel&gt;(context,</span><br><span class="line">                                                listen: <span class="keyword">false</span>)</span><br><span class="line">                                            .setIsLotte(<span class="keyword">false</span>);</span><br><span class="line">                                      &#125;,</span><br><span class="line">                                      child: Row(</span><br><span class="line">                                        mainAxisAlignment:</span><br><span class="line">                                            MainAxisAlignment.center,</span><br><span class="line">                                        children: [</span><br><span class="line">                                          SizedBox(</span><br><span class="line">                                            width: <span class="number">4.</span>w,</span><br><span class="line">                                          ),</span><br><span class="line">                                          Text(</span><br><span class="line">                                            <span class="string">&#x27;点击查看：<span class="subst">$&#123;Provider.of&lt;IndexViewModel&gt;(context, listen: <span class="keyword">false</span>).getCurrentDishes![<span class="string">&#x27;dishesName&#x27;</span>]&#125;</span>&#x27;</span>,</span><br><span class="line">                                            style: TextStyle(</span><br><span class="line">                                                fontWeight: FontWeight.w500,</span><br><span class="line">                                                fontFamily: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                                                color: Colors.white,</span><br><span class="line">                                                fontSize: <span class="number">14.0</span>.sp),</span><br><span class="line">                                          ),</span><br><span class="line">                                        ],</span><br><span class="line">                                      ),</span><br><span class="line">                                    ))</span><br><span class="line">                                : SizedBox(</span><br><span class="line">                                    height: <span class="number">34.</span>h,</span><br><span class="line">                                    width: MediaQuery.of(context).size.width -</span><br><span class="line">                                        <span class="number">220.</span>w,</span><br><span class="line">                                    child: ElevatedButton(</span><br><span class="line">                                      style: ElevatedButton.styleFrom(</span><br><span class="line">                                        primary: Colors.red[<span class="number">200</span>], <span class="comment">//chan</span></span><br><span class="line">                                        onPrimary: Colors</span><br><span class="line">                                            .white, <span class="comment">//change text color of button</span></span><br><span class="line">                                        shape: RoundedRectangleBorder(</span><br><span class="line">                                          borderRadius:</span><br><span class="line">                                              BorderRadius.circular(<span class="number">30.</span>r),</span><br><span class="line">                                        ),</span><br><span class="line">                                        elevation: <span class="number">3.0</span>.h,</span><br><span class="line">                                      ),</span><br><span class="line">                                      onPressed: () &#123;</span><br><span class="line">                                        <span class="comment">//开始抽奖</span></span><br><span class="line">                                        _simpleLotteryController.start(</span><br><span class="line">                                            Random.secure().nextInt(<span class="number">2</span>)); <span class="comment">//开启</span></span><br><span class="line">                                        setState(() &#123;&#125;);</span><br><span class="line">                                      &#125;,</span><br><span class="line">                                      child: Row(</span><br><span class="line">                                        mainAxisAlignment:</span><br><span class="line">                                            MainAxisAlignment.center,</span><br><span class="line">                                        children: [</span><br><span class="line">                                          SizedBox(</span><br><span class="line">                                            width: <span class="number">4.</span>w,</span><br><span class="line">                                          ),</span><br><span class="line">                                          Text(</span><br><span class="line">                                            <span class="string">&#x27;吃啥&#x27;</span>,</span><br><span class="line">                                            style: TextStyle(</span><br><span class="line">                                                fontWeight: FontWeight.w500,</span><br><span class="line">                                                fontFamily: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                                                color: Colors.white,</span><br><span class="line">                                                fontSize: <span class="number">14.0</span>.sp),</span><br><span class="line">                                          ),</span><br><span class="line">                                        ],</span><br><span class="line">                                      ),</span><br><span class="line">                                    )),</span><br><span class="line">                          )</span><br><span class="line">                        ],</span><br><span class="line">                      ),</span><br><span class="line">                    ),</span><br><span class="line">                  ),</span><br><span class="line">                ],</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//奖品参数</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleLotteryValue</span> </span>&#123;</span><br><span class="line">  SimpleLotteryValue(</span><br><span class="line">      &#123;<span class="keyword">this</span>.target = <span class="number">0</span>, <span class="keyword">this</span>.isFinish = <span class="keyword">false</span>, <span class="keyword">this</span>.isPlaying = <span class="keyword">false</span>&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="language-markdown">中奖目标</span></span></span><br><span class="line">  <span class="built_in">int</span> target = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">bool</span> isPlaying = <span class="keyword">false</span>;</span><br><span class="line">  <span class="built_in">bool</span> isFinish = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">  SimpleLotteryValue copyWith(&#123;</span><br><span class="line">    <span class="built_in">int</span> target = <span class="number">0</span>,</span><br><span class="line">    <span class="built_in">bool</span> isPlaying = <span class="keyword">false</span>,</span><br><span class="line">    <span class="built_in">bool</span> isFinish = <span class="keyword">false</span>,</span><br><span class="line">  &#125;) &#123;</span><br><span class="line">    <span class="keyword">return</span> SimpleLotteryValue(</span><br><span class="line">        target: target, isFinish: isFinish, isPlaying: isPlaying);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="built_in">String</span> toString() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;target : <span class="subst">$target</span> , isPlaying : <span class="subst">$isPlaying</span> , isFinish : <span class="subst">$isFinish</span>&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//抽奖控制器</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleLotteryController</span> <span class="keyword">extends</span> <span class="title">ValueNotifier</span> </span>&#123;</span><br><span class="line">  SimpleLotteryController() : <span class="keyword">super</span>(SimpleLotteryValue());</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="language-markdown">开启抽奖</span></span></span><br><span class="line">  <span class="comment">///</span></span><br><span class="line">  <span class="comment">/// <span class="language-markdown">[target] 中奖目标</span></span></span><br><span class="line">  <span class="keyword">void</span> start(<span class="built_in">int</span> target) &#123;</span><br><span class="line">    <span class="comment">// 九宫格抽奖里范围为0~8</span></span><br><span class="line">    <span class="keyword">assert</span>(target &gt;= <span class="number">0</span> &amp;&amp; target &lt;= <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span> (value.isPlaying) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    value = value.copyWith(target: target, isPlaying: <span class="keyword">true</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> finish() &#123;</span><br><span class="line">    value = value.copyWith(isFinish: <span class="keyword">true</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 奖品列表容器 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleLotteryWidget</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> SimpleLotteryController simpleLotteryController;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span> dishesList;</span><br><span class="line">  <span class="keyword">const</span> SimpleLotteryWidget(</span><br><span class="line">      &#123;Key? key,</span><br><span class="line">      <span class="keyword">required</span> <span class="keyword">this</span>.dishesList,</span><br><span class="line">      <span class="keyword">required</span> <span class="keyword">this</span>.simpleLotteryController&#125;)</span><br><span class="line">      : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  State&lt;SimpleLotteryWidget&gt; createState() =&gt; _SimpleLotteryWidgetState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_SimpleLotteryWidgetState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">SimpleLotteryWidget</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="title">with</span> <span class="title">TickerProviderStateMixin</span> </span>&#123;</span><br><span class="line">  Future&lt;<span class="built_in">int</span>&gt;? future; <span class="comment">// 标识</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> FutureBuilder(</span><br><span class="line">      future: future,</span><br><span class="line">      builder: (context, snapshot) &#123;</span><br><span class="line">        <span class="keyword">return</span> Container(</span><br><span class="line">            margin: EdgeInsets.all(<span class="number">5.</span>h),</span><br><span class="line">            width: <span class="built_in">double</span>.infinity,</span><br><span class="line">            height: <span class="number">280.</span>h,</span><br><span class="line">            child: GridView.builder(</span><br><span class="line">                physics: <span class="keyword">const</span> NeverScrollableScrollPhysics(),</span><br><span class="line">                itemCount: <span class="number">9</span>,</span><br><span class="line">                gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(</span><br><span class="line">                    crossAxisCount: <span class="number">3</span>,</span><br><span class="line">                    crossAxisSpacing: <span class="number">8.</span>w,</span><br><span class="line">                    mainAxisSpacing: <span class="number">8.</span>h),</span><br><span class="line">                itemBuilder: (context, index) &#123;</span><br><span class="line">                  <span class="keyword">if</span> (index != <span class="number">4</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> commodity(index);</span><br><span class="line">                  &#125;</span><br><span class="line">                  <span class="keyword">return</span> Image.network(</span><br><span class="line">                    <span class="string">&#x27;https://brath.cloud/app_log.png&#x27;</span>,</span><br><span class="line">                    fit: BoxFit.cover,</span><br><span class="line">                  );</span><br><span class="line">                &#125;));</span><br><span class="line">      &#125;,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 奖品列表</span></span><br><span class="line">  Widget commodity(<span class="built_in">int</span> index) &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="built_in">int</span> toIndex;</span><br><span class="line">    toIndex = _deserializeMap[index];</span><br><span class="line">    <span class="keyword">return</span> GestureDetector(</span><br><span class="line">      onTap: () &#123;</span><br><span class="line">        opcityPush(context,</span><br><span class="line">            ZoomImage(url: <span class="string">&#x27;<span class="subst">$&#123;widget.dishesList[toIndex][<span class="string">&#x27;dishesUrl&#x27;</span>]&#125;</span>&#x27;</span>));</span><br><span class="line">      &#125;,</span><br><span class="line">      child: Stack(</span><br><span class="line">        children: [</span><br><span class="line">          Container(</span><br><span class="line">            decoration: BoxDecoration(</span><br><span class="line">              borderRadius: BorderRadius.all(Radius.circular(<span class="number">10.</span>r)),</span><br><span class="line">              color: widget.dishesList[toIndex][<span class="string">&#x27;id&#x27;</span>]! &gt; <span class="number">5</span></span><br><span class="line">                  ? Colors.red[<span class="number">300</span>]!.withAlpha(<span class="number">32</span>)</span><br><span class="line">                  : widget.dishesList[toIndex][<span class="string">&#x27;id&#x27;</span>]! &gt;= <span class="number">4</span> &amp;&amp;</span><br><span class="line">                          widget.dishesList[toIndex][<span class="string">&#x27;id&#x27;</span>] &lt;= <span class="number">5</span></span><br><span class="line">                      ? Colors.amber[<span class="number">300</span>]!.withAlpha(<span class="number">32</span>)</span><br><span class="line">                      : Colors.blue[<span class="number">300</span>]!.withAlpha(<span class="number">32</span>),</span><br><span class="line">            ),</span><br><span class="line">            child: SizedBox(</span><br><span class="line">              width: <span class="built_in">double</span>.infinity,</span><br><span class="line">              height: <span class="built_in">double</span>.infinity,</span><br><span class="line">              child: Column(</span><br><span class="line">                mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">                children: [</span><br><span class="line">                  Image.network(</span><br><span class="line">                    <span class="string">&#x27;<span class="subst">$&#123;widget.dishesList[toIndex][<span class="string">&#x27;dishesUrl&#x27;</span>]&#125;</span>&#x27;</span>,</span><br><span class="line">                    fit: BoxFit.cover,</span><br><span class="line">                    width: <span class="number">60.</span>w,</span><br><span class="line">                    height: <span class="number">60.</span>w,</span><br><span class="line">                  ),</span><br><span class="line">                  SizedBox(</span><br><span class="line">                    height: <span class="number">5.</span>h,</span><br><span class="line">                  ),</span><br><span class="line">                  Text(</span><br><span class="line">                    <span class="string">&#x27;<span class="subst">$&#123;widget.dishesList[toIndex][<span class="string">&#x27;dishesName&#x27;</span>]&#125;</span>&#x27;</span>,</span><br><span class="line">                    maxLines: <span class="number">1</span>,</span><br><span class="line">                    overflow: TextOverflow.ellipsis,</span><br><span class="line">                    style: TextStyle(</span><br><span class="line">                      fontFamily: <span class="string">&#x27;jinbu&#x27;</span>,</span><br><span class="line">                      fontSize: <span class="number">9.</span>sp,</span><br><span class="line">                      color: Theme.of(context).primaryColor,</span><br><span class="line">                    ),</span><br><span class="line">                  ),</span><br><span class="line">                ],</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">          Container(</span><br><span class="line">              decoration: BoxDecoration(</span><br><span class="line">            color: index == _currentSelect</span><br><span class="line">                ? Colors.yellow.withOpacity(<span class="number">0.5</span>)</span><br><span class="line">                : Colors.transparent,</span><br><span class="line">            borderRadius: BorderRadius.all(Radius.circular(<span class="number">10.</span>r)),</span><br><span class="line">          )),</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Animation? _selectedIndexTween;</span><br><span class="line">  AnimationController? _startAnimateController;</span><br><span class="line">  <span class="built_in">int</span> _currentSelect = <span class="number">-1</span>;</span><br><span class="line">  <span class="built_in">int</span> _target = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="language-markdown">旋转的圈数</span></span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">int</span> repeatRound = <span class="number">4</span>;</span><br><span class="line">  VoidCallback? _listener;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="language-markdown">选中下标的映射</span></span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">Map</span> _selectMap = &#123;<span class="number">0</span>: <span class="number">0</span>, <span class="number">1</span>: <span class="number">3</span>, <span class="number">2</span>: <span class="number">6</span>, <span class="number">3</span>: <span class="number">7</span>, <span class="number">4</span>: <span class="number">8</span>, <span class="number">5</span>: <span class="number">5</span>, <span class="number">6</span>: <span class="number">2</span>, <span class="number">7</span>: <span class="number">1</span>&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//反下标的映射</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">Map</span> _deserializeMap = &#123;</span><br><span class="line">    <span class="number">0</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="number">3</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="number">4</span>: <span class="number">8</span>,</span><br><span class="line">    <span class="number">6</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="number">7</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="number">8</span>: <span class="number">4</span>,</span><br><span class="line">    <span class="number">5</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="number">2</span>: <span class="number">6</span>,</span><br><span class="line">    <span class="number">1</span>: <span class="number">7</span></span><br><span class="line">  &#125;;</span><br><span class="line">  simpleLotteryWidgetState() &#123;</span><br><span class="line">    _listener = () &#123;</span><br><span class="line">      <span class="comment">// 开启抽奖动画</span></span><br><span class="line">      <span class="keyword">if</span> (widget.simpleLotteryController.value.isPlaying) &#123;</span><br><span class="line">        _startAnimateController?.reset();</span><br><span class="line">        _target = widget.simpleLotteryController.value.target;</span><br><span class="line">        _selectedIndexTween = _initSelectIndexTween(_target);</span><br><span class="line"></span><br><span class="line">        _startAnimateController?.forward();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="language-markdown">初始化tween</span></span></span><br><span class="line">  <span class="comment">///</span></span><br><span class="line">  <span class="comment">/// <span class="language-markdown">[target] 中奖的目标</span></span></span><br><span class="line">  Animation _initSelectIndexTween(<span class="built_in">int</span> target) =&gt;</span><br><span class="line">      StepTween(begin: <span class="number">0</span>, end: repeatRound * <span class="number">8</span> + target).animate(</span><br><span class="line">          CurvedAnimation(</span><br><span class="line">              parent: _startAnimateController!, curve: Curves.easeOutQuart));</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line"></span><br><span class="line">    future = Future.value(<span class="number">42</span>);</span><br><span class="line"></span><br><span class="line">    _startAnimateController =</span><br><span class="line">        AnimationController(vsync: <span class="keyword">this</span>, duration: <span class="keyword">const</span> <span class="built_in">Duration</span>(seconds: <span class="number">5</span>));</span><br><span class="line">    _selectedIndexTween = _initSelectIndexTween(_target);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//开启动画</span></span><br><span class="line">    simpleLotteryWidgetState();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 控制监听</span></span><br><span class="line">    widget.simpleLotteryController.addListener(_listener!);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 动画监听</span></span><br><span class="line">    _startAnimateController?.addListener(() &#123;</span><br><span class="line">      <span class="comment">// 更新选中的下标</span></span><br><span class="line">      _currentSelect = _selectMap[_selectedIndexTween?.value % <span class="number">8</span>];</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (_startAnimateController!.isCompleted) &#123;</span><br><span class="line">        widget.simpleLotteryController.finish();</span><br><span class="line">        _currentSelect = <span class="number">-1</span>;</span><br><span class="line">        <span class="built_in">dynamic</span> dishes = widget.dishesList[_target];</span><br><span class="line"></span><br><span class="line">        Provider.of&lt;IndexViewModel&gt;(context, listen: <span class="keyword">false</span>).setIsLotte(<span class="keyword">true</span>);</span><br><span class="line">        Provider.of&lt;IndexViewModel&gt;(context, listen: <span class="keyword">false</span>)</span><br><span class="line">            .setCurrentDishes(dishes);</span><br><span class="line">        DialogUtils.showMessage(<span class="string">&#x27;恭喜你，今天做：<span class="subst">$&#123;dishes[<span class="string">&#x27;dishesName&#x27;</span>]&#125;</span>，点击按钮查看菜品做法！&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      setState(() &#123;&#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> deactivate() &#123;</span><br><span class="line">    widget.simpleLotteryController.removeListener(_listener!);</span><br><span class="line">    <span class="keyword">super</span>.deactivate();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    _startAnimateController?.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取当前奖品出现的次数</span></span><br><span class="line">getNumberTimesCurrentPrizeAppears(<span class="built_in">String?</span> id, <span class="built_in">List</span>&lt;<span class="built_in">dynamic</span>&gt; arr) &#123;</span><br><span class="line">  <span class="comment">//定义集合</span></span><br><span class="line">  <span class="built_in">Map</span> obj = &#123;&#125;;</span><br><span class="line">  <span class="built_in">List</span> idList = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    idList.add(arr[i][<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; idList.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj.containsValue([idList[i]])) &#123;</span><br><span class="line">      obj[idList[i]]++;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      obj[idList[i]] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> obj[<span class="built_in">int</span>.parse(id!)];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> next(<span class="built_in">int</span> min, <span class="built_in">int</span> max) &#123;</span><br><span class="line">  <span class="built_in">int</span> res = min + Random().nextInt(max - min + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="dishesdetaildart"><a class="markdownIt-Anchor" href="#dishesdetaildart">#</a> DishesDetail.dart</h4>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:bruno/bruno.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter_screenutil/flutter_screenutil.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter_swiper_plus/flutter_swiper_plus.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:weat/common/common.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DishesDetailView</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  DishesDetailView(&#123;Key? key,<span class="keyword">required</span> <span class="keyword">this</span>.dishes&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line">  <span class="keyword">var</span> dishes;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  State&lt;DishesDetailView&gt; createState() =&gt; _DishesDetailViewState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_DishesDetailViewState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">DishesDetailView</span>&gt; </span>&#123;</span><br><span class="line">  <span class="built_in">List</span> steplist = [];</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    <span class="comment">//分割步骤</span></span><br><span class="line">    steplist = widget.dishes[<span class="string">&#x27;dishesStep&#x27;</span>].toString().split(<span class="string">&#x27;\r\n&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> WillPopScope(</span><br><span class="line">      onWillPop: () &#123;</span><br><span class="line">        BrnDialogManager.showConfirmDialog(context,</span><br><span class="line">            showIcon: <span class="keyword">false</span>,</span><br><span class="line">            barrierDismissible: <span class="keyword">false</span>,</span><br><span class="line">            title: <span class="string">&quot;你正在做菜，要退出吗~&quot;</span>,</span><br><span class="line">            confirm: <span class="string">&quot;退出&quot;</span>,</span><br><span class="line">            cancel: <span class="string">&quot;不&quot;</span>, onConfirm: () &#123;</span><br><span class="line">          Navigator.of(context).pop();</span><br><span class="line">          Navigator.of(context).pop();</span><br><span class="line">        &#125;, onCancel: () &#123;</span><br><span class="line">          Navigator.of(context).pop();</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> Future.value(<span class="keyword">false</span>);</span><br><span class="line">      &#125;,</span><br><span class="line">      child: Scaffold(</span><br><span class="line">          appBar: getAppBar(widget.dishes[<span class="string">&#x27;dishesName&#x27;</span>], context: context),</span><br><span class="line">          body: ListView(</span><br><span class="line">            children: [</span><br><span class="line">              Padding(</span><br><span class="line">                padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">8.0</span>),</span><br><span class="line">                child: ImageFulWidget(imageList: [widget.dishes[<span class="string">&#x27;dishesUrl&#x27;</span>]]),</span><br><span class="line">              ),</span><br><span class="line">              getCardContainer(</span><br><span class="line">                margin: EdgeInsets.only(</span><br><span class="line">                    top: <span class="number">10.</span>h, bottom: <span class="number">10.</span>h, left: <span class="number">10.</span>w, right: <span class="number">10.</span>w),</span><br><span class="line">                height: <span class="number">220.0</span>.h,</span><br><span class="line">                isBorder: <span class="keyword">true</span>,</span><br><span class="line">                BorderCircular: <span class="number">5.</span>r,</span><br><span class="line">                width: <span class="built_in">double</span>.infinity,</span><br><span class="line">                widget: Column(</span><br><span class="line">                  crossAxisAlignment: CrossAxisAlignment.start,</span><br><span class="line">                  children: [</span><br><span class="line">                    Padding(</span><br><span class="line">                      padding: EdgeInsets.only(left: <span class="number">10.</span>w, top: <span class="number">10.</span>h),</span><br><span class="line">                      child: BrnCSS2Text.toTextView(</span><br><span class="line">                        <span class="string">&#x27;步骤：&#x27;</span>,</span><br><span class="line">                        maxLines: <span class="number">1</span>,</span><br><span class="line">                        textOverflow: TextOverflow.ellipsis,</span><br><span class="line">                        defaultStyle:</span><br><span class="line">                            TextStyle(fontSize: <span class="number">20.</span>sp, fontFamily: <span class="string">&#x27;jinbu&#x27;</span>),</span><br><span class="line">                      ),</span><br><span class="line">                    ),</span><br><span class="line">                    Padding(</span><br><span class="line">                      padding: EdgeInsets.only(left: <span class="number">10.</span>w, top: <span class="number">10.</span>h),</span><br><span class="line">                      child: Column(</span><br><span class="line">                        crossAxisAlignment: CrossAxisAlignment.start,</span><br><span class="line">                        children: steplist.map((e) &#123;</span><br><span class="line">                          <span class="keyword">return</span> Container(</span><br><span class="line">                            margin: EdgeInsets.only(top: <span class="number">5.</span>h),</span><br><span class="line">                            child: BrnCSS2Text.toTextView(</span><br><span class="line">                              <span class="string">&#x27;<span class="subst">$e</span>&#x27;</span>,</span><br><span class="line">                              maxLines: <span class="number">1</span>,</span><br><span class="line">                              textOverflow: TextOverflow.ellipsis,</span><br><span class="line">                              defaultStyle: TextStyle(</span><br><span class="line">                                  fontSize: <span class="number">13.</span>sp, fontFamily: <span class="string">&#x27;jinbu&#x27;</span>),</span><br><span class="line">                            ),</span><br><span class="line">                          );</span><br><span class="line">                        &#125;).toList(),</span><br><span class="line">                      ),</span><br><span class="line">                    ),</span><br><span class="line">                  ],</span><br><span class="line">                ),</span><br><span class="line">              )</span><br><span class="line">            ],</span><br><span class="line">          )),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 顶部轮播图Widget</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ImageFulWidget</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  ImageFulWidget(&#123;</span><br><span class="line">    Key? key,</span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">this</span>.imageList,</span><br><span class="line">  &#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt;? imageList;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> ClipRRect(</span><br><span class="line">      borderRadius: BorderRadius.vertical(</span><br><span class="line">          top: Radius.circular(<span class="number">20.</span>h), bottom: Radius.circular(<span class="number">20.</span>h)),</span><br><span class="line">      child: SizedBox(</span><br><span class="line">        height: MediaQuery.of(context).size.height * <span class="number">0.25</span>,</span><br><span class="line">        width: MediaQuery.of(context).size.width - <span class="number">60.0</span>.w,</span><br><span class="line">        child: Swiper(</span><br><span class="line">          autoplay: <span class="keyword">false</span>,</span><br><span class="line">          duration: <span class="number">2000</span>,</span><br><span class="line">          curve: Curves.linearToEaseOut,</span><br><span class="line">          itemBuilder: (BuildContext context, <span class="built_in">int</span> index) &#123;</span><br><span class="line">            <span class="keyword">return</span> Image.network(</span><br><span class="line">              imageList![index],</span><br><span class="line">              height: MediaQuery.of(context).size.height * <span class="number">0.25</span>,</span><br><span class="line">              width: MediaQuery.of(context).size.width - <span class="number">60.0</span>.w,</span><br><span class="line">              fit: BoxFit.cover,</span><br><span class="line">            );</span><br><span class="line">          &#125;,</span><br><span class="line">          itemCount: imageList!.length,</span><br><span class="line">          pagination: SwiperPagination(</span><br><span class="line">            builder: DotSwiperPaginationBuilder(</span><br><span class="line">              size: <span class="number">8.</span>sp, <span class="comment">// 设置未选中的小点大小</span></span><br><span class="line">              activeSize: <span class="number">10.</span>sp, <span class="comment">// 设置选中的小点大小</span></span><br><span class="line">              color: <span class="keyword">const</span> Color.fromARGB(<span class="number">255</span>, <span class="number">219</span>, <span class="number">219</span>, <span class="number">219</span>), <span class="comment">// 设置为未选中的小点颜色</span></span><br><span class="line">              activeColor: Colors.blue, <span class="comment">// 设置选中的小点颜色</span></span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">          control: <span class="keyword">const</span> SwiperControl(color: Colors.transparent),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="maindart"><a class="markdownIt-Anchor" href="#maindart">#</a> main.dart</h4>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;dart:async&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;dart:io&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;dart:math&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/physics.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/services.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter_easyloading/flutter_easyloading.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter_screenutil/flutter_screenutil.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:get/get_navigation/src/root/get_material_app.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:intl/date_symbol_data_local.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:provider/provider.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:weat/routers/routes.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:weat/viewmodel/index_viewmodel.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//全局路由key</span></span><br><span class="line"><span class="keyword">final</span> GlobalKey&lt;NavigatorState&gt; navigatorKey = GlobalKey&lt;NavigatorState&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 主函数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> main() <span class="keyword">async</span> &#123;</span><br><span class="line">  initializeDateFormatting().then((_) =&gt; runApp(MultiProvider(</span><br><span class="line">        providers: [</span><br><span class="line">          ChangeNotifierProvider(create: (context) =&gt; IndexViewModel()),</span><br><span class="line">        ],</span><br><span class="line">        child: MyApp(),</span><br><span class="line">      )));</span><br><span class="line"></span><br><span class="line">  <span class="comment">//安卓屏蔽顶部阴影</span></span><br><span class="line">  <span class="keyword">if</span> (Platform.isAndroid) &#123;</span><br><span class="line">    SystemUiOverlayStyle systemUiOverlayStyle =</span><br><span class="line">        SystemUiOverlayStyle(statusBarColor: Colors.transparent);</span><br><span class="line">    SystemChrome.setSystemUIOverlayStyle(systemUiOverlayStyle);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//根节点</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  State&lt;MyApp&gt; createState() =&gt; _MyAppState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MyAppState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MyApp</span>&gt; </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    _init();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//全局路由key</span></span><br><span class="line">  <span class="keyword">final</span> GlobalKey&lt;NavigatorState&gt; navigatorKey = GlobalKey&lt;NavigatorState&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="language-markdown">程序初始化</span></span></span><br><span class="line">  _init() <span class="keyword">async</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> EasyLoading.init();</span><br><span class="line">    EasyLoading.instance</span><br><span class="line">      ..displayDuration = <span class="keyword">const</span> <span class="built_in">Duration</span>(milliseconds: <span class="number">2000</span>)</span><br><span class="line">      ..indicatorType = EasyLoadingIndicatorType.fadingCircle</span><br><span class="line">      ..loadingStyle = EasyLoadingStyle.dark</span><br><span class="line">      ..indicatorSize = <span class="number">45.0</span></span><br><span class="line">      ..radius = <span class="number">10.0</span></span><br><span class="line">      ..progressColor = Colors.yellow</span><br><span class="line">      ..backgroundColor = Colors.green</span><br><span class="line">      ..indicatorColor = Colors.yellow</span><br><span class="line">      ..textColor = Colors.yellow</span><br><span class="line">      ..maskColor = Colors.blue.withOpacity(<span class="number">0.5</span>)</span><br><span class="line">      ..userInteractions = <span class="keyword">true</span></span><br><span class="line">      ..dismissOnTap = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> WidgetsFlutterBinding.ensureInitialized();</span><br><span class="line">    <span class="keyword">await</span> SystemChrome.setPreferredOrientations(</span><br><span class="line">      [</span><br><span class="line">        <span class="comment">// 竖屏 Portrait 模式</span></span><br><span class="line">        DeviceOrientation.portraitUp,</span><br><span class="line">        DeviceOrientation.portraitDown,</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> ScreenUtilInit(</span><br><span class="line">        designSize: Size(<span class="number">375</span>, <span class="number">667</span>),</span><br><span class="line">        minTextAdapt: <span class="keyword">true</span>,</span><br><span class="line">        splitScreenMode: <span class="keyword">true</span>,</span><br><span class="line">        builder: (context, child) &#123;</span><br><span class="line">          <span class="keyword">return</span> GetMaterialApp(</span><br><span class="line">            theme: ThemeData(</span><br><span class="line">              primarySwatch: Colors.blueGrey, <span class="comment">//全局主题颜色</span></span><br><span class="line">              splashColor: Colors.transparent, <span class="comment">// 点击时的高亮效果设置为透明</span></span><br><span class="line">              <span class="comment">// backgroundColor: Color.fromARGB(255, 255, 255, 255), //系统背景主题颜色</span></span><br><span class="line">              backgroundColor: Color(<span class="number">0xFFF3F4F6</span>), <span class="comment">//系统背景主题颜色</span></span><br><span class="line">              highlightColor: Colors.transparent, <span class="comment">// 长按时的扩散效果设置为透明</span></span><br><span class="line">              primaryColor: Color.fromARGB(<span class="number">188</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">97</span>), <span class="comment">//系统原色</span></span><br><span class="line">              focusColor: Color.fromARGB(<span class="number">235</span>, <span class="number">73</span>, <span class="number">74</span>, <span class="number">116</span>), <span class="comment">//焦点主题颜色</span></span><br><span class="line">              hoverColor: Color.fromARGB(<span class="number">235</span>, <span class="number">103</span>, <span class="number">104</span>, <span class="number">172</span>), <span class="comment">//悬停主题颜色</span></span><br><span class="line">              disabledColor: Color.fromARGB(<span class="number">235</span>, <span class="number">105</span>, <span class="number">106</span>, <span class="number">133</span>), <span class="comment">//禁用主题颜色</span></span><br><span class="line">              primaryColorLight: Colors.white, <span class="comment">// 白色主题颜色</span></span><br><span class="line">              primaryColorDark: Color.fromARGB(<span class="number">235</span>, <span class="number">73</span>, <span class="number">74</span>, <span class="number">116</span>), <span class="comment">//黑色主题颜色</span></span><br><span class="line">              selectedRowColor: Color.fromARGB(<span class="number">255</span>, <span class="number">104</span>, <span class="number">80</span>, <span class="number">145</span>), <span class="comment">//选中效果颜色</span></span><br><span class="line">              appBarTheme: AppBarTheme(backgroundColor: Colors.white),</span><br><span class="line">              buttonTheme: ButtonThemeData(</span><br><span class="line">                focusColor: Color.fromARGB(<span class="number">235</span>, <span class="number">73</span>, <span class="number">74</span>, <span class="number">116</span>),</span><br><span class="line">                hoverColor: Color.fromARGB(<span class="number">235</span>, <span class="number">103</span>, <span class="number">104</span>, <span class="number">172</span>),</span><br><span class="line">              ),</span><br><span class="line">              tabBarTheme: TabBarTheme(</span><br><span class="line">                labelColor: Color.fromARGB(<span class="number">235</span>, <span class="number">103</span>, <span class="number">104</span>, <span class="number">172</span>),</span><br><span class="line">              ),</span><br><span class="line">              progressIndicatorTheme: ProgressIndicatorThemeData(</span><br><span class="line">                color: Color.fromARGB(<span class="number">235</span>, <span class="number">101</span>, <span class="number">102</span>, <span class="number">158</span>),</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">            navigatorKey: navigatorKey,</span><br><span class="line">            routes: routes,</span><br><span class="line">            debugShowCheckedModeBanner: <span class="keyword">false</span>,</span><br><span class="line">            initialRoute: <span class="string">&quot;/&quot;</span>, <span class="comment">//初始化进入加载页面</span></span><br><span class="line">            builder: (context, widget) &#123;</span><br><span class="line">              <span class="keyword">return</span> MediaQuery(</span><br><span class="line">                data: MediaQuery.of(context).copyWith(textScaleFactor: <span class="number">1.0</span>),</span><br><span class="line">                child: widget!,</span><br><span class="line">              );</span><br><span class="line">            &#125;,</span><br><span class="line">          );</span><br><span class="line">        &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="代码编写完毕后-flutter-build-apk-打包到真机运行"><a class="markdownIt-Anchor" href="#代码编写完毕后-flutter-build-apk-打包到真机运行">#</a> 代码编写完毕后 flutter build apk 打包到真机运行</h3>
<h1 id="最终呈现出我们想要的效果"><a class="markdownIt-Anchor" href="#最终呈现出我们想要的效果">#</a> 最终呈现出我们想要的效果：</h1>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230224132323576.png" alt="image-20230224132323576"></p>
<p>抽奖中：</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230224132344126.png" alt="image-20230224132344126"></p>
<p>中奖：</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230224132344126.png" alt=""></p>
<p>详情：</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230224132350748.png" alt="image-20230224132350748"></p>
<h3 id="本期教程到此结束欢迎你的观看~"><a class="markdownIt-Anchor" href="#本期教程到此结束欢迎你的观看~">#</a> 本期教程到此结束，欢迎你的观看～</h3>
<h2 id="微信公众号搜索interviewcoder回复关键词吃啥获取源码以及开发教程~-2"><a class="markdownIt-Anchor" href="#微信公众号搜索interviewcoder回复关键词吃啥获取源码以及开发教程~-2">#</a> 微信公众号搜索 InterviewCoder 回复关键词《吃啥》获取源码以及开发教程～</h2>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/%E4%BA%8C%E7%BB%B4%E7%A0%81mini.png" alt="二维码mini"></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-02-23T05:03:35.956Z" title="2023-2-23 13:03:35">2023-02-23</time>发表</span><span class="level-item"><time dateTime="2023-02-23T05:26:04.734Z" title="2023-2-23 13:26:04">2023-02-23</time>更新</span><span class="level-item">13 分钟读完 (大约1882个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/02/23/%E3%80%90Java&amp;%E5%85%AC%E4%BC%97%E5%8F%B7%E3%80%91Java%E5%BC%80%E5%8F%91%E5%85%AC%E4%BC%97%E5%8F%B7%E8%87%AA%E5%8A%A8%E5%9B%9E%E5%A4%8D%E5%8A%9F%E8%83%BD/">Java开发公众号自动回复功能</a></p><div class="content"><h5 id="本文最先发表于我的个人博客-csdn为同步发布如有需要请访问-brath的个人博客-获取更多内容"><a class="markdownIt-Anchor" href="#本文最先发表于我的个人博客-csdn为同步发布如有需要请访问-brath的个人博客-获取更多内容">#</a> 本文最先发表于我的个人博客 ，CSDN 为同步发布，如有需要，请访问 <a target="_blank" rel="noopener" href="https://brath.top/">Brath 的个人博客</a> 获取更多内容</h5>
<h2 id="背景"><a class="markdownIt-Anchor" href="#背景">#</a> 背景</h2>
<p>最近准备搭建自己的<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%8D%9A%E5%AE%A2%E7%B3%BB%E7%BB%9F&amp;spm=1001.2101.3001.7020">博客系统</a>，有些软件或资料的下载链接放在网盘中，为了方便下载，同时可以将用户导流到公众号上，因此准备用 Java 实现微信公众号业务支持公众号自动回复的功能</p>
<h2 id="准备工作"><a class="markdownIt-Anchor" href="#准备工作">#</a> 准备工作</h2>
<ul>
<li>微信公众号业务支持公众号</li>
</ul>
<p>首先当然是需要注册一个<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E4%B8%9A%E5%8A%A1%E6%94%AF%E6%8C%81%E5%85%AC%E4%BC%97%E5%8F%B7&amp;spm=1001.2101.3001.7020">微信公众号业务支持公众号</a>，具体步骤就不在这里赘述了，注册地址：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/">微信公众号业务支持公众平台</a></p>
<p>注册完毕后需要完成认证操作</p>
<h2 id="代码"><a class="markdownIt-Anchor" href="#代码">#</a> 代码</h2>
<p>依赖引入，<strong>主要为 xml 相关依赖</strong>， 因为微信公众号业务支持公众号采用的 xml 消息格式进行交互</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>dom4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dom4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.thoughtworks.xstream<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xstream<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.19<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">12345678910</span><br></pre></td></tr></table></figure>
<p>自动回复内容一共需要两个接口（两个接口路由完全一致，一个为 GET 请求，一个为 POST 请求）</p>
<ul>
<li>微信公众号业务支持公众号认证接口</li>
</ul>
<blockquote>
<p>此接口用于微信公众号业务支持公众号后台服务器认证使用，GET 请求</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 微信公众号业务支持校验</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> signature</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> timestamp</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> nonce</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> echostr</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;callback&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">callback</span><span class="params">(String signature, String timestamp, String nonce, String echostr, HttpServletResponse response)</span> &#123;</span><br><span class="line">    <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    log.info(<span class="string">&quot;微信公众号业务支持校验消息，signature:&#123;&#125;，timestamp:&#123;&#125;，nonce:&#123;&#125;，echostr:&#123;&#125;&quot;</span>, signature, timestamp, nonce, echostr);</span><br><span class="line">    List&lt;WechatConfigPO&gt; configPOList = wechatConfigDao.selectAll();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        out = response.getWriter();</span><br><span class="line">        out.write(echostr);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;微信公众号业务支持校验失败&quot;</span>, e);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (out != <span class="literal">null</span>) &#123;</span><br><span class="line">            out.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>消息接收接口</li>
</ul>
<blockquote>
<p>此接口用于接收公众号消息回调，POST 请求</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 微信公众号业务支持消息回调</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;callback&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">callback</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> &#123;</span><br><span class="line">    <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">respMessage</span> <span class="operator">=</span> wechatService.callback(request);</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isBlank(respMessage)) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;不回复消息&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        response.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        out = response.getWriter();</span><br><span class="line">        out.write(respMessage);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;微信公众号业务支持发送消息失败&quot;</span>, e);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (out != <span class="literal">null</span>) &#123;</span><br><span class="line">            out.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>消息回复 service</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Brath</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/2/23</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@desc</span> 微信公众号业务支持</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WechatService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TextReplyService textReplyService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 微信公众号业务支持回复</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> UnsupportedEncodingException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">callback</span><span class="params">(HttpServletRequest request)</span> <span class="keyword">throws</span> UnsupportedEncodingException &#123;</span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Map&lt;String, String&gt; requestMap = WechatMessageUtils.parseXml(request);</span><br><span class="line">            log.info(<span class="string">&quot;微信公众号业务支持接收到消息:&#123;&#125;&quot;</span>, GsonUtils.toJson(requestMap));</span><br><span class="line">            <span class="comment">// 消息类型</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">msgType</span> <span class="operator">=</span> requestMap.get(<span class="string">&quot;MsgType&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 处理其他消息，暂时不做回复</span></span><br><span class="line">            <span class="keyword">switch</span> (msgType) &#123;</span><br><span class="line">                <span class="keyword">case</span> WechatMsgTypeConstant.MESSAGE_TYPE_TEXT:</span><br><span class="line">                    <span class="comment">// 文本消息处理</span></span><br><span class="line">                    <span class="keyword">return</span> textReplyService.reply(requestMap);</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="keyword">return</span> textReplyService.reply(requestMap);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;回复消息错误&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 不做回复</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>文本回复 service</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Brath</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/5/18 9:57</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@desc</span> 文本回复</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TextReplyService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FROM_USER_NAME</span> <span class="operator">=</span> <span class="string">&quot;FromUserName&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TO_USER_NAME</span> <span class="operator">=</span> <span class="string">&quot;ToUserName&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CONTENT</span> <span class="operator">=</span> <span class="string">&quot;Content&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> WechatKeywordDao wechatKeywordDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> WechatMsgRecordDao wechatMsgRecordDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 自动回复文本内容</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> requestMap</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">reply</span><span class="params">(Map&lt;String, String&gt; requestMap)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">wechatId</span> <span class="operator">=</span> requestMap.get(FROM_USER_NAME);</span><br><span class="line">        <span class="type">String</span> <span class="variable">gongzhonghaoId</span> <span class="operator">=</span> requestMap.get(TO_USER_NAME);</span><br><span class="line"></span><br><span class="line">        <span class="type">TextMessage</span> <span class="variable">textMessage</span> <span class="operator">=</span> WechatMessageUtils.getDefaultTextMessage(wechatId, gongzhonghaoId);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> requestMap.get(CONTENT);</span><br><span class="line">        <span class="keyword">if</span> (content == <span class="literal">null</span>) &#123;</span><br><span class="line">            textMessage.setContent(WechatConstants.DEFAULT_MSG);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Example</span> <span class="variable">example</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Example</span>(WechatKeywordPO.class);</span><br><span class="line">            example.createCriteria().andEqualTo(<span class="string">&quot;wechatId&quot;</span>, gongzhonghaoId).andEqualTo(<span class="string">&quot;keyword&quot;</span>, content);</span><br><span class="line">            List&lt;WechatKeywordPO&gt; keywordPOList = wechatKeywordDao.selectByExample(example);</span><br><span class="line">            <span class="keyword">if</span> (CollectionUtils.isEmpty(keywordPOList)) &#123;</span><br><span class="line">                textMessage.setContent(WechatConstants.DEFAULT_MSG);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                textMessage.setContent(keywordPOList.get(<span class="number">0</span>).getReplyContent());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 记录消息记录</span></span><br><span class="line">        wechatMsgRecordDao.insertSelective(WechatMsgRecordPO.builder()</span><br><span class="line">                .fromUser(wechatId)</span><br><span class="line">                .wechatId(gongzhonghaoId)</span><br><span class="line">                .content(content)</span><br><span class="line">                .replyContent(textMessage.getContent())</span><br><span class="line">                .build()</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> WechatMessageUtils.textMessageToXml(textMessage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>文本消息 model</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Brath</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/11/26 22:21</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 文本消息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TextMessage</span> <span class="keyword">extends</span> <span class="title class_">BaseMessage</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 回复的消息内容</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String Content;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">1234567891011121314</span></span><br></pre></td></tr></table></figure>
<p><strong>基础消息 model</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Brath</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/11/26 22:20</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 基础消息响应</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BaseMessage</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 接收方帐号（收到的OpenID）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String ToUserName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 开发者微信公众号业务支持号</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String FromUserName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 消息创建时间 （整型）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> CreateTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 消息类型</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String MsgType;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 位0x0001被标志时，星标刚收到的消息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> FuncFlag;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>消息工具</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Brath</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/5/18 7:55</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@desc</span> 微信公众号业务支持消息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WechatMessageUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 解析微信公众号业务支持发来的请求（XML）</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, String&gt; <span class="title function_">parseXml</span><span class="params">(HttpServletRequest request)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// 将解析结果存储在HashMap中</span></span><br><span class="line">        Map&lt;String, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 从request中取得输入流</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> request.getInputStream();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 读取输入流</span></span><br><span class="line">            <span class="type">SAXReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SAXReader</span>();</span><br><span class="line">            <span class="type">Document</span> <span class="variable">document</span> <span class="operator">=</span> reader.read(inputStream);</span><br><span class="line">            <span class="comment">// 得到xml根元素</span></span><br><span class="line">            <span class="type">Element</span> <span class="variable">root</span> <span class="operator">=</span> document.getRootElement();</span><br><span class="line">            <span class="comment">// 得到根元素的所有子节点</span></span><br><span class="line"></span><br><span class="line">            List&lt;Element&gt; elementList = root.elements();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 遍历所有子节点</span></span><br><span class="line">            <span class="keyword">for</span> (Element e : elementList) &#123;</span><br><span class="line">                map.put(e.getName(), e.getText());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// 释放资源</span></span><br><span class="line">            <span class="keyword">if</span> (inputStream != <span class="literal">null</span>) &#123;</span><br><span class="line">                inputStream.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 文本消息对象转换成xml</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> textMessage 文本消息对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> xml</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">textMessageToXml</span><span class="params">(TextMessage textMessage)</span> &#123;</span><br><span class="line">        XSTREAM.alias(<span class="string">&quot;xml&quot;</span>, textMessage.getClass());</span><br><span class="line">        <span class="keyword">return</span> XSTREAM.toXML(textMessage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 音乐消息对象转换成xml</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> musicMessage 音乐消息对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> xml</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">musicMessageToXml</span><span class="params">(MusicMessage musicMessage)</span> &#123;</span><br><span class="line">        XSTREAM.alias(<span class="string">&quot;xml&quot;</span>, musicMessage.getClass());</span><br><span class="line">        <span class="keyword">return</span> XSTREAM.toXML(musicMessage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 图文消息对象转换成xml</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> newsMessage 图文消息对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> xml</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">newsMessageToXml</span><span class="params">(NewsMessage newsMessage)</span> &#123;</span><br><span class="line">        XSTREAM.alias(<span class="string">&quot;xml&quot;</span>, newsMessage.getClass());</span><br><span class="line">        XSTREAM.alias(<span class="string">&quot;item&quot;</span>, Article.class);</span><br><span class="line">        <span class="keyword">return</span> XSTREAM.toXML(newsMessage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 扩展xstream，使其支持CDATA块</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">XStream</span> <span class="variable">XSTREAM</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XStream</span>(<span class="keyword">new</span> <span class="title class_">XppDriver</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> HierarchicalStreamWriter <span class="title function_">createWriter</span><span class="params">(Writer out)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">PrettyPrintWriter</span>(out) &#123;</span><br><span class="line">                <span class="comment">// 对所有xml节点的转换都增加CDATA标记</span></span><br><span class="line">                <span class="keyword">final</span> <span class="type">boolean</span> <span class="variable">cdata</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">writeText</span><span class="params">(QuickWriter writer, String text)</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (cdata) &#123;</span><br><span class="line">                        writer.write(<span class="string">&quot;&lt;![CDATA[&quot;</span>);</span><br><span class="line">                        writer.write(text);</span><br><span class="line">                        writer.write(<span class="string">&quot;]]&gt;&quot;</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        writer.write(text);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取默认文本消息</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> receiver     接收人</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> officialWxid 官方微信公众号业务支持id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 文本消息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> TextMessage <span class="title function_">getDefaultTextMessage</span><span class="params">(String receiver, String officialWxid)</span> &#123;</span><br><span class="line">        <span class="type">TextMessage</span> <span class="variable">textMessage</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TextMessage</span>();</span><br><span class="line">        textMessage.setToUserName(receiver);</span><br><span class="line">        textMessage.setFromUserName(officialWxid);</span><br><span class="line">        textMessage.setCreateTime(System.currentTimeMillis());</span><br><span class="line">        textMessage.setMsgType(WechatMsgTypeConstant.MESSAGE_TYPE_TEXT);</span><br><span class="line">        textMessage.setFuncFlag(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> textMessage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>消息类型枚举</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Brath</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/5/18 8:00</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@desc</span> 微信公众号业务支持消息类型</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WechatMsgTypeConstant</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 文本消息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">MESSAGE_TYPE_TEXT</span> <span class="operator">=</span> <span class="string">&quot;text&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>其他内容为一些数据库相关操作，此处不再列出，仅为：<strong>查询关键词及其回复内容</strong>，<strong>存储消息记录</strong></p>
</blockquote>
<h2 id="公众号配置"><a class="markdownIt-Anchor" href="#公众号配置">#</a> 公众号配置</h2>
<ul>
<li>服务器配置</li>
</ul>
<p>公众号后台 -&gt; 设置与开发 -&gt; 基本配置 -&gt; 服务器配置</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230223130939844.png" alt="image-20230223130939844"></p>
<ul>
<li>填写服务器地址</li>
</ul>
<p>填写你的服务器回调接口地址 (<strong>需要为公网地址，否则微信公众号业务支持无法调通</strong>)</p>
<ul>
<li>生成或者自定义你的令牌 Token，后台需要配置这个 Token，一定要记住</li>
</ul>
<blockquote>
<p>Token 需要记住，<strong>一般在微信公众号业务支持验证接口处会校验相关信息是否是自己的公众号</strong></p>
</blockquote>
<p><strong>验证方法</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Brath</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/11/26 21:59</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 微信公众号业务支持工具</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WechatUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">char</span>[] HEX_DIGITS = &#123;<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">checkSignature</span><span class="params">(String signature, String timestamp, String nonce, String token)</span> &#123;</span><br><span class="line">        String[] str = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;token, timestamp, nonce&#125;;</span><br><span class="line">        <span class="comment">//排序</span></span><br><span class="line">        Arrays.sort(str);</span><br><span class="line">        <span class="comment">//拼接字符串</span></span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; str.length; i++) &#123;</span><br><span class="line">            buffer.append(str[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//进</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">temp</span> <span class="operator">=</span> encode(buffer.toString());</span><br><span class="line">        <span class="comment">//与微信公众号业务支持提供的signature进行匹对</span></span><br><span class="line">        <span class="keyword">return</span> signature.equals(temp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">getFormattedText</span><span class="params">(<span class="type">byte</span>[] bytes)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> bytes.length;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">buf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(len * <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; len; j++) &#123;</span><br><span class="line">            buf.append(HEX_DIGITS[(bytes[j] &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0x0f</span>]);</span><br><span class="line">            buf.append(HEX_DIGITS[bytes[j] &amp; <span class="number">0x0f</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> buf.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">encode</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (str == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">MessageDigest</span> <span class="variable">messageDigest</span> <span class="operator">=</span> MessageDigest.getInstance(<span class="string">&quot;SHA1&quot;</span>);</span><br><span class="line">            messageDigest.update(str.getBytes());</span><br><span class="line">            <span class="keyword">return</span> getFormattedText(messageDigest.digest());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950</span></span><br></pre></td></tr></table></figure>
<ul>
<li>验证公众号自动回复是否正确</li>
</ul>
<blockquote>
<p>可以搜索公众号 InterviewCoder) 或扫码关注公众号回复关键词《chatGPT》查看效果</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/%E4%BA%8C%E7%BB%B4%E7%A0%81mini.png" alt="二维码mini"></p>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-02-23T00:43:39.084Z" title="2023-2-23 8:43:39">2023-02-23</time>发表</span><span class="level-item"><time dateTime="2023-02-23T05:26:14.806Z" title="2023-2-23 13:26:14">2023-02-23</time>更新</span><span class="level-item">26 分钟读完 (大约3833个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/02/23/%E3%80%90IDE%E3%80%91Jet%E5%85%A8%E5%AE%B6%E6%A1%B6%E6%BF%80%E6%B4%BB%E6%95%99%E7%A8%8B/">JetBrains全系列激活码</a></p><div class="content"><h1 id="jetbrains全系列激活码"><a class="markdownIt-Anchor" href="#jetbrains全系列激活码">#</a> <strong>JetBrains 全系列激活码</strong></h1>
<p>注：不同的软件，需要不同的激活码，千万别复制错了</p>
<h2 id="本文讲的是支持202222最新版本的rubymine破解-rubymine激活码-rubymine安装-rubymine永久激活码的最新永久激活教程本文有mac和windows系统的rubymine安装教程"><a class="markdownIt-Anchor" href="#本文讲的是支持202222最新版本的rubymine破解-rubymine激活码-rubymine安装-rubymine永久激活码的最新永久激活教程本文有mac和windows系统的rubymine安装教程">#</a> 本文讲的是支持 2022.2.2 最新版本的 RubyMine 破解、RubyMine 激活码、RubyMine 安装、RubyMine 永久激活码的最新永久激活教程，本文有 mac 和 windows 系统的 RubyMine 安装教程。</h2>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/131-21010G6105IL.png" alt="131-21010G6105IL"></p>
<h3 id="1下载你需要的ide工具"><a class="markdownIt-Anchor" href="#1下载你需要的ide工具">#</a> 1. 下载你需要的 IDE 工具</h3>
<h3 id="2下载破解工具-微信公众号搜索interviewcoder或扫码关注公众号回复关键词破解即可获取"><a class="markdownIt-Anchor" href="#2下载破解工具-微信公众号搜索interviewcoder或扫码关注公众号回复关键词破解即可获取">#</a> 2. 下载破解工具 (微信公众号搜索 InterviewCoder) 或扫码关注公众号回复关键词《破解》即可获取</h3>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/%E4%BA%8C%E7%BB%B4%E7%A0%81mini.png" alt="二维码mini"></p>
<h3 id="3下载好后解压并打开选择scripts"><a class="markdownIt-Anchor" href="#3下载好后解压并打开选择scripts">#</a> 3. 下载好后解压并打开，选择 scripts</h3>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/sp20220926_173051_163.png" alt="图片[5]-RubyMine破解安装激活教程2022-09-26最新（亲测可用）-不靠谱程序员"></p>
<h3 id="4先执行unistall-current-uservbs直接双击打开此步骤是为了防止之前有过激活信息确保当前环境变量下没有激活工具的变量信息可先执行卸载脚本在再进行后面的激活操作避免激活失败"><a class="markdownIt-Anchor" href="#4先执行unistall-current-uservbs直接双击打开此步骤是为了防止之前有过激活信息确保当前环境变量下没有激活工具的变量信息可先执行卸载脚本在再进行后面的激活操作避免激活失败">#</a> 4. 先执行 unistall-current-user.vbs, 直接双击打开，此步骤是为了防止之前有过激活信息，确保当前环境变量下没有激活工具的变量信息，可先执行卸载脚本在再进行后面的激活操作，避免激活失败。</h3>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/sp20220926_173124_742-1024x464.png" alt="图片[8]-RubyMine破解安装激活教程2022-09-26最新（亲测可用）-不靠谱程序员"></p>
<ul>
<li>出现弹框 done 说明成功</li>
<li><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/sp20220926_173141_329.png" alt="图片[9]-RubyMine破解安装激活教程2022-09-26最新（亲测可用）-不靠谱程序员"></li>
<li>然后再执行 install-current-user.vbs, 直接双击打开即可</li>
<li><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/sp20220926_173154_884-1024x512.png" alt="图片[10]-RubyMine破解安装激活教程2022-09-26最新（亲测可用）-不靠谱程序员"></li>
<li>这里需要等待 10 秒左右才会出现第二个 done 弹框，才是成功</li>
<li><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/sp20220926_173214_384-300x267.png" alt="图片[11]-RubyMine破解安装激活教程2022-09-26最新（亲测可用）-不靠谱程序员"></li>
</ul>
<h3 id="5然后再输入对应的激活码即可"><a class="markdownIt-Anchor" href="#5然后再输入对应的激活码即可">#</a> 5. 然后再输入对应的激活码即可！！！！</h3>
<h2 id="idea专用"><a class="markdownIt-Anchor" href="#idea专用">#</a> <strong>IDEA 专用</strong></h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XIZQAN09CR-eyJsaWNlbnNlSWQiOiJYSVpRQU4wOUNSIiwibGljZW5zZWVOYW1lIjoia2lkZHkgaW5zZWFtcyIsImFzc2lnbmVlTmFtZSI6IiIsImFzc2lnbmVlRW1haWwiOiIiLCJsaWNlbnNlUmVzdHJpY3Rpb24iOiIiLCJjaGVja0NvbmN1cnJlbnRVc2UiOmZhbHNlLCJwcm9kdWN0cyI6W3siY29kZSI6IlBEQiIsImZhbGxiYWNrRGF0ZSI6IjIwMjUtMDgtMDEiLCJwYWlkVXBUbyI6IjIwMjUtMDgtMDEiLCJleHRlbmRlZCI6dHJ1ZX0seyJjb2RlIjoiUFNJIiwiZmFsbGJhY2tEYXRlIjoiMjAyNS0wOC0wMSIsInBhaWRVcFRvIjoiMjAyNS0wOC0wMSIsImV4dGVuZGVkIjp0cnVlfSx7ImNvZGUiOiJQUEMiLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOnRydWV9LHsiY29kZSI6IlBDV01QIiwiZmFsbGJhY2tEYXRlIjoiMjAyNS0wOC0wMSIsInBhaWRVcFRvIjoiMjAyNS0wOC0wMSIsImV4dGVuZGVkIjp0cnVlfSx7ImNvZGUiOiJQUkIiLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOnRydWV9LHsiY29kZSI6IlBQUyIsImZhbGxiYWNrRGF0ZSI6IjIwMjUtMDgtMDEiLCJwYWlkVXBUbyI6IjIwMjUtMDgtMDEiLCJleHRlbmRlZCI6dHJ1ZX0seyJjb2RlIjoiSUkiLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOmZhbHNlfSx7ImNvZGUiOiJQR08iLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOnRydWV9LHsiY29kZSI6IlBTVyIsImZhbGxiYWNrRGF0ZSI6IjIwMjUtMDgtMDEiLCJwYWlkVXBUbyI6IjIwMjUtMDgtMDEiLCJleHRlbmRlZCI6dHJ1ZX0seyJjb2RlIjoiUFdTIiwiZmFsbGJhY2tEYXRlIjoiMjAyNS0wOC0wMSIsInBhaWRVcFRvIjoiMjAyNS0wOC0wMSIsImV4dGVuZGVkIjp0cnVlfV0sIm1ldGFkYXRhIjoiMDEyMDIyMDgwMVBTQU4wMDAwMDUiLCJoYXNoIjoiVFJJQUw6LTEwMzUwMzQyMiIsImdyYWNlUGVyaW9kRGF5cyI6NywiYXV0b1Byb2xvbmdhdGVkIjpmYWxzZSwiaXNBdXRvUHJvbG9uZ2F0ZWQiOmZhbHNlfQ==-CoFOL4hCLVDFAdlOcxtyff4LA+HU4DIoRo+QTdjWbEuevzCGrh4ghKPWTCWT7YdMYoaaLGQfpR7DP8I2w4AxRMBH5T/KEUeNM70uTkdzIXboS460xZGLImtcte5hiD/U6k3P6NL2BVQgQwGTMRG5utlGdj1WtF/jb+yzp7+vaJiCt8uqqqXjEohapQsROTUihqtVRVkd9peAtS1gzKc39YEMnxu7Oggjuo797zMSnSswT5b4EVjgs+GJxL8RObb1o5xnKk8z4fCSRzVXD4tcVbwMXs/OVcr9+cgUYMiRCLhlHVOQJtb8F5r3IFYKFEPCPmwVAFHfmkMxC3uVmAcVsg==-MIIETDCCAjSgAwIBAgIBDTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTIwMTAxOTA5MDU1M1oXDTIyMTAyMTA5MDU1M1owHzEdMBsGA1UEAwwUcHJvZDJ5LWZyb20tMjAyMDEwMTkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCUlaUFc1wf+CfY9wzFWEL2euKQ5nswqb57V8QZG7d7RoR6rwYUIXseTOAFq210oMEe++LCjzKDuqwDfsyhgDNTgZBPAaC4vUU2oy+XR+Fq8nBixWIsH668HeOnRK6RRhsr0rJzRB95aZ3EAPzBuQ2qPaNGm17pAX0Rd6MPRgjp75IWwI9eA6aMEdPQEVN7uyOtM5zSsjoj79Lbu1fjShOnQZuJcsV8tqnayeFkNzv2LTOlofU/Tbx502Ro073gGjoeRzNvrynAP03pL486P3KCAyiNPhDs2z8/COMrxRlZW5mfzo0xsK0dQGNH3UoG/9RVwHG4eS8LFpMTR9oetHZBAgMBAAGjgZkwgZYwCQYDVR0TBAIwADAdBgNVHQ4EFgQUJNoRIpb1hUHAk0foMSNM9MCEAv8wSAYDVR0jBEEwP4AUo562SGdCEjZBvW3gubSgUouX8bOhHKQaMBgxFjAUBgNVBAMMDUpldFByb2ZpbGUgQ0GCCQDSbLGDsoN54TATBgNVHSUEDDAKBggrBgEFBQcDATALBgNVHQ8EBAMCBaAwDQYJKoZIhvcNAQELBQADggIBABqRoNGxAQct9dQUFK8xqhiZaYPd30TlmCmSAaGJ0eBpvkVeqA2jGYhAQRqFiAlFC63JKvWvRZO1iRuWCEfUMkdqQ9VQPXziE/BlsOIgrL6RlJfuFcEZ8TK3syIfIGQZNCxYhLLUuet2HE6LJYPQ5c0jH4kDooRpcVZ4rBxNwddpctUO2te9UU5/FjhioZQsPvd92qOTsV+8Cyl2fvNhNKD1Uu9ff5AkVIQn4JU23ozdB/R5oUlebwaTE6WZNBs+TA/qPj+5/we9NH71WRB0hqUoLI2AKKyiPw++FtN4Su1vsdDlrAzDj9ILjpjJKA1ImuVcG329/WTYIKysZ1CWK3zATg9BeCUPAV1pQy8ToXOq+RSYen6winZ2OO93eyHv2Iw5kbn1dqfBw1BuTE29V2FJKicJSu8iEOpfoafwJISXmz1wnnWL3V/0NxTulfWsXugOoLfv0ZIBP1xH9kmf22jjQ2JiHhQZP7ZDsreRrOeIQ/c4yR8IQvMLfC0WKQqrHu5ZzXTH4NO3CwGWSlTY74kE91zXB5mwWAx1jig+UXYc2w4RkVhy0//lOmVya/PEepuuTTI4+UJwC7qbVlh5zfhj8oTNUXgN0AOc+Q0/WFPl1aw5VV/VrO8FCoB15lFVlpKaQ1Yh+DVU8ke+rt9Th0BCHXe0uZOEmH0nOnH/0onD</span><br></pre></td></tr></table></figure>
<h2 id="pycharm专用"><a class="markdownIt-Anchor" href="#pycharm专用">#</a> <strong>PyCharm 专用</strong></h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WDV7B5UM4J-eyJsaWNlbnNlSWQiOiJXRFY3QjVVTTRKIiwibGljZW5zZWVOYW1lIjoia2lkZHkgaW5zZWFtcyIsImFzc2lnbmVlTmFtZSI6IiIsImFzc2lnbmVlRW1haWwiOiIiLCJsaWNlbnNlUmVzdHJpY3Rpb24iOiIiLCJjaGVja0NvbmN1cnJlbnRVc2UiOmZhbHNlLCJwcm9kdWN0cyI6W3siY29kZSI6IlBTSSIsImZhbGxiYWNrRGF0ZSI6IjIwMjUtMDgtMDEiLCJwYWlkVXBUbyI6IjIwMjUtMDgtMDEiLCJleHRlbmRlZCI6dHJ1ZX0seyJjb2RlIjoiUFBDIiwiZmFsbGJhY2tEYXRlIjoiMjAyNS0wOC0wMSIsInBhaWRVcFRvIjoiMjAyNS0wOC0wMSIsImV4dGVuZGVkIjp0cnVlfSx7ImNvZGUiOiJQQ1dNUCIsImZhbGxiYWNrRGF0ZSI6IjIwMjUtMDgtMDEiLCJwYWlkVXBUbyI6IjIwMjUtMDgtMDEiLCJleHRlbmRlZCI6dHJ1ZX0seyJjb2RlIjoiUEMiLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOmZhbHNlfSx7ImNvZGUiOiJQV1MiLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOnRydWV9XSwibWV0YWRhdGEiOiIwMTIwMjIwODAxUFNBTjAwMDAwNSIsImhhc2giOiJUUklBTDoyNjMyMTUzOTMiLCJncmFjZVBlcmlvZERheXMiOjcsImF1dG9Qcm9sb25nYXRlZCI6ZmFsc2UsImlzQXV0b1Byb2xvbmdhdGVkIjpmYWxzZX0=-S44u4zyBrYbltQAZezyCkBYsVU9HRftkKneJSWd2SsZMxgJiA1JfkhEl2yc4zrXBBqCCn2PKpaw8noyremrYtur0Iz93xp1geS6VSI4t5w5jgHR1CEUcL9Ia4BIl3CIMkxR3WXPrSGAt9jVitTmmCGGO9swTN4Hxey4iNNsEhkp8LDG949kRhN1ly00RH+p+rUP+FdVxwZ7e06rIV1c/8MGoJi4Z+7oyi+WnfIP+QIwxoNa60dzshI9Ep9d0p6bIR6eBKbNkfooWmp87mpOyN5QPupwF4q1KgS+LbFTeY/zZK6yP7tj+T2rbE3WI8MhnIviArGLs9DjZm20MwZTWvg==-MIIETDCCAjSgAwIBAgIBDTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTIwMTAxOTA5MDU1M1oXDTIyMTAyMTA5MDU1M1owHzEdMBsGA1UEAwwUcHJvZDJ5LWZyb20tMjAyMDEwMTkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCUlaUFc1wf+CfY9wzFWEL2euKQ5nswqb57V8QZG7d7RoR6rwYUIXseTOAFq210oMEe++LCjzKDuqwDfsyhgDNTgZBPAaC4vUU2oy+XR+Fq8nBixWIsH668HeOnRK6RRhsr0rJzRB95aZ3EAPzBuQ2qPaNGm17pAX0Rd6MPRgjp75IWwI9eA6aMEdPQEVN7uyOtM5zSsjoj79Lbu1fjShOnQZuJcsV8tqnayeFkNzv2LTOlofU/Tbx502Ro073gGjoeRzNvrynAP03pL486P3KCAyiNPhDs2z8/COMrxRlZW5mfzo0xsK0dQGNH3UoG/9RVwHG4eS8LFpMTR9oetHZBAgMBAAGjgZkwgZYwCQYDVR0TBAIwADAdBgNVHQ4EFgQUJNoRIpb1hUHAk0foMSNM9MCEAv8wSAYDVR0jBEEwP4AUo562SGdCEjZBvW3gubSgUouX8bOhHKQaMBgxFjAUBgNVBAMMDUpldFByb2ZpbGUgQ0GCCQDSbLGDsoN54TATBgNVHSUEDDAKBggrBgEFBQcDATALBgNVHQ8EBAMCBaAwDQYJKoZIhvcNAQELBQADggIBABqRoNGxAQct9dQUFK8xqhiZaYPd30TlmCmSAaGJ0eBpvkVeqA2jGYhAQRqFiAlFC63JKvWvRZO1iRuWCEfUMkdqQ9VQPXziE/BlsOIgrL6RlJfuFcEZ8TK3syIfIGQZNCxYhLLUuet2HE6LJYPQ5c0jH4kDooRpcVZ4rBxNwddpctUO2te9UU5/FjhioZQsPvd92qOTsV+8Cyl2fvNhNKD1Uu9ff5AkVIQn4JU23ozdB/R5oUlebwaTE6WZNBs+TA/qPj+5/we9NH71WRB0hqUoLI2AKKyiPw++FtN4Su1vsdDlrAzDj9ILjpjJKA1ImuVcG329/WTYIKysZ1CWK3zATg9BeCUPAV1pQy8ToXOq+RSYen6winZ2OO93eyHv2Iw5kbn1dqfBw1BuTE29V2FJKicJSu8iEOpfoafwJISXmz1wnnWL3V/0NxTulfWsXugOoLfv0ZIBP1xH9kmf22jjQ2JiHhQZP7ZDsreRrOeIQ/c4yR8IQvMLfC0WKQqrHu5ZzXTH4NO3CwGWSlTY74kE91zXB5mwWAx1jig+UXYc2w4RkVhy0//lOmVya/PEepuuTTI4+UJwC7qbVlh5zfhj8oTNUXgN0AOc+Q0/WFPl1aw5VV/VrO8FCoB15lFVlpKaQ1Yh+DVU8ke+rt9Th0BCHXe0uZOEmH0nOnH/0onD</span><br></pre></td></tr></table></figure>
<h2 id="webstorm专用"><a class="markdownIt-Anchor" href="#webstorm专用">#</a> <strong>Webstorm 专用</strong></h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QA01VSISIH-eyJsaWNlbnNlSWQiOiJRQTAxVlNJU0lIIiwibGljZW5zZWVOYW1lIjoia2lkZHkgaW5zZWFtcyIsImFzc2lnbmVlTmFtZSI6IiIsImFzc2lnbmVlRW1haWwiOiIiLCJsaWNlbnNlUmVzdHJpY3Rpb24iOiIiLCJjaGVja0NvbmN1cnJlbnRVc2UiOmZhbHNlLCJwcm9kdWN0cyI6W3siY29kZSI6IldTIiwiZmFsbGJhY2tEYXRlIjoiMjAyNS0wOC0wMSIsInBhaWRVcFRvIjoiMjAyNS0wOC0wMSIsImV4dGVuZGVkIjpmYWxzZX0seyJjb2RlIjoiUFNJIiwiZmFsbGJhY2tEYXRlIjoiMjAyNS0wOC0wMSIsInBhaWRVcFRvIjoiMjAyNS0wOC0wMSIsImV4dGVuZGVkIjp0cnVlfSx7ImNvZGUiOiJQQ1dNUCIsImZhbGxiYWNrRGF0ZSI6IjIwMjUtMDgtMDEiLCJwYWlkVXBUbyI6IjIwMjUtMDgtMDEiLCJleHRlbmRlZCI6dHJ1ZX0seyJjb2RlIjoiUFdTIiwiZmFsbGJhY2tEYXRlIjoiMjAyNS0wOC0wMSIsInBhaWRVcFRvIjoiMjAyNS0wOC0wMSIsImV4dGVuZGVkIjp0cnVlfV0sIm1ldGFkYXRhIjoiMDEyMDIyMDgwMVBTQU4wMDAwMDUiLCJoYXNoIjoiVFJJQUw6MTg0ODI4OTEzMCIsImdyYWNlUGVyaW9kRGF5cyI6NywiYXV0b1Byb2xvbmdhdGVkIjpmYWxzZSwiaXNBdXRvUHJvbG9uZ2F0ZWQiOmZhbHNlfQ==-PqVYTlv/yp1AaLCz/i/e//sf0n6LD6uvJTy7/jl9F2A3RJjjMvWCDeCx8tK8PZep5I+GosApeiQdzkv7aG/TfjJRiHzdF0PgJaATxwaf9hDQx7fWT2zALtrOqT89C0Qe/OsLKM9mSFm9y5ul4JW7MQSfCDMtm8B8fUQ5ZFu0nB3XcI4YnMPDjKGaifDUdY2B0u7k29CQ4JLnYxC8HL4644GG+T8F+mNkOoDDNTSE8LmcEKWXYKPzD+YEJ5flLyHc5OVtYDPF2MQ/wsbwMVf7l1O22pkr8jKdyHLzbtaeIXojlOI8fvqnXSSetFmdMa/eRC0kHHf42BZ7VQ8etd599g==-MIIETDCCAjSgAwIBAgIBDTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTIwMTAxOTA5MDU1M1oXDTIyMTAyMTA5MDU1M1owHzEdMBsGA1UEAwwUcHJvZDJ5LWZyb20tMjAyMDEwMTkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCUlaUFc1wf+CfY9wzFWEL2euKQ5nswqb57V8QZG7d7RoR6rwYUIXseTOAFq210oMEe++LCjzKDuqwDfsyhgDNTgZBPAaC4vUU2oy+XR+Fq8nBixWIsH668HeOnRK6RRhsr0rJzRB95aZ3EAPzBuQ2qPaNGm17pAX0Rd6MPRgjp75IWwI9eA6aMEdPQEVN7uyOtM5zSsjoj79Lbu1fjShOnQZuJcsV8tqnayeFkNzv2LTOlofU/Tbx502Ro073gGjoeRzNvrynAP03pL486P3KCAyiNPhDs2z8/COMrxRlZW5mfzo0xsK0dQGNH3UoG/9RVwHG4eS8LFpMTR9oetHZBAgMBAAGjgZkwgZYwCQYDVR0TBAIwADAdBgNVHQ4EFgQUJNoRIpb1hUHAk0foMSNM9MCEAv8wSAYDVR0jBEEwP4AUo562SGdCEjZBvW3gubSgUouX8bOhHKQaMBgxFjAUBgNVBAMMDUpldFByb2ZpbGUgQ0GCCQDSbLGDsoN54TATBgNVHSUEDDAKBggrBgEFBQcDATALBgNVHQ8EBAMCBaAwDQYJKoZIhvcNAQELBQADggIBABqRoNGxAQct9dQUFK8xqhiZaYPd30TlmCmSAaGJ0eBpvkVeqA2jGYhAQRqFiAlFC63JKvWvRZO1iRuWCEfUMkdqQ9VQPXziE/BlsOIgrL6RlJfuFcEZ8TK3syIfIGQZNCxYhLLUuet2HE6LJYPQ5c0jH4kDooRpcVZ4rBxNwddpctUO2te9UU5/FjhioZQsPvd92qOTsV+8Cyl2fvNhNKD1Uu9ff5AkVIQn4JU23ozdB/R5oUlebwaTE6WZNBs+TA/qPj+5/we9NH71WRB0hqUoLI2AKKyiPw++FtN4Su1vsdDlrAzDj9ILjpjJKA1ImuVcG329/WTYIKysZ1CWK3zATg9BeCUPAV1pQy8ToXOq+RSYen6winZ2OO93eyHv2Iw5kbn1dqfBw1BuTE29V2FJKicJSu8iEOpfoafwJISXmz1wnnWL3V/0NxTulfWsXugOoLfv0ZIBP1xH9kmf22jjQ2JiHhQZP7ZDsreRrOeIQ/c4yR8IQvMLfC0WKQqrHu5ZzXTH4NO3CwGWSlTY74kE91zXB5mwWAx1jig+UXYc2w4RkVhy0//lOmVya/PEepuuTTI4+UJwC7qbVlh5zfhj8oTNUXgN0AOc+Q0/WFPl1aw5VV/VrO8FCoB15lFVlpKaQ1Yh+DVU8ke+rt9Th0BCHXe0uZOEmH0nOnH/0onD</span><br></pre></td></tr></table></figure>
<h2 id="datagrip专用"><a class="markdownIt-Anchor" href="#datagrip专用">#</a> <strong>DataGrip 专用</strong></h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FJVUHLU3X1-eyJsaWNlbnNlSWQiOiJGSlZVSExVM1gxIiwibGljZW5zZWVOYW1lIjoia2lkZHkgaW5zZWFtcyIsImFzc2lnbmVlTmFtZSI6IiIsImFzc2lnbmVlRW1haWwiOiIiLCJsaWNlbnNlUmVzdHJpY3Rpb24iOiIiLCJjaGVja0NvbmN1cnJlbnRVc2UiOmZhbHNlLCJwcm9kdWN0cyI6W3siY29kZSI6IlBEQiIsImZhbGxiYWNrRGF0ZSI6IjIwMjUtMDgtMDEiLCJwYWlkVXBUbyI6IjIwMjUtMDgtMDEiLCJleHRlbmRlZCI6dHJ1ZX0seyJjb2RlIjoiREIiLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOmZhbHNlfSx7ImNvZGUiOiJQU0kiLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOnRydWV9LHsiY29kZSI6IlBXUyIsImZhbGxiYWNrRGF0ZSI6IjIwMjUtMDgtMDEiLCJwYWlkVXBUbyI6IjIwMjUtMDgtMDEiLCJleHRlbmRlZCI6dHJ1ZX1dLCJtZXRhZGF0YSI6IjAxMjAyMjA4MDFQU0FOMDAwMDA1IiwiaGFzaCI6IlRSSUFMOi0yNDc1NjQ2MTIiLCJncmFjZVBlcmlvZERheXMiOjcsImF1dG9Qcm9sb25nYXRlZCI6ZmFsc2UsImlzQXV0b1Byb2xvbmdhdGVkIjpmYWxzZX0=-IWA8NqxA1nOvfTGTVFX4PNAWRswj0hTsqntqWZcqcYFz/zIobEAYmHm0Lks82E0mPcNCzt0LPW6BfUZCI8f4r5E1nsonNS40bDv44qAcjBmQaLf5XxZLyoKRzl7YacDuqql+NY3tInFBX8Q4PQu56aVsS6DOZmeoO4fC66Qtwg2z+A+kvVpSlB3+1Fqww7SHZMuQbLlEOVSHqO2tf4bJVTIMH/OSMph5CpY4uJ8iv7yeBX+WQpcOy4tv1AZNEY9tIKI8nRVbnVnZaAf5R2ng1AduGCVSOaU1/ElLPReBvXTG6gZHtjKDHlAy2kq6JIH/CCeG/3ZkDLB0GzB29aSgHA==-MIIETDCCAjSgAwIBAgIBDTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTIwMTAxOTA5MDU1M1oXDTIyMTAyMTA5MDU1M1owHzEdMBsGA1UEAwwUcHJvZDJ5LWZyb20tMjAyMDEwMTkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCUlaUFc1wf+CfY9wzFWEL2euKQ5nswqb57V8QZG7d7RoR6rwYUIXseTOAFq210oMEe++LCjzKDuqwDfsyhgDNTgZBPAaC4vUU2oy+XR+Fq8nBixWIsH668HeOnRK6RRhsr0rJzRB95aZ3EAPzBuQ2qPaNGm17pAX0Rd6MPRgjp75IWwI9eA6aMEdPQEVN7uyOtM5zSsjoj79Lbu1fjShOnQZuJcsV8tqnayeFkNzv2LTOlofU/Tbx502Ro073gGjoeRzNvrynAP03pL486P3KCAyiNPhDs2z8/COMrxRlZW5mfzo0xsK0dQGNH3UoG/9RVwHG4eS8LFpMTR9oetHZBAgMBAAGjgZkwgZYwCQYDVR0TBAIwADAdBgNVHQ4EFgQUJNoRIpb1hUHAk0foMSNM9MCEAv8wSAYDVR0jBEEwP4AUo562SGdCEjZBvW3gubSgUouX8bOhHKQaMBgxFjAUBgNVBAMMDUpldFByb2ZpbGUgQ0GCCQDSbLGDsoN54TATBgNVHSUEDDAKBggrBgEFBQcDATALBgNVHQ8EBAMCBaAwDQYJKoZIhvcNAQELBQADggIBABqRoNGxAQct9dQUFK8xqhiZaYPd30TlmCmSAaGJ0eBpvkVeqA2jGYhAQRqFiAlFC63JKvWvRZO1iRuWCEfUMkdqQ9VQPXziE/BlsOIgrL6RlJfuFcEZ8TK3syIfIGQZNCxYhLLUuet2HE6LJYPQ5c0jH4kDooRpcVZ4rBxNwddpctUO2te9UU5/FjhioZQsPvd92qOTsV+8Cyl2fvNhNKD1Uu9ff5AkVIQn4JU23ozdB/R5oUlebwaTE6WZNBs+TA/qPj+5/we9NH71WRB0hqUoLI2AKKyiPw++FtN4Su1vsdDlrAzDj9ILjpjJKA1ImuVcG329/WTYIKysZ1CWK3zATg9BeCUPAV1pQy8ToXOq+RSYen6winZ2OO93eyHv2Iw5kbn1dqfBw1BuTE29V2FJKicJSu8iEOpfoafwJISXmz1wnnWL3V/0NxTulfWsXugOoLfv0ZIBP1xH9kmf22jjQ2JiHhQZP7ZDsreRrOeIQ/c4yR8IQvMLfC0WKQqrHu5ZzXTH4NO3CwGWSlTY74kE91zXB5mwWAx1jig+UXYc2w4RkVhy0//lOmVya/PEepuuTTI4+UJwC7qbVlh5zfhj8oTNUXgN0AOc+Q0/WFPl1aw5VV/VrO8FCoB15lFVlpKaQ1Yh+DVU8ke+rt9Th0BCHXe0uZOEmH0nOnH/0onD</span><br></pre></td></tr></table></figure>
<h2 id="goland专用"><a class="markdownIt-Anchor" href="#goland专用">#</a> <strong>GoLand 专用</strong></h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PSUYBOSE34-eyJsaWNlbnNlSWQiOiJQU1VZQk9TRTM0IiwibGljZW5zZWVOYW1lIjoia2lkZHkgaW5zZWFtcyIsImFzc2lnbmVlTmFtZSI6IiIsImFzc2lnbmVlRW1haWwiOiIiLCJsaWNlbnNlUmVzdHJpY3Rpb24iOiIiLCJjaGVja0NvbmN1cnJlbnRVc2UiOmZhbHNlLCJwcm9kdWN0cyI6W3siY29kZSI6IlBTSSIsImZhbGxiYWNrRGF0ZSI6IjIwMjUtMDgtMDEiLCJwYWlkVXBUbyI6IjIwMjUtMDgtMDEiLCJleHRlbmRlZCI6dHJ1ZX0seyJjb2RlIjoiUENXTVAiLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOnRydWV9LHsiY29kZSI6IkdPIiwiZmFsbGJhY2tEYXRlIjoiMjAyNS0wOC0wMSIsInBhaWRVcFRvIjoiMjAyNS0wOC0wMSIsImV4dGVuZGVkIjpmYWxzZX0seyJjb2RlIjoiUEdPIiwiZmFsbGJhY2tEYXRlIjoiMjAyNS0wOC0wMSIsInBhaWRVcFRvIjoiMjAyNS0wOC0wMSIsImV4dGVuZGVkIjp0cnVlfSx7ImNvZGUiOiJQV1MiLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOnRydWV9XSwibWV0YWRhdGEiOiIwMTIwMjIwODAxUFNBTjAwMDAwNSIsImhhc2giOiJUUklBTDotNTIzMzE4Njc5IiwiZ3JhY2VQZXJpb2REYXlzIjo3LCJhdXRvUHJvbG9uZ2F0ZWQiOmZhbHNlLCJpc0F1dG9Qcm9sb25nYXRlZCI6ZmFsc2V9-JWZKP0AJWKSXcl1Ep6poGhauD7GlLMbPVMompa2zVsDzjP2L82BvMo0RZTPYcGiLnP7YL7kHUNFrn2wJiNlXVwp9AnXUvVTspDqhf5MwZ/W0Aug0HpJB0BVSPM7KRL41wyN2DHGyvRJ/w4/s057IQEZWUUy2HUUM1E48WqezS7HlKQBVrrD+IFjHE2Xv4xaPt/KBFXTn+MwWBiYcKsIdDurNKjHdRwo/Gl0umRc8/CFMYK6nrgoWA13PAgHMZioQPc4DK2aVCbCDECpTGoMIsKl2jZJei+wPfOf9Ud9i0/95YEyoK8/XnkUBzsm19quFegTEVp3HhT/EMheCuvMmeQ==-MIIETDCCAjSgAwIBAgIBDTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTIwMTAxOTA5MDU1M1oXDTIyMTAyMTA5MDU1M1owHzEdMBsGA1UEAwwUcHJvZDJ5LWZyb20tMjAyMDEwMTkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCUlaUFc1wf+CfY9wzFWEL2euKQ5nswqb57V8QZG7d7RoR6rwYUIXseTOAFq210oMEe++LCjzKDuqwDfsyhgDNTgZBPAaC4vUU2oy+XR+Fq8nBixWIsH668HeOnRK6RRhsr0rJzRB95aZ3EAPzBuQ2qPaNGm17pAX0Rd6MPRgjp75IWwI9eA6aMEdPQEVN7uyOtM5zSsjoj79Lbu1fjShOnQZuJcsV8tqnayeFkNzv2LTOlofU/Tbx502Ro073gGjoeRzNvrynAP03pL486P3KCAyiNPhDs2z8/COMrxRlZW5mfzo0xsK0dQGNH3UoG/9RVwHG4eS8LFpMTR9oetHZBAgMBAAGjgZkwgZYwCQYDVR0TBAIwADAdBgNVHQ4EFgQUJNoRIpb1hUHAk0foMSNM9MCEAv8wSAYDVR0jBEEwP4AUo562SGdCEjZBvW3gubSgUouX8bOhHKQaMBgxFjAUBgNVBAMMDUpldFByb2ZpbGUgQ0GCCQDSbLGDsoN54TATBgNVHSUEDDAKBggrBgEFBQcDATALBgNVHQ8EBAMCBaAwDQYJKoZIhvcNAQELBQADggIBABqRoNGxAQct9dQUFK8xqhiZaYPd30TlmCmSAaGJ0eBpvkVeqA2jGYhAQRqFiAlFC63JKvWvRZO1iRuWCEfUMkdqQ9VQPXziE/BlsOIgrL6RlJfuFcEZ8TK3syIfIGQZNCxYhLLUuet2HE6LJYPQ5c0jH4kDooRpcVZ4rBxNwddpctUO2te9UU5/FjhioZQsPvd92qOTsV+8Cyl2fvNhNKD1Uu9ff5AkVIQn4JU23ozdB/R5oUlebwaTE6WZNBs+TA/qPj+5/we9NH71WRB0hqUoLI2AKKyiPw++FtN4Su1vsdDlrAzDj9ILjpjJKA1ImuVcG329/WTYIKysZ1CWK3zATg9BeCUPAV1pQy8ToXOq+RSYen6winZ2OO93eyHv2Iw5kbn1dqfBw1BuTE29V2FJKicJSu8iEOpfoafwJISXmz1wnnWL3V/0NxTulfWsXugOoLfv0ZIBP1xH9kmf22jjQ2JiHhQZP7ZDsreRrOeIQ/c4yR8IQvMLfC0WKQqrHu5ZzXTH4NO3CwGWSlTY74kE91zXB5mwWAx1jig+UXYc2w4RkVhy0//lOmVya/PEepuuTTI4+UJwC7qbVlh5zfhj8oTNUXgN0AOc+Q0/WFPl1aw5VV/VrO8FCoB15lFVlpKaQ1Yh+DVU8ke+rt9Th0BCHXe0uZOEmH0nOnH/0onD</span><br></pre></td></tr></table></figure>
<h2 id="phpstorm专用"><a class="markdownIt-Anchor" href="#phpstorm专用">#</a> <strong>PhpStorm 专用</strong></h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZEW8I0GZC6-eyJsaWNlbnNlSWQiOiJaRVc4STBHWkM2IiwibGljZW5zZWVOYW1lIjoia2lkZHkgaW5zZWFtcyIsImFzc2lnbmVlTmFtZSI6IiIsImFzc2lnbmVlRW1haWwiOiIiLCJsaWNlbnNlUmVzdHJpY3Rpb24iOiIiLCJjaGVja0NvbmN1cnJlbnRVc2UiOmZhbHNlLCJwcm9kdWN0cyI6W3siY29kZSI6IlBTSSIsImZhbGxiYWNrRGF0ZSI6IjIwMjUtMDgtMDEiLCJwYWlkVXBUbyI6IjIwMjUtMDgtMDEiLCJleHRlbmRlZCI6dHJ1ZX0seyJjb2RlIjoiUENXTVAiLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOnRydWV9LHsiY29kZSI6IlBTIiwiZmFsbGJhY2tEYXRlIjoiMjAyNS0wOC0wMSIsInBhaWRVcFRvIjoiMjAyNS0wOC0wMSIsImV4dGVuZGVkIjpmYWxzZX0seyJjb2RlIjoiUFBTIiwiZmFsbGJhY2tEYXRlIjoiMjAyNS0wOC0wMSIsInBhaWRVcFRvIjoiMjAyNS0wOC0wMSIsImV4dGVuZGVkIjp0cnVlfSx7ImNvZGUiOiJQV1MiLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOnRydWV9XSwibWV0YWRhdGEiOiIwMTIwMjIwODAxUFNBTjAwMDAwNSIsImhhc2giOiJUUklBTDo5NzM1MDQ0MzkiLCJncmFjZVBlcmlvZERheXMiOjcsImF1dG9Qcm9sb25nYXRlZCI6ZmFsc2UsImlzQXV0b1Byb2xvbmdhdGVkIjpmYWxzZX0=-UVh/hXrqvTl8syZGee3sWsipAUdbN7XBg2XpFkSNh+oGBGzwvsj2k5A3v2LGO6+46rDU/HdG14jHYnT1iDMum5K5I7aCVYOIcJcmSAViwNDLqvTcOjMOdDZ4XS3aDg/KeaX5PozDa+H/KgHdGL07nKCBuhopAesiGXZC0RYerwCnYX1DjG9b/02igSyCuIYfsCO8d3GL+/ESz+sI8FiXmyZB7N413SJDGnp9klF51Kz469YzWZNEIXp9zg3Wu/Vsq8zlW9mGCFmsyiu0btTkS5PZfxp5BebH8Ef5SvPP7SyLJ2Q0FqeCJ9ESXp6aNBW8lmTVY+R0ZpqgsBOwbkq2xg==-MIIETDCCAjSgAwIBAgIBDTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTIwMTAxOTA5MDU1M1oXDTIyMTAyMTA5MDU1M1owHzEdMBsGA1UEAwwUcHJvZDJ5LWZyb20tMjAyMDEwMTkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCUlaUFc1wf+CfY9wzFWEL2euKQ5nswqb57V8QZG7d7RoR6rwYUIXseTOAFq210oMEe++LCjzKDuqwDfsyhgDNTgZBPAaC4vUU2oy+XR+Fq8nBixWIsH668HeOnRK6RRhsr0rJzRB95aZ3EAPzBuQ2qPaNGm17pAX0Rd6MPRgjp75IWwI9eA6aMEdPQEVN7uyOtM5zSsjoj79Lbu1fjShOnQZuJcsV8tqnayeFkNzv2LTOlofU/Tbx502Ro073gGjoeRzNvrynAP03pL486P3KCAyiNPhDs2z8/COMrxRlZW5mfzo0xsK0dQGNH3UoG/9RVwHG4eS8LFpMTR9oetHZBAgMBAAGjgZkwgZYwCQYDVR0TBAIwADAdBgNVHQ4EFgQUJNoRIpb1hUHAk0foMSNM9MCEAv8wSAYDVR0jBEEwP4AUo562SGdCEjZBvW3gubSgUouX8bOhHKQaMBgxFjAUBgNVBAMMDUpldFByb2ZpbGUgQ0GCCQDSbLGDsoN54TATBgNVHSUEDDAKBggrBgEFBQcDATALBgNVHQ8EBAMCBaAwDQYJKoZIhvcNAQELBQADggIBABqRoNGxAQct9dQUFK8xqhiZaYPd30TlmCmSAaGJ0eBpvkVeqA2jGYhAQRqFiAlFC63JKvWvRZO1iRuWCEfUMkdqQ9VQPXziE/BlsOIgrL6RlJfuFcEZ8TK3syIfIGQZNCxYhLLUuet2HE6LJYPQ5c0jH4kDooRpcVZ4rBxNwddpctUO2te9UU5/FjhioZQsPvd92qOTsV+8Cyl2fvNhNKD1Uu9ff5AkVIQn4JU23ozdB/R5oUlebwaTE6WZNBs+TA/qPj+5/we9NH71WRB0hqUoLI2AKKyiPw++FtN4Su1vsdDlrAzDj9ILjpjJKA1ImuVcG329/WTYIKysZ1CWK3zATg9BeCUPAV1pQy8ToXOq+RSYen6winZ2OO93eyHv2Iw5kbn1dqfBw1BuTE29V2FJKicJSu8iEOpfoafwJISXmz1wnnWL3V/0NxTulfWsXugOoLfv0ZIBP1xH9kmf22jjQ2JiHhQZP7ZDsreRrOeIQ/c4yR8IQvMLfC0WKQqrHu5ZzXTH4NO3CwGWSlTY74kE91zXB5mwWAx1jig+UXYc2w4RkVhy0//lOmVya/PEepuuTTI4+UJwC7qbVlh5zfhj8oTNUXgN0AOc+Q0/WFPl1aw5VV/VrO8FCoB15lFVlpKaQ1Yh+DVU8ke+rt9Th0BCHXe0uZOEmH0nOnH/0onD</span><br></pre></td></tr></table></figure>
<h2 id="rider专用"><a class="markdownIt-Anchor" href="#rider专用">#</a> <strong>Rider 专用</strong></h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BZPI62LS1G-eyJsaWNlbnNlSWQiOiJCWlBJNjJMUzFHIiwibGljZW5zZWVOYW1lIjoia2lkZHkgaW5zZWFtcyIsImFzc2lnbmVlTmFtZSI6IiIsImFzc2lnbmVlRW1haWwiOiIiLCJsaWNlbnNlUmVzdHJpY3Rpb24iOiIiLCJjaGVja0NvbmN1cnJlbnRVc2UiOmZhbHNlLCJwcm9kdWN0cyI6W3siY29kZSI6IlJEIiwiZmFsbGJhY2tEYXRlIjoiMjAyNS0wOC0wMSIsInBhaWRVcFRvIjoiMjAyNS0wOC0wMSIsImV4dGVuZGVkIjpmYWxzZX0seyJjb2RlIjoiUERCIiwiZmFsbGJhY2tEYXRlIjoiMjAyNS0wOC0wMSIsInBhaWRVcFRvIjoiMjAyNS0wOC0wMSIsImV4dGVuZGVkIjp0cnVlfSx7ImNvZGUiOiJQU0kiLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOnRydWV9LHsiY29kZSI6IlBXUyIsImZhbGxiYWNrRGF0ZSI6IjIwMjUtMDgtMDEiLCJwYWlkVXBUbyI6IjIwMjUtMDgtMDEiLCJleHRlbmRlZCI6dHJ1ZX1dLCJtZXRhZGF0YSI6IjAxMjAyMjA4MDFQU0FOMDAwMDA1IiwiaGFzaCI6IlRSSUFMOjQyNzgxMDUyNCIsImdyYWNlUGVyaW9kRGF5cyI6NywiYXV0b1Byb2xvbmdhdGVkIjpmYWxzZSwiaXNBdXRvUHJvbG9uZ2F0ZWQiOmZhbHNlfQ==-UKWNg2MnWS+FD5dcOs1tir8BY/JFKGs53MiZa661VbcoBmRv+hY8hHmr71Cq1r8QMSgwL7tBEN2Bs8jSB0L1bZiNARXCIYS4IgsCL9fvg42XBOFva96qgKh3ho0PBe/xPuMabl7QLBT9E1ezzNnkZZJpq12957UZv+nWGCKgLt46WLotxxfMB/nFxgGB9uU1uXyEW84gStBYnLRv7d3Zvfdo0ANFbPmCUIpQlRqQ91TIJtYdj9l2ZbhkfVP30S3FOi0sYRnjR6Sqg0yHnFHqLGr1jG/wKEFusZPkr1bHWQsSTL/JI/sXHDQikvMcChFiN3HI1UeXleiKOwbhg00pBw==-MIIETDCCAjSgAwIBAgIBDTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTIwMTAxOTA5MDU1M1oXDTIyMTAyMTA5MDU1M1owHzEdMBsGA1UEAwwUcHJvZDJ5LWZyb20tMjAyMDEwMTkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCUlaUFc1wf+CfY9wzFWEL2euKQ5nswqb57V8QZG7d7RoR6rwYUIXseTOAFq210oMEe++LCjzKDuqwDfsyhgDNTgZBPAaC4vUU2oy+XR+Fq8nBixWIsH668HeOnRK6RRhsr0rJzRB95aZ3EAPzBuQ2qPaNGm17pAX0Rd6MPRgjp75IWwI9eA6aMEdPQEVN7uyOtM5zSsjoj79Lbu1fjShOnQZuJcsV8tqnayeFkNzv2LTOlofU/Tbx502Ro073gGjoeRzNvrynAP03pL486P3KCAyiNPhDs2z8/COMrxRlZW5mfzo0xsK0dQGNH3UoG/9RVwHG4eS8LFpMTR9oetHZBAgMBAAGjgZkwgZYwCQYDVR0TBAIwADAdBgNVHQ4EFgQUJNoRIpb1hUHAk0foMSNM9MCEAv8wSAYDVR0jBEEwP4AUo562SGdCEjZBvW3gubSgUouX8bOhHKQaMBgxFjAUBgNVBAMMDUpldFByb2ZpbGUgQ0GCCQDSbLGDsoN54TATBgNVHSUEDDAKBggrBgEFBQcDATALBgNVHQ8EBAMCBaAwDQYJKoZIhvcNAQELBQADggIBABqRoNGxAQct9dQUFK8xqhiZaYPd30TlmCmSAaGJ0eBpvkVeqA2jGYhAQRqFiAlFC63JKvWvRZO1iRuWCEfUMkdqQ9VQPXziE/BlsOIgrL6RlJfuFcEZ8TK3syIfIGQZNCxYhLLUuet2HE6LJYPQ5c0jH4kDooRpcVZ4rBxNwddpctUO2te9UU5/FjhioZQsPvd92qOTsV+8Cyl2fvNhNKD1Uu9ff5AkVIQn4JU23ozdB/R5oUlebwaTE6WZNBs+TA/qPj+5/we9NH71WRB0hqUoLI2AKKyiPw++FtN4Su1vsdDlrAzDj9ILjpjJKA1ImuVcG329/WTYIKysZ1CWK3zATg9BeCUPAV1pQy8ToXOq+RSYen6winZ2OO93eyHv2Iw5kbn1dqfBw1BuTE29V2FJKicJSu8iEOpfoafwJISXmz1wnnWL3V/0NxTulfWsXugOoLfv0ZIBP1xH9kmf22jjQ2JiHhQZP7ZDsreRrOeIQ/c4yR8IQvMLfC0WKQqrHu5ZzXTH4NO3CwGWSlTY74kE91zXB5mwWAx1jig+UXYc2w4RkVhy0//lOmVya/PEepuuTTI4+UJwC7qbVlh5zfhj8oTNUXgN0AOc+Q0/WFPl1aw5VV/VrO8FCoB15lFVlpKaQ1Yh+DVU8ke+rt9Th0BCHXe0uZOEmH0nOnH/0onD</span><br></pre></td></tr></table></figure>
<h2 id="clion专用"><a class="markdownIt-Anchor" href="#clion专用">#</a> <strong>CLion 专用</strong></h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CFUC0974F2-eyJsaWNlbnNlSWQiOiJDRlVDMDk3NEYyIiwibGljZW5zZWVOYW1lIjoia2lkZHkgaW5zZWFtcyIsImFzc2lnbmVlTmFtZSI6IiIsImFzc2lnbmVlRW1haWwiOiIiLCJsaWNlbnNlUmVzdHJpY3Rpb24iOiIiLCJjaGVja0NvbmN1cnJlbnRVc2UiOmZhbHNlLCJwcm9kdWN0cyI6W3siY29kZSI6IlBTSSIsImZhbGxiYWNrRGF0ZSI6IjIwMjUtMDgtMDEiLCJwYWlkVXBUbyI6IjIwMjUtMDgtMDEiLCJleHRlbmRlZCI6dHJ1ZX0seyJjb2RlIjoiUENXTVAiLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOnRydWV9LHsiY29kZSI6IkNMIiwiZmFsbGJhY2tEYXRlIjoiMjAyNS0wOC0wMSIsInBhaWRVcFRvIjoiMjAyNS0wOC0wMSIsImV4dGVuZGVkIjpmYWxzZX0seyJjb2RlIjoiUFNXIiwiZmFsbGJhY2tEYXRlIjoiMjAyNS0wOC0wMSIsInBhaWRVcFRvIjoiMjAyNS0wOC0wMSIsImV4dGVuZGVkIjp0cnVlfSx7ImNvZGUiOiJQV1MiLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOnRydWV9XSwibWV0YWRhdGEiOiIwMTIwMjIwODAxUFNBTjAwMDAwNSIsImhhc2giOiJUUklBTDotMjA0MTkyNDM5OCIsImdyYWNlUGVyaW9kRGF5cyI6NywiYXV0b1Byb2xvbmdhdGVkIjpmYWxzZSwiaXNBdXRvUHJvbG9uZ2F0ZWQiOmZhbHNlfQ==-f1foDndTa2abGqyTmiIMxYSRjoC16NxuD7QhoiOm0bzrHbqIuAXw7zsWC3U9RjqgWi/bj/8fjDpjywAFktScyATpClNXMzoR/nPJaY+J0iU+0ivubS9VERrIYL8O6WOT8PvNoqcdJ+MIK6jKY519y3VcUAd0N47ZKkpmzAOd9moR+j5ma3U8yuJno0oNtsAES7Lp3tzdMlhD7yn105jafY65bRPD8ezoc1c0GkFfsZ/1P3XPxoWeiS70wCSG32xNmcWygCROs3mnlDoamIv+K76G+jLlrR9csS/+vxWYaThfLKIvpwCDUX7xzdnXx8raXkr7c78ZshsNUQZuOgE8ww==-MIIETDCCAjSgAwIBAgIBDTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTIwMTAxOTA5MDU1M1oXDTIyMTAyMTA5MDU1M1owHzEdMBsGA1UEAwwUcHJvZDJ5LWZyb20tMjAyMDEwMTkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCUlaUFc1wf+CfY9wzFWEL2euKQ5nswqb57V8QZG7d7RoR6rwYUIXseTOAFq210oMEe++LCjzKDuqwDfsyhgDNTgZBPAaC4vUU2oy+XR+Fq8nBixWIsH668HeOnRK6RRhsr0rJzRB95aZ3EAPzBuQ2qPaNGm17pAX0Rd6MPRgjp75IWwI9eA6aMEdPQEVN7uyOtM5zSsjoj79Lbu1fjShOnQZuJcsV8tqnayeFkNzv2LTOlofU/Tbx502Ro073gGjoeRzNvrynAP03pL486P3KCAyiNPhDs2z8/COMrxRlZW5mfzo0xsK0dQGNH3UoG/9RVwHG4eS8LFpMTR9oetHZBAgMBAAGjgZkwgZYwCQYDVR0TBAIwADAdBgNVHQ4EFgQUJNoRIpb1hUHAk0foMSNM9MCEAv8wSAYDVR0jBEEwP4AUo562SGdCEjZBvW3gubSgUouX8bOhHKQaMBgxFjAUBgNVBAMMDUpldFByb2ZpbGUgQ0GCCQDSbLGDsoN54TATBgNVHSUEDDAKBggrBgEFBQcDATALBgNVHQ8EBAMCBaAwDQYJKoZIhvcNAQELBQADggIBABqRoNGxAQct9dQUFK8xqhiZaYPd30TlmCmSAaGJ0eBpvkVeqA2jGYhAQRqFiAlFC63JKvWvRZO1iRuWCEfUMkdqQ9VQPXziE/BlsOIgrL6RlJfuFcEZ8TK3syIfIGQZNCxYhLLUuet2HE6LJYPQ5c0jH4kDooRpcVZ4rBxNwddpctUO2te9UU5/FjhioZQsPvd92qOTsV+8Cyl2fvNhNKD1Uu9ff5AkVIQn4JU23ozdB/R5oUlebwaTE6WZNBs+TA/qPj+5/we9NH71WRB0hqUoLI2AKKyiPw++FtN4Su1vsdDlrAzDj9ILjpjJKA1ImuVcG329/WTYIKysZ1CWK3zATg9BeCUPAV1pQy8ToXOq+RSYen6winZ2OO93eyHv2Iw5kbn1dqfBw1BuTE29V2FJKicJSu8iEOpfoafwJISXmz1wnnWL3V/0NxTulfWsXugOoLfv0ZIBP1xH9kmf22jjQ2JiHhQZP7ZDsreRrOeIQ/c4yR8IQvMLfC0WKQqrHu5ZzXTH4NO3CwGWSlTY74kE91zXB5mwWAx1jig+UXYc2w4RkVhy0//lOmVya/PEepuuTTI4+UJwC7qbVlh5zfhj8oTNUXgN0AOc+Q0/WFPl1aw5VV/VrO8FCoB15lFVlpKaQ1Yh+DVU8ke+rt9Th0BCHXe0uZOEmH0nOnH/0onD</span><br></pre></td></tr></table></figure>
<h2 id="appcode专用"><a class="markdownIt-Anchor" href="#appcode专用">#</a> <strong>AppCode 专用</strong></h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VKZAU5B43Y-eyJsaWNlbnNlSWQiOiJWS1pBVTVCNDNZIiwibGljZW5zZWVOYW1lIjoia2lkZHkgaW5zZWFtcyIsImFzc2lnbmVlTmFtZSI6IiIsImFzc2lnbmVlRW1haWwiOiIiLCJsaWNlbnNlUmVzdHJpY3Rpb24iOiIiLCJjaGVja0NvbmN1cnJlbnRVc2UiOmZhbHNlLCJwcm9kdWN0cyI6W3siY29kZSI6IlBTSSIsImZhbGxiYWNrRGF0ZSI6IjIwMjUtMDgtMDEiLCJwYWlkVXBUbyI6IjIwMjUtMDgtMDEiLCJleHRlbmRlZCI6dHJ1ZX0seyJjb2RlIjoiUENXTVAiLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOnRydWV9LHsiY29kZSI6IkFDIiwiZmFsbGJhY2tEYXRlIjoiMjAyNS0wOC0wMSIsInBhaWRVcFRvIjoiMjAyNS0wOC0wMSIsImV4dGVuZGVkIjpmYWxzZX0seyJjb2RlIjoiUFNXIiwiZmFsbGJhY2tEYXRlIjoiMjAyNS0wOC0wMSIsInBhaWRVcFRvIjoiMjAyNS0wOC0wMSIsImV4dGVuZGVkIjp0cnVlfSx7ImNvZGUiOiJQV1MiLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOnRydWV9XSwibWV0YWRhdGEiOiIwMTIwMjIwODAxUFNBTjAwMDAwNSIsImhhc2giOiJUUklBTDo4MjMzNzExNjIiLCJncmFjZVBlcmlvZERheXMiOjcsImF1dG9Qcm9sb25nYXRlZCI6ZmFsc2UsImlzQXV0b1Byb2xvbmdhdGVkIjpmYWxzZX0=-RrHOvDeSwoPjgraFAh3zGXDfoJ1hXOrZJroE/sKj/96CimH7YlD0An0lUEGvSEsovDprHWDZ4q2Wq11vukassv+avD1JHuurWhjp1mpIOvOntp2VHbBV9+iUxsr5ET+zJaIl0WiaRd6n75LeU4ZhxT4y6Da7cLbrqEawH+zjUuHzs60mUaqZ/5+j3qfVlwnx+iwPPu3dFtXWvADmcV/nb2jwnrJcLx9HMGVbS3yrgNoXhqXI+YRsYdNwYXbF7yVseGoxjKHQDBWTd3dAjWES/iC0s8xzLD7VXGkd3gIDJ0cc8cgzmCUr3E/QABzU1CdpqY0hyCedCvb9IOwfmTH+ug==-MIIETDCCAjSgAwIBAgIBDTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTIwMTAxOTA5MDU1M1oXDTIyMTAyMTA5MDU1M1owHzEdMBsGA1UEAwwUcHJvZDJ5LWZyb20tMjAyMDEwMTkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCUlaUFc1wf+CfY9wzFWEL2euKQ5nswqb57V8QZG7d7RoR6rwYUIXseTOAFq210oMEe++LCjzKDuqwDfsyhgDNTgZBPAaC4vUU2oy+XR+Fq8nBixWIsH668HeOnRK6RRhsr0rJzRB95aZ3EAPzBuQ2qPaNGm17pAX0Rd6MPRgjp75IWwI9eA6aMEdPQEVN7uyOtM5zSsjoj79Lbu1fjShOnQZuJcsV8tqnayeFkNzv2LTOlofU/Tbx502Ro073gGjoeRzNvrynAP03pL486P3KCAyiNPhDs2z8/COMrxRlZW5mfzo0xsK0dQGNH3UoG/9RVwHG4eS8LFpMTR9oetHZBAgMBAAGjgZkwgZYwCQYDVR0TBAIwADAdBgNVHQ4EFgQUJNoRIpb1hUHAk0foMSNM9MCEAv8wSAYDVR0jBEEwP4AUo562SGdCEjZBvW3gubSgUouX8bOhHKQaMBgxFjAUBgNVBAMMDUpldFByb2ZpbGUgQ0GCCQDSbLGDsoN54TATBgNVHSUEDDAKBggrBgEFBQcDATALBgNVHQ8EBAMCBaAwDQYJKoZIhvcNAQELBQADggIBABqRoNGxAQct9dQUFK8xqhiZaYPd30TlmCmSAaGJ0eBpvkVeqA2jGYhAQRqFiAlFC63JKvWvRZO1iRuWCEfUMkdqQ9VQPXziE/BlsOIgrL6RlJfuFcEZ8TK3syIfIGQZNCxYhLLUuet2HE6LJYPQ5c0jH4kDooRpcVZ4rBxNwddpctUO2te9UU5/FjhioZQsPvd92qOTsV+8Cyl2fvNhNKD1Uu9ff5AkVIQn4JU23ozdB/R5oUlebwaTE6WZNBs+TA/qPj+5/we9NH71WRB0hqUoLI2AKKyiPw++FtN4Su1vsdDlrAzDj9ILjpjJKA1ImuVcG329/WTYIKysZ1CWK3zATg9BeCUPAV1pQy8ToXOq+RSYen6winZ2OO93eyHv2Iw5kbn1dqfBw1BuTE29V2FJKicJSu8iEOpfoafwJISXmz1wnnWL3V/0NxTulfWsXugOoLfv0ZIBP1xH9kmf22jjQ2JiHhQZP7ZDsreRrOeIQ/c4yR8IQvMLfC0WKQqrHu5ZzXTH4NO3CwGWSlTY74kE91zXB5mwWAx1jig+UXYc2w4RkVhy0//lOmVya/PEepuuTTI4+UJwC7qbVlh5zfhj8oTNUXgN0AOc+Q0/WFPl1aw5VV/VrO8FCoB15lFVlpKaQ1Yh+DVU8ke+rt9Th0BCHXe0uZOEmH0nOnH/0onD</span><br></pre></td></tr></table></figure>
<h2 id="rubymine专用"><a class="markdownIt-Anchor" href="#rubymine专用">#</a> <strong>RubyMine 专用</strong></h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EZK4R5UGRP-eyJsaWNlbnNlSWQiOiJFWks0UjVVR1JQIiwibGljZW5zZWVOYW1lIjoia2lkZHkgaW5zZWFtcyIsImFzc2lnbmVlTmFtZSI6IiIsImFzc2lnbmVlRW1haWwiOiIiLCJsaWNlbnNlUmVzdHJpY3Rpb24iOiIiLCJjaGVja0NvbmN1cnJlbnRVc2UiOmZhbHNlLCJwcm9kdWN0cyI6W3siY29kZSI6IlBTSSIsImZhbGxiYWNrRGF0ZSI6IjIwMjUtMDgtMDEiLCJwYWlkVXBUbyI6IjIwMjUtMDgtMDEiLCJleHRlbmRlZCI6dHJ1ZX0seyJjb2RlIjoiUENXTVAiLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOnRydWV9LHsiY29kZSI6IlBSQiIsImZhbGxiYWNrRGF0ZSI6IjIwMjUtMDgtMDEiLCJwYWlkVXBUbyI6IjIwMjUtMDgtMDEiLCJleHRlbmRlZCI6dHJ1ZX0seyJjb2RlIjoiUk0iLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOmZhbHNlfSx7ImNvZGUiOiJQV1MiLCJmYWxsYmFja0RhdGUiOiIyMDI1LTA4LTAxIiwicGFpZFVwVG8iOiIyMDI1LTA4LTAxIiwiZXh0ZW5kZWQiOnRydWV9XSwibWV0YWRhdGEiOiIwMTIwMjIwODAxUFNBTjAwMDAwNSIsImhhc2giOiJUUklBTDoxOTE2MTQ0NDI2IiwiZ3JhY2VQZXJpb2REYXlzIjo3LCJhdXRvUHJvbG9uZ2F0ZWQiOmZhbHNlLCJpc0F1dG9Qcm9sb25nYXRlZCI6ZmFsc2V9-Bc16m/sJ8qqPmC6hBp93iF6Y3vU9CgV5PhPpWDM3p5qEu3oM/BnP3TuTK4uxuaXo16JJF5N0RhV1n4Od7mq83La246o9e2tzTBEwniF19U3zUgOHk9arYIluefGJODHrY07uYfFJzF+i5XXZ7fVOVz1IjWtcU5Mdet/48gh2RVMRPvIi5JHZi1dRawzBKUwTzOeBGvs2GRSqWphxxc5uUqmOhQiIcNK3IBcZS8gANY0XaFmF6gkglNl7g1fPP9nZ79MWWlvDuqlXmVMCiS2OFiMNfAsJ8fjIWiY32r3PlnV/ES356fwYnVDw9ATvRZL05VaRKrLSfKuq8E/ewiRGxA==-MIIETDCCAjSgAwIBAgIBDTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTIwMTAxOTA5MDU1M1oXDTIyMTAyMTA5MDU1M1owHzEdMBsGA1UEAwwUcHJvZDJ5LWZyb20tMjAyMDEwMTkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCUlaUFc1wf+CfY9wzFWEL2euKQ5nswqb57V8QZG7d7RoR6rwYUIXseTOAFq210oMEe++LCjzKDuqwDfsyhgDNTgZBPAaC4vUU2oy+XR+Fq8nBixWIsH668HeOnRK6RRhsr0rJzRB95aZ3EAPzBuQ2qPaNGm17pAX0Rd6MPRgjp75IWwI9eA6aMEdPQEVN7uyOtM5zSsjoj79Lbu1fjShOnQZuJcsV8tqnayeFkNzv2LTOlofU/Tbx502Ro073gGjoeRzNvrynAP03pL486P3KCAyiNPhDs2z8/COMrxRlZW5mfzo0xsK0dQGNH3UoG/9RVwHG4eS8LFpMTR9oetHZBAgMBAAGjgZkwgZYwCQYDVR0TBAIwADAdBgNVHQ4EFgQUJNoRIpb1hUHAk0foMSNM9MCEAv8wSAYDVR0jBEEwP4AUo562SGdCEjZBvW3gubSgUouX8bOhHKQaMBgxFjAUBgNVBAMMDUpldFByb2ZpbGUgQ0GCCQDSbLGDsoN54TATBgNVHSUEDDAKBggrBgEFBQcDATALBgNVHQ8EBAMCBaAwDQYJKoZIhvcNAQELBQADggIBABqRoNGxAQct9dQUFK8xqhiZaYPd30TlmCmSAaGJ0eBpvkVeqA2jGYhAQRqFiAlFC63JKvWvRZO1iRuWCEfUMkdqQ9VQPXziE/BlsOIgrL6RlJfuFcEZ8TK3syIfIGQZNCxYhLLUuet2HE6LJYPQ5c0jH4kDooRpcVZ4rBxNwddpctUO2te9UU5/FjhioZQsPvd92qOTsV+8Cyl2fvNhNKD1Uu9ff5AkVIQn4JU23ozdB/R5oUlebwaTE6WZNBs+TA/qPj+5/we9NH71WRB0hqUoLI2AKKyiPw++FtN4Su1vsdDlrAzDj9ILjpjJKA1ImuVcG329/WTYIKysZ1CWK3zATg9BeCUPAV1pQy8ToXOq+RSYen6winZ2OO93eyHv2Iw5kbn1dqfBw1BuTE29V2FJKicJSu8iEOpfoafwJISXmz1wnnWL3V/0NxTulfWsXugOoLfv0ZIBP1xH9kmf22jjQ2JiHhQZP7ZDsreRrOeIQ/c4yR8IQvMLfC0WKQqrHu5ZzXTH4NO3CwGWSlTY74kE91zXB5mwWAx1jig+UXYc2w4RkVhy0//lOmVya/PEepuuTTI4+UJwC7qbVlh5zfhj8oTNUXgN0AOc+Q0/WFPl1aw5VV/VrO8FCoB15lFVlpKaQ1Yh+DVU8ke+rt9Th0BCHXe0uZOEmH0nOnH/0onD</span><br></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-02-14T07:07:15.677Z" title="2023-2-14 15:07:15">2023-02-14</time>发表</span><span class="level-item"><time dateTime="2023-02-14T07:08:59.782Z" title="2023-2-14 15:08:59">2023-02-14</time>更新</span><span class="level-item">4 分钟读完 (大约603个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/02/14/%E3%80%90Flutter%E3%80%91Flutter%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/">【Flutter】Flutter生命周期</a></p><div class="content"><h3 id="flutterflutter生命周期"><a class="markdownIt-Anchor" href="#flutterflutter生命周期">#</a> 【Flutter】Flutter 生命周期</h3>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/cf191df81ef144b9bca93e0a385bdd8d.png" alt="img"></p>
<h2 id="一-生命周期阶段"><a class="markdownIt-Anchor" href="#一-生命周期阶段">#</a> 一、<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F&amp;spm=1001.2101.3001.7020">生命周期</a>阶段</h2>
<p>​    <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=flutter&amp;spm=1001.2101.3001.7020">flutter</a> 生命周期大体上可以分为三个阶段：初始化、状态变化、销毁。</p>
<h3 id="1-初始化阶段"><a class="markdownIt-Anchor" href="#1-初始化阶段">#</a> 1、初始化阶段</h3>
<p>对应执行构造方法和 initState 时候</p>
<h3 id="2-状态变化阶段"><a class="markdownIt-Anchor" href="#2-状态变化阶段">#</a> 2、状态变化阶段</h3>
<p>开新的 widget 或者调用<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=setState&amp;spm=1001.2101.3001.7020"> setState</a> 方法的时候</p>
<h3 id="3-销毁阶段"><a class="markdownIt-Anchor" href="#3-销毁阶段">#</a> 3、销毁阶段</h3>
<p>deactivate 和 dispose</p>
<h2 id="二-生命周期阶段执行的函数"><a class="markdownIt-Anchor" href="#二-生命周期阶段执行的函数">#</a> 二、生命周期阶段执行的函数</h2>
<h3 id="1-initstate"><a class="markdownIt-Anchor" href="#1-initstate">#</a> 1、initState</h3>
<p>调用次数：1 次</p>
<p>插入渲染树时调用，只调用一次，widget 创建执行的第一个方法，这里可以做一些初始化工作，比如初始化 State 的变量。</p>
<h3 id="2-didchangedependencies"><a class="markdownIt-Anchor" href="#2-didchangedependencies">#</a> 2、didChangeDependencies</h3>
<p>调用次数：多次</p>
<ul>
<li>初始化时，在 initState () 之后立刻调用</li>
<li>当依赖的 InheritedWidget rebuild, 会触发此接口被调用</li>
<li>实测在组件可见状态变化的时候会调用</li>
</ul>
<h3 id="3-build"><a class="markdownIt-Anchor" href="#3-build">#</a> 3、build</h3>
<p>调用次数：多次</p>
<ul>
<li>初始化之后开始绘制界面</li>
<li>setState 触发的时候会</li>
</ul>
<h3 id="4-didupdatewidget"><a class="markdownIt-Anchor" href="#4-didupdatewidget">#</a> 4、didUpdateWidget</h3>
<p>调用次数：多次</p>
<p>组件状态改变时候调用</p>
<h3 id="5-deactivate"><a class="markdownIt-Anchor" href="#5-deactivate">#</a> 5、deactivate</h3>
<p>当 State 对象从树中被移除时，会调用此回调，会在 dispose 之前调用。</p>
<p>页面销毁的时候会依次执行：deactivate &gt; dispose</p>
<h3 id="6-dispose"><a class="markdownIt-Anchor" href="#6-dispose">#</a> 6、dispose</h3>
<p>调用次数：1 次</p>
<p>当 State 对象从树中被永久移除时调用；通常在此回调中释放资源。</p>
<h3 id="7-reassemble"><a class="markdownIt-Anchor" href="#7-reassemble">#</a> 7、reassemble</h3>
<p>在热重载 (hot reload) 时会被调用，此回调在 Release 模式下永远不会被调用</p>
<h2 id="三-app生命周期"><a class="markdownIt-Anchor" href="#三-app生命周期">#</a> 三、App 生命周期</h2>
<p>​    通过 WidgetsBindingObserver 的 didChangeAppLifecycleState 来获取。通过该接口可以获取是生命周期在 AppLifecycleState 类中。</p>
<h3 id="1-resumed"><a class="markdownIt-Anchor" href="#1-resumed">#</a> 1、resumed</h3>
<p>可见并能响应用户的输入，同安卓的 onResume</p>
<h3 id="2-inactive"><a class="markdownIt-Anchor" href="#2-inactive">#</a> 2、inactive</h3>
<p>处在并不活动状态，无法处理用户响应，同安卓的 onPause</p>
<h3 id="3-paused"><a class="markdownIt-Anchor" href="#3-paused">#</a> 3、paused</h3>
<p>不可见并不能响应用户的输入，但是在后台继续活动中，同安卓的 onStop</p>
<p><strong>下面是生命周期：</strong></p>
<ol>
<li>初次打开 widget 时，不执行 AppLifecycleState 的回调；</li>
<li>按 home 键或 Power 键， AppLifecycleState inactive----&gt;AppLifecycleState pause</li>
<li>从后台到前台：AppLifecycleState inactive—&gt;ApplifecycleState resumed</li>
<li>back 键退出应用： AppLifecycleState inactive—&gt;AppLifecycleState paused</li>
</ol>
<p>参考文章：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/00ff0c2b8336">https://www.jianshu.com/p/00ff0c2b8336</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-02-11T02:19:46.158Z" title="2023-2-11 10:19:46">2023-02-11</time>发表</span><span class="level-item"><time dateTime="2023-02-11T02:19:20.883Z" title="2023-2-11 10:19:20">2023-02-11</time>更新</span><span class="level-item">3 分钟读完 (大约433个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/02/11/%E3%80%90%E5%9F%9F%E5%90%8D%E6%9C%8D%E5%8A%A1%E3%80%91%E8%85%BE%E8%AE%AF%E4%BA%91%E7%94%B3%E8%AF%B7%E7%9A%84%E5%85%8D%E8%B4%B9%E8%AF%81%E4%B9%A6%E9%83%A8%E7%BD%B2%E5%88%B0%E9%98%BF%E9%87%8C%E4%BA%91CDN%E5%92%8C%E4%BA%91%E7%9B%BE%E8%AF%81%E4%B9%A6%E4%B8%AD%E5%BF%83/">腾讯云申请的免费证书部署到阿里云CDN和云盾证书中心</a></p><div class="content"><h3 id="腾讯云申请的免费证书部署到阿里云cdn和云盾证书中心"><a class="markdownIt-Anchor" href="#腾讯云申请的免费证书部署到阿里云cdn和云盾证书中心">#</a> 腾讯云申请的免费证书部署到阿里云 CDN 和云盾证书中心</h3>
<p>tips：以下内容仅支持有域名的小伙伴配置，没有域名请先申请域名</p>
<p>小伙伴们在有了自己的不知道如何部署 HTTPS？请看下面的操作</p>
<p>​	为什么不在阿里云申请 SSL 证书</p>
<p>​	答：阿里云免费证书很慢，而且付费的超级贵</p>
<p>所以本教程让大家在腾讯云官方申请 SSL 证书，注意：有效期只能为 1 年，过期不续费，只能重新申请和配置</p>
<p>1. 进入腾讯云证书官网： <a target="_blank" rel="noopener" href="https://console.cloud.tencent.com/ssl">https://console.cloud.tencent.com/ssl</a></p>
<p>2. 点击申请免费证书</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230211101221781.png" alt="image-20230211101221781"></p>
<p>3. 输入绑定的域名、校验方式选择自动 DNS 验证、邮箱填写常用邮箱<img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230211101232921.png" alt="image-20230211101232921"></p>
<p>点击提交申请，等待校验通过</p>
<p>4. 申请通过后会颁发证书</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230211101359187.png" alt="image-20230211101359187"></p>
<p>5. 点击右侧下载，选择 Nginx 证书压缩包</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230211101422722.png" alt="image-20230211101422722"></p>
<p>解压缩后可以看见如下文件</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230211101454344.png" alt="image-20230211101454344"></p>
<p>6. 进入阿里云 云盾证书管理 <a target="_blank" rel="noopener" href="https://yundunnext.console.aliyun.com/?spm=5176.11785003.domainDetail.14.4251142fPqrVnU&amp;p=cas#/certExtend/upload">https://yundunnext.console.aliyun.com/?spm=5176.11785003.domainDetail.14.4251142fPqrVnU&amp;p=cas#/certExtend/upload</a></p>
<p>点击上传证书</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230211101539890.png" alt="image-20230211101539890"></p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230211101638094.png" alt="image-20230211101638094"></p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230211101727709.png" alt="image-20230211101727709"></p>
<p>点击确定后上传成功。</p>
<p>接下来就可以在阿里云使用你在腾讯云申请的证书来支持你的 CDN HTTPS 服务拉！</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/image-20230211101919544.png" alt="image-20230211101919544"></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-02-10T06:12:58.594Z" title="2023-2-10 14:12:58">2023-02-10</time>发表</span><span class="level-item"><time dateTime="2023-02-10T06:14:04.732Z" title="2023-2-10 14:14:04">2023-02-10</time>更新</span><span class="level-item">2 分钟读完 (大约252个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/02/10/%E3%80%90Docker%E3%80%91%E5%85%B3%E4%BA%8Edocker%E6%9C%8D%E5%8A%A1%E6%8A%A5%E9%94%99WARNING%20IPv4%20forwarding%20is%20disabled.%20Networking%20will%20not%20work/">【Docker】关于docker服务报错WARNING IPv4 forwarding is disabled. Networking will not work</a></p><div class="content"><h3 id="docker关于docker服务报错warning-ipv4-forwarding-is-disabled-networking-will-not-work"><a class="markdownIt-Anchor" href="#docker关于docker服务报错warning-ipv4-forwarding-is-disabled-networking-will-not-work">#</a> 【Docker】关于 docker 服务报错 WARNING IPv4 forwarding is disabled. Networking will not work</h3>
<p><strong>注意：在这里强调，强制进入或者进入镜像，进入后会引起 yum install 和 wget 等不能使用</strong></p>
<h2 id="一docker-运行直接报错"><a class="markdownIt-Anchor" href="#一docker-运行直接报错">#</a> <strong>一，docker 运行直接报错</strong></h2>
<p><strong>报错：</strong></p>
<p>[root@localhost /]# docker run -it ubuntu /bin/bash</p>
<p><em>WARNING: IPv4 forwarding is disabled. Networking will not work.</em></p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/05472c924858164c6df96734a709fd3b.png" alt="img"></p>
<p>1. 解决方式：</p>
<p>第一步：在宿主机上执行 echo “net.<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=ipv4&amp;spm=1001.2101.3001.7020">ipv4</a>.ip_forward=1” &gt;&gt;/usr/lib/sysctl.d/00-system.conf</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/56fe262e97ffdd8fb3992692af566dd2.png" alt="img"></p>
<p>2. 第二步：重启 network 和 docker 服务</p>
<p>[root@localhost /]# systemctl restart network &amp;&amp; systemctl restart docker</p>
<p>3. 第三步：验证是否成功</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/fe9d3a924773707b13542350b4f77b2e.png" alt="img"></p>
<p>可见完美解决问题。</p>
<h2 id="二如果你是docker容器运行镜像的时候也是报这种错误相对应得也是重启一下docker就可以完美解决了了"><a class="markdownIt-Anchor" href="#二如果你是docker容器运行镜像的时候也是报这种错误相对应得也是重启一下docker就可以完美解决了了">#</a> 二，如果你是 docker 容器运行镜像的时候也是报这种错误，相对应得也是重启一下 docker 就可以完美解决了了。</h2>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-02-08T07:43:14.628Z" title="2023-2-8 15:43:14">2023-02-08</time>发表</span><span class="level-item"><time dateTime="2023-02-08T07:46:54.513Z" title="2023-2-8 15:46:54">2023-02-08</time>更新</span><span class="level-item">2 分钟读完 (大约281个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/02/08/%E3%80%90Elasticsearch%E3%80%91Linux%E7%8E%AF%E5%A2%83%E4%B8%8B%E5%AE%89%E8%A3%85%E5%B9%B6%E5%90%AF%E5%8A%A8Elasticsearch-head/">Linux环境下安装并启动Elasticsearch-head</a></p><div class="content"><h1 id="1-elasticsearch-head介绍"><a class="markdownIt-Anchor" href="#1-elasticsearch-head介绍">#</a> 1、<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=elasticsearch-head&amp;spm=1001.2101.3001.7020">elasticsearch-head</a> 介绍</h1>
<p>官方地址: <a target="_blank" rel="noopener" href="https://github.com/mobz/elasticsearch-head">https://github.com/mobz/elasticsearch-head</a></p>
<p>elasticsearch-head 是一款用来管理 Elasticsearch 集群的第三方插件工具。 elasticsearch-Head 插件在 5.0 版本之前可以直接以插件的形式直接安装，但是 5.0 以后安装方式发生了改变，需要 <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=nodejs&amp;spm=1001.2101.3001.7020">nodejs</a> 环境支持，或者直接使用别人封装好的 docker 镜像，更推荐的是谷歌浏览器的插件。</p>
<h1 id="2-elasticsearch-head安装"><a class="markdownIt-Anchor" href="#2-elasticsearch-head安装">#</a> 2、elasticsearch-head 安装</h1>
<h2 id="npm安装elasticsearch-head"><a class="markdownIt-Anchor" href="#npm安装elasticsearch-head">#</a> npm 安装 elasticsearch-head</h2>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#下载安装nodejs</span><br><span class="line">wget https://nodejs.org/dist/v12.13.0/node-v12.13.0-linux-x64.tar.xz</span><br><span class="line">tar xf node-v12.13.0-linux-x64.tar.xz</span><br><span class="line">mv node-v12.13.0-linux-x64 node</span><br><span class="line">#修改环境变量</span><br><span class="line">echo &#x27;export PATH=$PATH:/opt/node/bin&#x27; &gt;&gt; /etc/profile</span><br><span class="line">#配置生效</span><br><span class="line">source /etc/profile</span><br><span class="line">npm -v</span><br><span class="line">node -v</span><br><span class="line"></span><br><span class="line">#下载elasticsearch-head</span><br><span class="line">git clone git://github.com/mobz/elasticsearch-head.git</span><br><span class="line"></span><br><span class="line">#进入elasticsearch-head安装目录</span><br><span class="line">cd elasticsearch-head</span><br><span class="line">#配置国内镜像</span><br><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br><span class="line">#安装</span><br><span class="line">cnpm install</span><br><span class="line">#启动</span><br><span class="line">cnpm run start</span><br></pre></td></tr></table></figure>
</blockquote>
<p>修改 Elasticsearch 配置文件，添加如下参数并重启:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#准许es被跨域访问</span><br><span class="line">http.cors.enabled: true</span><br><span class="line">http.cors.allow-origin: &quot;*&quot;</span><br></pre></td></tr></table></figure></div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/3/">上一页</a></div><div class="pagination-next"><a href="/page/5/">下一页</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li><li><a class="pagination-link" href="/page/3/">3</a></li><li><a class="pagination-link is-current" href="/page/4/">4</a></li><li><a class="pagination-link" href="/page/5/">5</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/11/">11</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-13T07:10:58.045Z">2023-04-13</time></p><p class="title"><a href="/2023/04/13/%E3%80%90Flutter%E3%80%91Flutter%E4%BF%AE%E5%A4%8DAndroid%2012%E6%97%A0%E6%B3%95%E6%9E%84%E5%BB%BA%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%8C%E8%87%AA%E5%8A%A8%E9%80%82%E9%85%8D%20exported%20%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90%E9%81%BF%E5%9D%91/">【Flutter】Flutter修复Android 12无法构建的问题，自动适配 exported 深入解析避坑.md</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-12T08:58:14.851Z">2023-04-12</time></p><p class="title"><a href="/2023/04/12/%E3%80%90Java%E3%80%91Graalvm%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E4%B8%8Espringboot3.0%E5%B0%9D%E9%B2%9C/">【Java】Graalvm安装配置与springboot3.0尝鲜</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-12T08:51:29.975Z">2023-04-12</time></p><p class="title"><a href="/2023/04/12/%E3%80%90SpringBoot%E3%80%91SpringBoot3.0%20%E4%BA%91%E5%8E%9F%E7%94%9F%E6%97%B6%E4%BB%A3%E5%8D%B3%E5%B0%86%E6%9D%A5%E4%B8%B4%EF%BC%81/">【SpringBoot】SpringBoot3.0 云原生时代即将来临！</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-12T06:27:52.331Z">2023-04-12</time></p><p class="title"><a href="/2023/04/12/%E3%80%90Java%E3%80%91%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E5%B0%86%E6%95%B0%E7%BB%84%E8%BD%AC%E6%8D%A2%E4%B8%BAList%E9%9B%86%E5%90%88/">【Java】如何优雅的将数组转换为List集合</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-11T09:18:33.616Z">2023-04-11</time></p><p class="title"><a href="/2023/04/11/%E3%80%90Redis%E3%80%91SpringBoot%E6%95%B4%E5%90%88Redis%EF%BC%8C%E7%BC%93%E5%AD%98%E6%89%B9%E9%87%8F%E5%88%A0%E9%99%A4%20%20redisTemplate.keys(pattern)%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%E6%89%BE%E4%B8%8D%E5%88%B0keys%EF%BC%8C%E2%80%9C%20%20%E2%80%9C%20%E9%80%9A%E9%85%8D%E7%AC%A6%E6%97%A0%E6%95%88/">【Redis】SpringBoot整合Redis，缓存批量删除  redisTemplate.keys(pattern)模糊查询找不到keys，“  “ 通配符无效</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/"><span class="level-start"><span class="level-item">2023</span></span><span class="level-end"><span class="level-item tag">49</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/"><span class="level-start"><span class="level-item">2022</span></span><span class="level-end"><span class="level-item tag">56</span></span></a></li></ul></div></div></div><!--!--><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://brath.cloud/7f71f67568cbf455bf7b2c32345f71e3.jpg" alt="Brath"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Brath</p><p class="is-size-6 is-block">为了更好的你，也为了更好的世界。</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国·江苏·无锡</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">105</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">0</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/Guoqing815" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Guoqing815"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Gitee" href="https://gitee.com/Guoqing-Li"><i class="fab fa-gitee"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://schokolade.cn/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">泠灵(特别呜谢)</span></span><span class="level-right"><span class="level-item tag">schokolade.cn</span></span></a></li><li><a class="level is-mobile" href="https://gitee.com/Guoqing-Li" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Gitee(码云)</span></span><span class="level-right"><span class="level-item tag">gitee.com</span></span></a></li><li><a class="level is-mobile" href="https://blog.csdn.net/Brath?type=blog" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">CSDN</span></span><span class="level-right"><span class="level-item tag">blog.csdn.net</span></span></a></li><li><a class="level is-mobile" href="https://juejin.cn/user/settings/profile" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">掘金</span></span><span class="level-right"><span class="level-item tag">juejin.cn</span></span></a></li><li><a class="level is-mobile" href="https://oss.console.aliyun.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">AliCloud(阿里云)</span></span><span class="level-right"><span class="level-item tag">oss.console.aliyun.com</span></span></a></li><li><a class="level is-mobile" href="https://cloud.tencent.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">TencentCloud(腾讯云)</span></span><span class="level-right"><span class="level-item tag">cloud.tencent.com</span></span></a></li><li><a class="level is-mobile" href="https://www.zhipin.com/web/user/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">BOSS</span></span><span class="level-right"><span class="level-item tag">www.zhipin.com</span></span></a></li><li><a class="level is-mobile" href="https://www.bilibili.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bilibili(B站)</span></span><span class="level-right"><span class="level-item tag">www.bilibili.com</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://brath.cloud/me.png" alt="Brath-Blog" height="28"></a><p class="is-size-7"><span>&copy; 2023 Brath</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2029</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>