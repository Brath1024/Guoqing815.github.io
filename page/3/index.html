<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Brath-Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Brath-Blog"><meta name="msapplication-TileImage" content="https://brath.cloud/me.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Brath-Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Brath-Blog"><meta property="og:url" content="http://example.com/"><meta property="og:site_name" content="Brath-Blog"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://example.com/img/og_image.png"><meta property="article:author" content="Brath"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://example.com/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com"},"headline":"Brath-Blog","image":["http://example.com/img/og_image.png"],"author":{"@type":"Person","name":"Brath"},"publisher":{"@type":"Organization","name":"Brath-Blog","logo":{"@type":"ImageObject","url":"https://brath.cloud/me.png"}},"description":""}</script><link rel="icon" href="https://brath.cloud/me.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://brath.cloud/me.png" alt="Brath-Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">文章列表</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">更多</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Guoqing815"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-04-26T01:40:26.718Z" title="2023/4/26 09:40:26">2023-04-26</time>发表</span><span class="level-item"><time dateTime="2023-06-23T06:21:58.000Z" title="2023/6/23 14:21:58">2023-06-23</time>更新</span><span class="level-item">11 分钟读完 (大约1638个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/04/26/%E3%80%90Node%E3%80%91node&amp;npm&amp;cnpm&amp;webpack&amp;yarn%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/">node&amp;npm&amp;cnpm&amp;webpack&amp;yarn安装教程</a></p><div class="content"><p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png" alt="InterviewCoder"></p>
<h3 id="nodejs"><a class="markdownIt-Anchor" href="#nodejs">#</a> Node.js</h3>
<p>​		nodejs 是一个让 JavaScript 运行在服务端的开发平台，它让 JavaScript 成为与 PHP、Python、Perl、Ruby 等服务端语言平起平坐的脚本语言</p>
<p>​		nodejs 能做 web 开发，REST 开发，小程序开发等等，它就是使用 JavaScript 进行开发的，也就是说，基本上每个 web 开发的人员都可以比较轻松的转到 nodejs 平台，nodejs 就像是 JavaScript 抛弃 window,document 等这些 dom 对象后的东西的一个封装</p>
<p>nodejs 下载地址：<a target="_blank" rel="noopener" href="https://nodejs.org/en/">https://nodejs.org/en/</a></p>
<h5 id="nodejs安装"><a class="markdownIt-Anchor" href="#nodejs安装">#</a> Node.js 安装：</h5>
<p>​		1 . 首先要查看本机是否已安装 nodeJs，打开命令提示符，输入 node&amp;node -v 查看。</p>
<p>​		2 . 打开 Node.js Setup 文件执行安装    选择安装路径，全部下一步。</p>
<p>​		3 . 安装完毕之后，重新打开一个命令提示符窗口，出入 node -v</p>
<p>现在，我们来 Hello World 一下，开启命令行窗口，输入 node，进入 node 的命令行，我们可以输入 console.log (“hello world”)<img src="https://img2018.cnblogs.com/blog/1033563/201906/1033563-20190604153223076-1028024327.png" alt="img"></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">或者，我们可以创建一个web服务，进入node命令行后，输入</span><br><span class="line">View Code</span><br><span class="line">回车后，在浏览器输入：http<span class="punctuation">:</span><span class="comment">//localhost:8000就输出了hello world</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="npm"><a class="markdownIt-Anchor" href="#npm">#</a> npm：</h3>
<h5 id="npm安装"><a class="markdownIt-Anchor" href="#npm安装">#</a> npm 安装：</h5>
<p>Nodejs 下的包管理器。</p>
<p>下载 Node 后自带一个旧版本的 npm。</p>
<hr>
<h3 id="cnpm"><a class="markdownIt-Anchor" href="#cnpm">#</a> cnpm:</h3>
<p>Nodejs 下的包管理器，国内淘宝镜像版本。</p>
<h5 id="cnpm安装"><a class="markdownIt-Anchor" href="#cnpm安装">#</a> cnpm 安装：</h5>
<p>首先要有 node 环境和 npm 环境–</p>
<p>1、安装 cnpm，输入以下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>
<p>如图所示：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/a5fada1c44e9cba82055d5c6db8ea69a.png" alt="img"></p>
<p>2、输入 <code>cnpm -v</code>  ，检测是否正常</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/374a7ba6c4e04cdb785a5dca12536ad1.png" alt="img"></p>
<hr>
<h3 id="webpack"><a class="markdownIt-Anchor" href="#webpack">#</a> webpack:</h3>
<p>它主要的用途是通过 CommonJS 的语法把所有浏览器端需要发布的静态资源做相应的准备，比如资源的合并和打包。</p>
<h5 id="webpack安装"><a class="markdownIt-Anchor" href="#webpack安装">#</a> webpack 安装：</h5>
<p>首先需要安装好 nodeJs&amp;npm 的环境～</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node -v   <span class="comment">// 查看node的版本 不能太高</span></span><br><span class="line">npm -v   <span class="comment">//查看npm的版本</span></span><br></pre></td></tr></table></figure>
<p>全局安装:</p>
<p>打开命令行（win+R    输入 cmd）</p>
<p><img src="https://img-blog.csdn.net/20180809221529512?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3MTMwOTgz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="img"></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install webpack webpack-cli -g --save-dev #输入并执行下载webpack </span><br><span class="line">-g #全局安装 </span><br><span class="line">--save-dev #信息写入package.json的devDependencies中</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdn.net/20180809222148241?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3MTMwOTgz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="img"></p>
<p>下载好后在命令行执行 webpack -v 查看 webpack 的版本号，正常显示说明安装好了</p>
<hr>
<h3 id="yarn"><a class="markdownIt-Anchor" href="#yarn">#</a> yarn：</h3>
<p>​	<strong>Yarn 是 facebook 发布的一款取代 npm 的包管理工具。</strong><br>
​	Yarn 缓存了每个下载过的包，所以再次使用时无需重复下载。 同时利用并行下载以最大化资源利用率，因此安装速度更快，在执行代码之前，Yarn 会通过算法校验每个安装包的完整性，使用详细、简洁的锁文件格式和明确的安装算法，Yarn 能够保证在不同系统上无差异的工作。</p>
<h5 id="yarn安装"><a class="markdownIt-Anchor" href="#yarn安装">#</a> yarn 安装:</h5>
<p>首先需要 node.js &amp; npm 环境<br>
输入命令： npm install -g yarn<br>
 查看版本：yarn -V &amp; --version</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Yarn 淘宝源安装，分别复制粘贴以下代码行到黑窗口运行即可</span><br><span class="line">yarn config set registry https://registry.npm.taobao.org -g</span><br><span class="line">yarn config set sass_binary_site http://cdn.npm.taobao.org/dist/node-sass -g</span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">yarn的常用命令：</span><br><span class="line">安装yarn：npm install -g yarn</span><br><span class="line">安装成功后，查看版本号：yarn --version</span><br><span class="line">创建文件夹 ：md yarn</span><br><span class="line">进入yarn文件夹：cd yarn</span><br><span class="line">初始化项目：yarn init <span class="comment">// 同npm init，执行输入信息后，会生成package.json文件</span></span><br><span class="line"></span><br><span class="line">yarn的配置项：</span><br><span class="line">yarn config list <span class="comment">// 显示所有配置项</span></span><br><span class="line">yarn config get &lt;key&gt; <span class="comment">//显示某配置项</span></span><br><span class="line">yarn config delete &lt;key&gt; <span class="comment">//删除某配置项</span></span><br><span class="line">yarn config set &lt;key&gt; &lt;value&gt; <span class="punctuation">[</span>-g|--global<span class="punctuation">]</span> <span class="comment">//设置配置项</span></span><br><span class="line"></span><br><span class="line">安装包：</span><br><span class="line">yarn install <span class="comment">//安装package.json里所有包，并将包及它的所有依赖项保存进yarn.lock</span></span><br><span class="line">yarn install --flat <span class="comment">//安装一个包的单一版本</span></span><br><span class="line">yarn install --force <span class="comment">//强制重新下载所有包</span></span><br><span class="line">yarn install --production <span class="comment">//只安装dependencies里的包</span></span><br><span class="line">yarn install --no-lockfile <span class="comment">//不读取或生成yarn.lock</span></span><br><span class="line">yarn install --pure-lockfile <span class="comment">//不生成yarn.lock</span></span><br><span class="line"></span><br><span class="line">添加包（会更新package.json和yarn.lock）：</span><br><span class="line">yarn add <span class="punctuation">[</span>package<span class="punctuation">]</span> <span class="comment">// 在当前的项目中添加一个依赖包，会自动更新到package.json和yarn.lock文件中</span></span><br><span class="line">yarn add <span class="punctuation">[</span>package<span class="punctuation">]</span>@<span class="punctuation">[</span>version<span class="punctuation">]</span> <span class="comment">// 安装指定版本，这里指的是主要版本，如果需要精确到小版本，使用-E参数</span></span><br><span class="line">yarn add <span class="punctuation">[</span>package<span class="punctuation">]</span>@<span class="punctuation">[</span>tag<span class="punctuation">]</span> <span class="comment">// 安装某个tag（比如beta,next或者latest）</span></span><br><span class="line"><span class="comment">//不指定依赖类型默认安装到dependencies里，你也可以指定依赖类型：</span></span><br><span class="line"></span><br><span class="line">yarn add --dev/-D <span class="comment">// 加到 devDependencies</span></span><br><span class="line">yarn add --peer/-P <span class="comment">// 加到 peerDependencies</span></span><br><span class="line">yarn add --optional/-O <span class="comment">// 加到 optionalDependencies</span></span><br><span class="line"><span class="comment">//默认安装包的主要版本里的最新版本，下面两个命令可以指定版本：</span></span><br><span class="line"></span><br><span class="line">yarn add --exact/-E <span class="comment">// 安装包的精确版本。例如yarn add foo@1.2.3会接受1.9.1版，但是yarn add foo@1.2.3 --exact只会接受1.2.3版</span></span><br><span class="line">yarn add --tilde/-T <span class="comment">// 安装包的次要版本里的最新版。例如yarn add foo@1.2.3 --tilde会接受1.2.9，但不接受1.3.0</span></span><br><span class="line"></span><br><span class="line">发布包</span><br><span class="line">yarn publish</span><br><span class="line"></span><br><span class="line">移除一个包</span><br><span class="line">yarn remove &lt;packageName&gt;：移除一个包，会自动更新package.json和yarn.lock</span><br><span class="line"></span><br><span class="line">更新一个依赖</span><br><span class="line">yarn upgrade 用于更新包到基于规范范围的最新版本</span><br><span class="line"></span><br><span class="line">运行脚本</span><br><span class="line">yarn run 用来执行在 package.json 中 scripts 属性下定义的脚本</span><br><span class="line"></span><br><span class="line">显示某个包的信息</span><br><span class="line">yarn info &lt;packageName&gt; 可以用来查看某个模块的最新版本信息</span><br><span class="line"></span><br><span class="line">缓存</span><br><span class="line">yarn cache</span><br><span class="line">yarn cache list # 列出已缓存的每个包 yarn cache dir # 返回 全局缓存位置 yarn cache clean # 清除缓存</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="关于我"><a class="markdownIt-Anchor" href="#关于我">#</a> 关于我</h2>
<p>Brath 是一个热爱技术的 Java 程序猿，公众号「InterviewCoder」定期分享有趣有料的精品原创文章！</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E4%BA%8C%E7%BB%B4%E7%A0%81plus.png" alt="InterviewCoder"></p>
<p>非常感谢各位人才能看到这里，原创不易，文章如果有帮助可以关注、点赞、分享或评论，这都是对我的莫大支持！</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-04-26T01:40:26.716Z" title="2023/4/26 09:40:26">2023-04-26</time>发表</span><span class="level-item"><time dateTime="2023-05-09T07:26:21.000Z" title="2023/5/9 15:26:21">2023-05-09</time>更新</span><span class="level-item">10 分钟读完 (大约1531个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/04/26/%E3%80%90Gmail%E3%80%91%E5%9B%BD%E5%86%85%E6%80%8E%E4%B9%88%E6%B3%A8%E5%86%8CGmail%E9%82%AE%E7%AE%B1%EF%BC%9F/">【Gmail】国内怎么注册Gmail邮箱？</a></p><div class="content"><h1 id="gmail国内怎么注册gmail邮箱"><a class="markdownIt-Anchor" href="#gmail国内怎么注册gmail邮箱">#</a> 【Gmail】国内怎么注册 Gmail 邮箱？</h1>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png" alt="InterviewCoder"></p>
<p>​		谷歌邮箱（Gmail）是在国际上使用最为频繁的邮箱，不管我们是用来收发邮件，还是用来注册国外的网站，大多数情况下都离不开谷歌邮箱。甚至，不少网站都直接支持谷歌邮箱登录，这就是为什么，国内很多网友想要注册 Gmail 谷歌邮箱的原因。</p>
<p>​		但是，大部分网友都无法自己完整注册，今天来做一篇完整的谷歌邮箱注册教程，非常详细，一步一步照做即可！</p>
<p>​	<img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/4817a9d47027589.jpg" alt="img"></p>
<h2 id="谷歌邮箱怎么注册"><a class="markdownIt-Anchor" href="#谷歌邮箱怎么注册">#</a> 谷歌邮箱怎么注册？</h2>
<h4 id="注册前准备"><a class="markdownIt-Anchor" href="#注册前准备">#</a> 注册前准备</h4>
<p>1、手机号码一个（没有注册过谷歌邮箱的手机号码）</p>
<p>2、加速器（魔法）（国内使用谷歌，必须要加速器才行哦，加速器需自备，不然你会连谷歌邮箱官网都无法进入）</p>
<h4 id="谷歌gmail邮箱注册教程"><a class="markdownIt-Anchor" href="#谷歌gmail邮箱注册教程">#</a> 谷歌 Gmail 邮箱注册教程</h4>
<p>1、我们使用浏览器打开谷歌邮箱官网（<a target="_blank" rel="noopener" href="http://gmail.google.com">gmail.google.com</a>），进入谷歌邮箱的登录主页，我们点击左下方的创建账号按钮，选择个人用途。</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/image-20230420135757242.png" alt="image-20230420135757242"></p>
<p>2、在进入的界面我们不要着急填写资料，我们先修改语言，点击左下方的简体中文。</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/c81e728d9d4c2f6-30.jpg" alt="img"></p>
<p>3、这个时候，会弹出国家语言列表，我们选择 “English（United States）”。</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/eccbc87e4b5ce2f-25.jpg" alt="img"></p>
<p>4、这个时候，界面会变成英语。我们在填写个人信息，如下图填写。填好过后，我们要记住账号和密码信息哦，后面登录要用的。</p>
<p><a target="_blank" rel="noopener" href="https://blog.aftss.cn/wp-content/uploads/2022/09/a87ff679a2f3e71-20.jpg"><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/a87ff679a2f3e71-20.jpg" alt="img"></a></p>
<p>5、这个时候，会跳转到手机号码验证页面，我们选择中国 + 86，填写自己的手机号，点击 Next。如果顺利，你会进入下一步，填写验证码。如果你的加速器美国 IP 质量不行，这里就会提示你 “此电话号码无法用于验证”。遇到这个提示，建议，切换一个优质美国 IP，在操作。</p>
<p><a target="_blank" rel="noopener" href="https://blog.aftss.cn/wp-content/uploads/2022/09/e4da3b7fbbce234-21.jpg"><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/e4da3b7fbbce234-21.jpg" alt="img"></a></p>
<p>6、输入手机收到的验证码，点击 “verify”。</p>
<p><a target="_blank" rel="noopener" href="https://blog.aftss.cn/wp-content/uploads/2022/09/1679091c5a880fa-18.jpg"><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/1679091c5a880fa-18.jpg" alt="img"></a></p>
<p>7、这个界面，我们只需要填写出生日期即可，别的可不填。出生日期，大家一定要选择成年的年龄哦，别乱填，填好点 next。</p>
<p><a target="_blank" rel="noopener" href="https://blog.aftss.cn/wp-content/uploads/2022/09/8f14e45fceea167-16.jpg"><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/8f14e45fceea167-16.jpg" alt="img"></a></p>
<p>8、来到这个界面，我们不用管，直接点击 skip。</p>
<p><a target="_blank" rel="noopener" href="https://blog.aftss.cn/wp-content/uploads/2022/09/c9f0f895fb98ab9-11.jpg"><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/c9f0f895fb98ab9-11.jpg" alt="img"></a></p>
<p>9、隐私条款确认，我们点击 I agree。</p>
<p><a target="_blank" rel="noopener" href="https://blog.aftss.cn/wp-content/uploads/2022/09/45c48cce2e2d7fb-7.jpg"><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/45c48cce2e2d7fb-7.jpg" alt="img"></a></p>
<p>这个时候，你会发现，账号注册成功了，并且，页面会直接跳转到谷歌邮箱的界面。</p>
<h2 id="注册失败原因汇总"><a class="markdownIt-Anchor" href="#注册失败原因汇总">#</a> 注册失败原因汇总</h2>
<p>其实注册流程并不复杂，很简单，也就只需要几步。可是，国内的网友注册，总是无法注册成功。这里，把最容易导致注册失败的原因，给大家汇总一下，自己操作的时候就要注意了！</p>
<h3 id="1-手机号码注册过"><a class="markdownIt-Anchor" href="#1-手机号码注册过">#</a> 1、手机号码注册过</h3>
<p>你用来注册谷歌邮箱的手机号码，你自己之前注册过谷歌邮箱，再次注册有可能会出现无法注册的情况。虽然，谷歌没有说明一个手机能够不能注册多个账号，但是，我们最好还是不要用注册过的手机号。</p>
<h3 id="2-加速器ip质量不行"><a class="markdownIt-Anchor" href="#2-加速器ip质量不行">#</a> 2、加速器 IP 质量不行</h3>
<p>很多网友使用的加速器，IP 地址已经被人多次用来注册过谷歌邮箱了，到你注册的时候，早就被谷歌锁定了，识别你为恶意注册。这种情况，自然无法成功注册。那么，怎么才算高质量的 IP 地址呢？我们尽量使用那些没怎么被人用过的 IP，冷僻的线路即可。</p>
<h3 id="3-语言没设置"><a class="markdownIt-Anchor" href="#3-语言没设置">#</a> 3、语言没设置</h3>
<p>大家看教程，应该知道，我注册的时候是设置了英语的。再加上使用的 IP 为美国，这样自然，谷歌会认为我是一个美国人在注册，审核机制自然就成了美区的审核机制，没那么严格，成功率会高一些。</p>
<h3 id="4-如果以上都不行那么建议使用-iphone-手机注册一下试试很大几率可以成功"><a class="markdownIt-Anchor" href="#4-如果以上都不行那么建议使用-iphone-手机注册一下试试很大几率可以成功">#</a> 4、如果以上都不行，那么建议使用 IPHONE 手机注册一下试试，很大几率可以成功！</h3>
<h2 id="关于我"><a class="markdownIt-Anchor" href="#关于我">#</a> 关于我</h2>
<p>Brath 是一个热爱技术的 <code>Java</code>  程序猿，公众号「InterviewCoder」定期分享有趣有料的精品原创文章！</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fa31569d28cd4d5baa3a7168d4021f37~tplv-k3u1fbpfcp-zoom-1.image" alt="图片"></p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E4%BA%8C%E7%BB%B4%E7%A0%81plus.png" alt="InterviewCoder"> 非常感谢各位人才能看到这里，原创不易，文章如果有帮助可以关注、点赞、分享或评论，这都是对我的莫大支持！</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-04-26T01:40:26.713Z" title="2023/4/26 09:40:26">2023-04-26</time>发表</span><span class="level-item"><time dateTime="2023-05-07T16:04:42.000Z" title="2023/5/8 00:04:42">2023-05-08</time>更新</span><span class="level-item">2 分钟读完 (大约246个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/04/26/%E3%80%90Docker%E3%80%91Docker%E7%8E%AF%E5%A2%83%E4%B8%8B%E5%AE%89%E8%A3%85vim/">Docker环境下安装vim</a></p><div class="content"><p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png" alt="InterviewCoder"></p>
<h2 id="docker环境下安装vim"><a class="markdownIt-Anchor" href="#docker环境下安装vim">#</a> Docker 环境下安装 vim</h2>
<p>在使用 docker 容器时，容器一般没有安装 vim，就需要安装 vim<br>
apt-get install vim 命令用于安装 vim，但是下载过慢。<br>
第一步 配置国内镜像源<br>
进入某个容器</p>
<p>例如进入 mysql</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it mysql /bin/bash</span><br></pre></td></tr></table></figure>
<p>第二步：更新源</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt update</span><br></pre></td></tr></table></figure>
<p>第三步安装 vim</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install vim</span><br></pre></td></tr></table></figure>
<h2 id="关于我"><a class="markdownIt-Anchor" href="#关于我">#</a> 关于我</h2>
<p>Brath 是一个热爱技术的 Java 程序猿，公众号「InterviewCoder」定期分享有趣有料的精品原创文章！</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E4%BA%8C%E7%BB%B4%E7%A0%81plus.png" alt="InterviewCoder"></p>
<p>非常感谢各位人才能看到这里，原创不易，文章如果有帮助可以关注、点赞、分享或评论，这都是对我的莫大支持！</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-04-26T01:40:26.710Z" title="2023/4/26 09:40:26">2023-04-26</time>发表</span><span class="level-item"><time dateTime="2023-04-26T01:40:16.692Z" title="2023/4/26 09:40:16">2023-04-26</time>更新</span><span class="level-item">29 分钟读完 (大约4379个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/04/26/%E3%80%90DDD%E3%80%91DDD%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84%E4%B8%8E%E4%BC%A0%E7%BB%9F%E4%B8%89%E5%B1%82%E6%9E%B6%E6%9E%84%E7%9A%84%E5%8C%BA%E5%88%AB/">【DDD】DDD分层架构与传统三层架构的区别</a></p><div class="content"><p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png" alt="InterviewCoder"></p>
<h1 id="dddddd分层架构与传统三层架构的区别"><a class="markdownIt-Anchor" href="#dddddd分层架构与传统三层架构的区别">#</a> 【DDD】DDD 分层架构与传统三层架构的区别</h1>
<h3 id="文章目录"><a class="markdownIt-Anchor" href="#文章目录">#</a> 文章目录</h3>
<ul>
<li>
<ul>
<li><a href="#DDD_1">DDD 分层与传统三层区别</a></li>
<li><a href="#DDD_16">DDD 分层详解</a></li>
<li>
<ul>
<li><a href="#_17">四层架构图</a></li>
<li><a href="#_24">分层作用</a></li>
<li><a href="#_31">领域对象</a></li>
</ul>
</li>
<li><a href="#DDD_44">DDD 编码实践（改进分层）</a></li>
<li>
<ul>
<li><a href="#_53">代码结构描述</a></li>
<li><a href="#_115">扩展定义注解和接口声明</a></li>
<li><a href="#_135">领域模型注入仓储类的问题</a></li>
</ul>
</li>
<li><a href="#_235">一些个人思考…</a></li>
<li>
<ul>
<li><a href="#DDD_242">项目按上述经典四层架构进行搭建，可以说是 DDD 架构实践么？</a></li>
<li><a href="#SpringDDD_251">题外话：Spring 与 DDD</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="ddd分层与传统三层区别"><a class="markdownIt-Anchor" href="#ddd分层与传统三层区别">#</a> DDD 分层与传统三层区别</h2>
<p>根据 DDD 领域驱动设计原则，对应的软件架构也需要做出相应的调整。<br>
我们常用的<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E4%B8%89%E5%B1%82%E6%9E%B6%E6%9E%84&amp;spm=1001.2101.3001.7020">三层架构</a>模型划分为表现层，业务逻辑层，数据访问层等，在 <code>DDD</code>  分层结构中既有联系又有区别，<br>
个人认为主要有如下异同：</p>
<ul>
<li>在架构设计上，在 <code>DDD</code>  分层结构中将传统三层架构的业务逻辑层拆解为应用层和领域层<br>
其中 Application 划分为很薄的一层服务，非核心的逻辑放到此层去实现，核心的业务逻辑表现下沉到领域层去实现，凝练为更为精确的业务规则集合，通过领域对象去阐述说明。<br>
<img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/20200110163924602.png" alt="与传统三层区别"></li>
<li>在建模方式上， <code>DDD</code>  分层的建模思维方式有别于传统三层<br>
传统三层通常是以数据库为起点进行数据库分析设计，而 <code>DDD</code>  则需要以业务<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E9%A2%86%E5%9F%9F%E6%A8%A1%E5%9E%8B&amp;spm=1001.2101.3001.7020">领域模型</a>为核心建模（即面向对象建模方式），更能体现对现实世界的抽象。<br>
故<strong>在 DDD 分层凸显领域层的重要作用，领域层为系统的核心，包括所有的业务领域模型的抽象表达</strong>。</li>
<li>在职责划分上，基础设施层涵盖了 2 方面内容
<ul>
<li>持久化功能，其中原三层架构的数据访问层下沉到基础设施层的持久化机制实现</li>
<li>通用技术支持，一些公共通用技术支持也放到基础设施层去实现。</li>
</ul>
</li>
</ul>
<h2 id="ddd分层详解"><a class="markdownIt-Anchor" href="#ddd分层详解">#</a> DDD 分层详解</h2>
<h3 id="四层架构图"><a class="markdownIt-Anchor" href="#四层架构图">#</a> 四层架构图</h3>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/20200110164305632.png" alt="在这里插入图片描述"></p>
<p>在该架构中，上层模块可以调用下层模块，反之不行。即</p>
<ul>
<li><code>Interface</code>  ——&gt;  <code>application</code>  |  <code>domain</code>  |  <code>infrastructure</code></li>
<li><code>application </code> ——&gt; <code> domain</code>  |  <code>infrastructure</code></li>
<li><code>domain</code>  ——&gt; <code> infrastructure</code></li>
</ul>
<h3 id="分层作用"><a class="markdownIt-Anchor" href="#分层作用">#</a> 分层作用</h3>
<table>
<thead>
<tr>
<th>分层</th>
<th>英文</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>表现层</td>
<td><code>User Interface</code></td>
<td>用户界面层，或者表现层，负责向用户显示解释用户命令</td>
</tr>
<tr>
<td>应用层</td>
<td><code>Application Layer</code></td>
<td>定义软件要完成的任务，并且指挥协调领域对象进行不同的操作。该层不包含业务领域知识。</td>
</tr>
<tr>
<td>领域层</td>
<td><code>Domain Layer</code></td>
<td>或称为模型层，系统的核心，负责表达业务概念，业务状态信息以及业务规则。即包含了该领域（问题域）所有复杂的业务知识抽象和规则定义。该层主要精力要放在领域对象分析上，可以从实体，值对象，聚合（聚合根），领域服务，领域事件，仓储，工厂等方面入手</td>
</tr>
<tr>
<td>基础设施层</td>
<td><code>Infrastructure Layer</code></td>
<td>主要有 2 方面内容，一是为领域模型提供持久化机制，当软件需要持久化能力时候才需要进行规划；一是对其他层提供通用的技术支持能力，如消息通信，通用工具，配置等的实现；</td>
</tr>
</tbody>
</table>
<h3 id="领域对象"><a class="markdownIt-Anchor" href="#领域对象">#</a> 领域对象</h3>
<p>根据战术设计，关注的领域对象主要包括有</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>英文</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>值对象</td>
<td><code>value object</code></td>
<td>无唯一标识的简单对象</td>
</tr>
<tr>
<td>实体</td>
<td><code>entity</code></td>
<td>充血的领域模型，有唯一标识</td>
</tr>
<tr>
<td>聚合（聚合根）</td>
<td><code>aggregate</code></td>
<td>实体的聚合，拥有聚合根，可为某一个实体</td>
</tr>
<tr>
<td>领域服务</td>
<td><code>service</code></td>
<td>无法归类到某个具体领域模型的行为</td>
</tr>
<tr>
<td>领域事件</td>
<td><code>event</code></td>
<td>不常用</td>
</tr>
<tr>
<td>仓储</td>
<td><code>repository</code></td>
<td>持久化相关，与基础设施层关联</td>
</tr>
<tr>
<td>工厂</td>
<td><code>factory</code></td>
<td>负责复杂对象创建</td>
</tr>
<tr>
<td>模块</td>
<td><code>module</code></td>
<td>子模块引入，可以理解为子域划分</td>
</tr>
</tbody>
</table>
<h2 id="ddd编码实践改进分层"><a class="markdownIt-Anchor" href="#ddd编码实践改进分层">#</a> DDD 编码实践（改进分层）</h2>
<p>本文在对上述的传统四层的实践中，（1）根据 <code>依赖倒置原则</code> 对分层结构进行了改进，通过改变不同层的依赖关系（即将基础设施层倒置）来改进具体实现与抽象之间关系；（2）在基础设施层中增加 <code>引用适配层</code> （防腐层）来增强防御策略，用来统一封装外部系统接口的引用。改进的分层结构如下：<br>
<img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/74de60360d744758993b3ba54ac20370.png" alt="在这里插入图片描述"></p>
<blockquote>
<p>依赖倒置原则（DIP）：</p>
<ul>
<li>高层模块不依赖于低层模块，两者都依赖于抽象；</li>
<li>抽象不应该依赖于细节，细节应依赖抽象</li>
</ul>
</blockquote>
<h3 id="代码结构描述"><a class="markdownIt-Anchor" href="#代码结构描述">#</a> 代码结构描述</h3>
<p><code>eg.</code>  后端 Java 代码工程为例，<br>
 <code>表现层</code> 在此代码结构中表现为 <code>api层</code> ，对外暴露接口的最上层</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">├─com.company.microservice</span><br><span class="line">├─com.company.microservice</span><br><span class="line">│    │ </span><br><span class="line">│    ├─apis   API接口层 </span><br><span class="line">│    │    └─controller       控制器，对外提供（Restful）接口</span><br><span class="line">│    │ </span><br><span class="line">│    ├─application           应用层</span><br><span class="line">│    │    ├─model            数据传输对象模型及其装配器（含校验）</span><br><span class="line">│    │    │    ├─assembler   装配器,，实现模型转换eg. apiModel&lt;=&gt; domainModel</span><br><span class="line">│    │    │    └─dto         模型定义（含校验规则）      </span><br><span class="line">│    │    ├─service          应用服务，非核心服务，跨领域的协作、复杂分页查询等</span><br><span class="line">│    │    ├─task             任务定义，协调领域模型</span><br><span class="line">│    │    ├─listener         事件监听定义</span><br><span class="line">│    │    └─***              others</span><br><span class="line">│    │ </span><br><span class="line">│    ├─domain   领域层</span><br><span class="line">│    │    ├─common           模块<span class="number">0</span>-公共代码抽取，限于领域层有效  </span><br><span class="line">│    │    ├─<span class="keyword">module</span>-xxx       模块<span class="number">1</span>-xxx，领域划分的模块，可理解为子域划分     </span><br><span class="line">│    │    ├─<span class="keyword">module</span>-user      模块<span class="number">2</span>-用户子域（领域划分的模块，可理解为子域划分）</span><br><span class="line">│    │    │    ├─action      行为定义</span><br><span class="line">│    │    │    │    ├─UserDomainService.java        领域服务,用户领域服务</span><br><span class="line">│    │    │    │    ├─UserPermissionChecker.java    其他行为，用户权限检查器</span><br><span class="line">│    │    │    │    ├─WhenUserCreatedEventPublisher.java     领域事件，当用户创建完成时的事件 </span><br><span class="line">│    │    │    ├─model       领域聚合内模型 </span><br><span class="line">│    │    │    │    ├─UserEntity.java                领域实体，有唯一标识的充血模型，如本身的CRUD操作在此处</span><br><span class="line">│    │    │    │    ├─UserDictVObj.java              领域值对象，用户字典kv定义       </span><br><span class="line">│    │    │    |    ├─UserDPO.java                   领域负载对象    </span><br><span class="line">│    │    │    ├─repostiory  领域仓储接口</span><br><span class="line">│    │    │    │    ├─UserRepository.java</span><br><span class="line">│    │    │    ├─reference   领域适配接口</span><br><span class="line">│    │    │    │    ├─UserEmailSenderFacade.java</span><br><span class="line">│    │    │    └─factory     领域工厂  </span><br><span class="line">│    │ </span><br><span class="line">│    ├─infrastructure  基础设施层</span><br><span class="line">│    │    ├─persistence      持久化机制</span><br><span class="line">│    │    │    ├─converter   持久化模型转换器</span><br><span class="line">│    │    │    ├─po          持久化对象定义 </span><br><span class="line">│    │    │    └─repository.impl  仓储类，持久化接口&amp;实现，可与ORM映射框架结合</span><br><span class="line">│    │    ├─general          通用技术支持，向其他层输出通用服务</span><br><span class="line">│    │    │    ├─config      配置类</span><br><span class="line">│    │    │    ├─toolkit     工具类  </span><br><span class="line">│    │    │    ├─extension   扩展定义  </span><br><span class="line">│    │    │    └─common      基础公共模块等 </span><br><span class="line">│    │    ├─reference        引用层，包装外部接口用，防止穿插到Domain层腐化领域模型等</span><br><span class="line">│    │    │    ├─dto         传输模型定义</span><br><span class="line">│    │    │    ├─converter   传输模型转换器       </span><br><span class="line">│    │    │    └─facade.impl 适配器具体实现，此处的RPC、Http等调用</span><br><span class="line">│    │ </span><br><span class="line">│    └─resources  </span><br><span class="line">│        ├─statics  静态资源</span><br><span class="line">│        ├─template 系统页面 </span><br><span class="line">│        └─application.yml   全局配置文件</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>其中在上述目录结构中，Domain 层中为对 <code>module</code>  进行划分，实际上默认该层只有一个模块，根据微服务划分可以进行增加模块来规范代码结构。<br>
示例代码工程：</p>
<p>GITHUB 地址：<a target="_blank" rel="noopener" href="https://github.com/smingjie/bbq-ddd.git">https://github.com/smingjie/bbq-ddd.git</a></p>
<h3 id="扩展定义注解和接口声明"><a class="markdownIt-Anchor" href="#扩展定义注解和接口声明">#</a> 扩展定义注解和接口声明</h3>
<p>（1） <code>自定义注解</code> ：在使用 DDD 中自定义了标记的注解 (@DDDAnnotation) 和其衍生子注解，分别是</p>
<ul>
<li><code>@DomainAggregate</code></li>
<li><code>@DomainAggregateRoot</code></li>
<li><code>@DomainEntity</code></li>
<li><code>@DomainValueObject</code></li>
<li><code>@DomainService</code></li>
<li><code>@DomainRepository</code></li>
<li><code>@DomainEvent</code></li>
<li><code>@ApplicationService</code></li>
<li><code>@DomainAssembler</code></li>
<li><code>@DomainConverter</code></li>
</ul>
<p>等注解，详见代码的 infrastructure.general.extension.ddd.annotation.**；其中有些注解继承了 spring 的  <code>@Component</code> , 将会自动注册为 spring bean，有些注解为了标记用于后续扩展；</p>
<p>引入了 Assembler 装配器 / Converter 转换器，通过组合模式解耦继承关系，在 api 层和持久化层都有相应的实现。</p>
<p>（2） <code>自定义接口</code> ：在 domain.common 定义了部分通用的 <code>契约</code> 接口，如领域对象元数据获取接口  <code>IDomainMetaData</code> ，通过接口解耦继承关系。其他还有：  <code>IDomainSaveOrUpdate</code>   <code>IDomainDelete</code>   <code>...</code>  等 Command</p>
<h3 id="领域模型注入仓储类的问题"><a class="markdownIt-Anchor" href="#领域模型注入仓储类的问题">#</a> 领域模型注入仓储类的问题</h3>
<p>区别于传统的分层后，在 domain 中更多关注业务逻辑，考虑到要与 spring 框架集成，需要注意一个领域模型中注入仓储类的问题</p>
<blockquote>
<p>在传统分层中，controller，service，repo 均注册为 spring 管理的 bean，<br>
但是在 domain 层中，service 一部分的业务逻辑划分到了具体的领域对象中去实现了，显然这些对象却不能注册为单例 bean，<br>
因此在此处不能沿用与原来分层结构中 service 层中通过 <code>@Autowired</code>  or  <code>@Resource</code>  等注入仓储接口，</p>
</blockquote>
<p><strong>关于这个问题，此处建议使用 <code>ApplicationContext</code>  实现</strong></p>
<blockquote>
<p>即通过一个工具类  <code>ApplicationContextUtils</code>  实现  <code>ApplicationContextAware</code>  获取 bean 的方法，即  <code>getBean()</code>  方法，<br>
然后我们就可以在我们的领域模型中直接应用该工具类来获取 Spring 托管的 singleton 对象，即<br>
 xxxRepo=ApplicationContextUtils.getBean (“xxxRepository”)</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApplicationContextUtils</span> <span class="keyword">implements</span> <span class="title class_">ApplicationContextAware</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ApplicationContext appctx;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setApplicationContext</span><span class="params">(ApplicationContext applicationContext)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        ApplicationContextUtil.appctx=applicationContext;</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ApplicationContext</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ApplicationContext <span class="title function_">getApplicationContext</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> appctx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取对象</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name spring配置文件中配置的bean名或注解的名称</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 一个以所给名字注册的bean的实例</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> BeansException 抛出spring异常</span></span><br><span class="line"><span class="comment">     */</span> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">getBean</span><span class="params">(String name)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        <span class="keyword">return</span> (T) appctx.getBean(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取类型为requiredType的对象</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> clazz 需要获取的bean的类型</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 该类型的一个在ioc容器中的bean</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> BeansException 抛出spring异常</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">getBean</span><span class="params">(Class&lt;T&gt; clazz)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        <span class="keyword">return</span> appctx.getBean(clazz);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 如果ioc容器中包含一个与所给名称匹配的bean定义，则返回true否则返回false</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name ioc容器中注册的bean名称</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 存在返回true否则返回false</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">containsBean</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> appctx.containsBean(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>考虑到代码结构简洁性，还可以封装一层仓储工厂，只用来获取相应的仓储 <code>Bean</code>  。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 简化版的仓储工厂--用来统一获取仓储的实现Bean</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> jockeys</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/9/12</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RepoFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据仓储接口类型获取对应实现且默认取值第一个</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> tClass 具体目标类型</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> &lt;T&gt;    仓储接口类型</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> 如果不是指定实现，默认获得第一个实现Bean</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">get</span><span class="params">(Class&lt;? extends T&gt; tClass)</span> &#123;</span><br><span class="line"></span><br><span class="line">		Map&lt;String, ? <span class="keyword">extends</span> <span class="title class_">T</span>&gt; map = ApplicationUtils.getApplicationContext().getBeansOfType(tClass);</span><br><span class="line">		Collection&lt;? <span class="keyword">extends</span> <span class="title class_">T</span>&gt; collection = map.values();</span><br><span class="line">		<span class="keyword">if</span> (collection.isEmpty()) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">PersistException</span>(<span class="string">&quot;未找到仓储接口或其指定的实现:&quot;</span> + tClass.getSimpleName() );</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> collection.stream().findFirst().get();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后在领域模型中就可以直接调用该工厂方法来获取仓储接口的实现，<br>
比如 <code>DictRepo</code>  为定义的仓储接口， <code>DictDao</code>  为该接口的准实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//直接指定实现</span></span><br><span class="line">DictRepo repo= RepoFactory.get(DictDao.class);</span><br><span class="line"><span class="comment">//不指定实现取Spring容器中默认注册第1位的Bean</span></span><br><span class="line">DictRepo repo= RepoFactory.get(DictRepo.class);</span><br></pre></td></tr></table></figure>
<h2 id="一些个人思考"><a class="markdownIt-Anchor" href="#一些个人思考">#</a> 一些个人思考…</h2>
<p>上述经典四层架构，笔者更愿意理解为 DDD 在编码实现阶段的一个体现或应用。</p>
<blockquote>
<p>补充一点：DDD 除了在编码实践阶段，还体现在需求分析、设计阶段等过程，DDD 推荐不割裂系统的需求和设计，我们这里可以合并称作系统建模过程，可参考 <a target="_blank" rel="noopener" href="https://blog.csdn.net/whos2016/article/details/103430565">DDD - 建模过程分析</a>一文，不再赘述。</p>
</blockquote>
<p>当然除了这个经典四层架构模型，DDD 还有五层架构、六边形架构等，所以这里抛出一个问题，</p>
<h3 id="项目按上述经典四层架构进行搭建可以说是ddd架构实践么"><a class="markdownIt-Anchor" href="#项目按上述经典四层架构进行搭建可以说是ddd架构实践么">#</a> 项目按上述经典四层架构进行搭建，可以说是 DDD 架构实践么？</h3>
<p>关于这个问题，笔者想引入一对哲学概念，哲学有言形式与内容，现象与本质等辩证关系（当然与本文可能也没啥太大关系啦）；从这两个角度来阐述本人的观点：</p>
<ul>
<li>
<p>形式与内容：经典四层架构是一个 DDD 实现的形式，相当于给我们提供了一个框框来让我们自己去实现；在这个框框里面我们怎么实现是自由发挥的，但也是有约束的，这个约束体现在 DDD 对每一层的作用的约定，如每个层约定做了什么功能，充当什么角色等。<strong>尤其是对 Domain 层的约定，才是最重要的</strong>。那么我们按照哲学辩证的套话来说，<em><strong>形式上满足了 DDD 架构，但这应该是片面的，具体还要看内容，即具体实现是怎样的。</strong></em></p>
</li>
<li>
<p>现象与本质：接着上述观点，如果要看实现，就要具体分析一下现象与本质嘞。上面笔者也有提到，DDD 除了四层经典架构，还有五层架构（包括其演化的多层架构）、六边形架构等也都是 DDD 提供的架构模型（形式），那这些都可以理解 DDD 架构模式的外显形式，那么又有哪些共性呢？可自行查询，本文直接给结论，即</p>
<p>它们都有 Domain 层，Domain 层，Domain 层</p>
<p>（重要的事情说三遍～～，该结论 DDD 作者译著有写到…），所以不管架构模式怎么演化，Domain 是核心不能变。</p>
<p>那么如上分析，我们在回到这个问题，我们是不是可以给出一个这样的答案：</p>
<blockquote>
<p>形式上符合 DDD 架构，具体是不是 DDD 的架构实践，本质上还要看</p>
<ul>
<li>（1）项目是否包括有 Domain 层；</li>
<li>（2）Domain 层是否满足 DDD 战术篇的要求（或者可暂时简单理解为充血模型吧）</li>
</ul>
</blockquote>
</li>
</ul>
<h3 id="题外话spring与ddd"><a class="markdownIt-Anchor" href="#题外话spring与ddd">#</a> 题外话：Spring 与 DDD</h3>
<ul>
<li>Spring 框架中，Spring 为我们提供了 <code>@Service</code>   <code>@Repository</code>  等注解，为我们分离行为和行为（注册为 Bean）和属性（数据模型），同时通过 <code>@Autowired</code>  在合适地方进行注入行为，因为行为被注册为 Spring 容器中的 Bean 后，减少了频繁创建行为的开销，只有属性的数据模型作为数据的载体来传递数据。提供很大的便捷性。但也阻碍了我们应用 DDD 编码实践， Spring 框架主张分离，DDD 思想主张合并，我们在 Spring 框架中使用 DDD 则需要在其基础上进行一些权衡取舍，即 <em><strong>如何将注册为 Bean 的行为穿插到原有的贫血模型中来构建充血模型是我们要解决的问题</strong></em></li>
<li>关于这个问题，笔者使用了 Spring 框架提供的<strong>获取容器内已经注册的 Bean 接口</strong>，直接调用接口，在有属性的领域模型中来获取行为；主要还是体现融入领域模型中的部分 Service 获取仓储接口来实现持久化过程。</li>
</ul>
<p>当然，上述的说明都是从一个软件开发人员的角度来阐述说明 DDD 在编码实践阶段的应用 。<br>
除此之外在业务领域的建模分析过程中也可引入该概念。<br>
比如我们现在所倡导的微服务化，如何划分或拆分微服务；如何有效地区分限界上下文，划分子域；如何构建一个有效的聚合，识别聚合根等。。。</p>
<ul>
<li>附在最后的，关于笔者对于 DDD 在需求设计阶段应用的学习总结</li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/whos2016/article/details/103430565">DDD - 建模分析过程</a></li>
</ul>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E4%BA%8C%E7%BB%B4%E7%A0%81plus.png" alt=""></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-04-26T01:40:26.708Z" title="2023/4/26 09:40:26">2023-04-26</time>发表</span><span class="level-item"><time dateTime="2023-04-26T01:40:10.738Z" title="2023/4/26 09:40:10">2023-04-26</time>更新</span><span class="level-item">26 分钟读完 (大约3850个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/04/26/%E3%80%90%E6%9E%B6%E6%9E%84%E3%80%91DDD%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%9E%8B/">【架构】DDD分层架构模型</a></p><div class="content"><p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png" alt="InterviewCoder"></p>
<h1 id="架构ddd分层架构模型"><a class="markdownIt-Anchor" href="#架构ddd分层架构模型">#</a> 【架构】DDD 分层架构模型</h1>
<p>还在单体应用的时候就是分层架构一说，我们用得最多的就是<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E4%B8%89%E5%B1%82%E6%9E%B6%E6%9E%84&amp;spm=1001.2101.3001.7020">三层架构</a>。而现在已经是微服务时代，在微服务架构模型比较常用的有几个，例如：整洁架构，CQRS（命令查询分离）以及六边形架构。每种架构模型都有自己的应用场景，但其核心都是 “<strong>高内聚低耦合</strong>” 原则。而运用领域驱动设计（DDD）理念以应对日常加速的业务变化对架构的影响，架构的边界越来越清晰，各司其职，这也符合<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%BE%AE%E6%9C%8D%E5%8A%A1&amp;spm=1001.2101.3001.7020">微服务</a>架构的设计思想。以领域驱动设计（DDD）为理念的分层架构已经成为微服务架构实践的最佳实践方法。</p>
<h1 id="一-什么是ddd分层架构"><a class="markdownIt-Anchor" href="#一-什么是ddd分层架构">#</a> 一、什么是 DDD 分层架构</h1>
<h1 id="1-传统三层架构"><a class="markdownIt-Anchor" href="#1-传统三层架构">#</a> 1. 传统三层架构</h1>
<p>要了解 DDD 分层架构，首先先了解传统的三层架构。</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/bc95fd968f658441bac8dde830d82d39.png" alt="DDD分层架构最佳实践"></p>
<p>传统三层架构流程：</p>
<ul>
<li>第一步考虑的是数据库设计，数据表如何建，表之间的关系如何设计</li>
<li>第二步就是搭建数据访问层，如选一个 ORM 框架或者拼接 SQL 操作</li>
<li>第三步就是业务逻辑的实现，由于我们先设计了数据库，我们整个的思考都会围绕着数据库，想着怎么写才能把数据正确地写入数据库中，这时 CRUD 的标准作法就出现了，也就没有太多考虑面向对象，解耦的事情了，这样的代码对日常的维护自然是越来越困难的</li>
<li>第四步表示层主要面向用户的输出</li>
</ul>
<h1 id="2-ddd分层架构"><a class="markdownIt-Anchor" href="#2-ddd分层架构">#</a> 2. DDD 分层架构</h1>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/0688f3781f073a93538b05557b6dbe22.png" alt="DDD分层架构最佳实践"></p>
<p>为了解决高耦合问题并轻松应对以后的系统变化，我们提出了运用领域驱动设计的理念来设计架构。</p>
<blockquote>
<p>此段落部分总结来源于欧创新《DDD 实践课》的《07 | DDD 分层架构：有效降低层与层之间的依赖》读后感</p>
</blockquote>
<h1 id="1领域层"><a class="markdownIt-Anchor" href="#1领域层">#</a> 1）领域层</h1>
<p>首先我们抛开数据库的困扰，<strong>先从业务逻辑入手开始</strong>，设计时不再考虑数据库的实现。将以前的业务逻辑层（BLL）拆分成了领域层和应用层。</p>
<p>领域层聚焦业务对象的业务逻辑实现，体现现实世界业务的逻辑变化。它用来表达业务概念、业务状态和业务规则，对于业务分析可参照：《使用领域驱动设计分析业务》</p>
<h1 id="2应用层"><a class="markdownIt-Anchor" href="#2应用层">#</a> 2）应用层</h1>
<p>应用层是领域层的上层，依赖领域层，是各聚合的协调和编排，原则上是不包括任何业务逻辑。它以较粗粒度的封闭为前端接口提供支持。除了提供上层调用外，还可以包括事件和消息的订阅。</p>
<h1 id="3-用户接口层"><a class="markdownIt-Anchor" href="#3-用户接口层">#</a> 3） 用户接口层</h1>
<p>用户接口层面向用户访问的数据入向接口，可按不同场景提供不一样的用户接口实现。面向 Web 的可使用 http restful 的方式提供服务，可增加安全认证、权限校验，日志记录等功能；面向微服务的可使用 RPC 方式提供服务，可增加限流、熔断等功能。</p>
<h1 id="4-基础设施层"><a class="markdownIt-Anchor" href="#4-基础设施层">#</a> 4） 基础设施层</h1>
<p>基础设施层是数据的出向接口，封装数据调用的技术细节。可为其它任意层提供服务，但为了解决耦合的问题采用了依赖倒置原则。其它层只依赖基础设施的接口，于具体实现进行分离。</p>
<h1 id="二-ddd分层代码实现"><a class="markdownIt-Anchor" href="#二-ddd分层代码实现">#</a> 二、DDD 分层代码实现</h1>
<h1 id="1-结构模型"><a class="markdownIt-Anchor" href="#1-结构模型">#</a> 1. 结构模型</h1>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/7ba92eeaedb20c360874015795e57354.png" alt="DDD分层架构最佳实践"></p>
<h1 id="2-目录结构"><a class="markdownIt-Anchor" href="#2-目录结构">#</a> 2. 目录结构</h1>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── pom.xml</span><br><span class="line">└── src</span><br><span class="line">    ├── main</span><br><span class="line">    │   ├── java</span><br><span class="line">    │   │   └── fun</span><br><span class="line">    │   │       └── barryhome</span><br><span class="line">    │   │           └── ddd</span><br><span class="line">    │   │               ├── WalletApplication.java</span><br><span class="line">    │   │               ├── application</span><br><span class="line">    │   │               │   ├── TradeEventProcessor.java</span><br><span class="line">    │   │               │   ├── TradeMQReceiver.java</span><br><span class="line">    │   │               │   └── TradeManager.java</span><br><span class="line">    │   │               ├── constant</span><br><span class="line">    │   │               │   └── MessageConstant.java</span><br><span class="line">    │   │               ├── controller</span><br><span class="line">    │   │               │   ├── TradeController.java</span><br><span class="line">    │   │               │   ├── WalletController.java</span><br><span class="line">    │   │               │   └── dto</span><br><span class="line">    │   │               │       └── TradeDTO.java</span><br><span class="line">    │   │               ├── domain</span><br><span class="line">    │   │               │   ├── TradeService.java</span><br><span class="line">    │   │               │   ├── TradeServiceImpl.java</span><br><span class="line">    │   │               │   ├── enums</span><br><span class="line">    │   │               │   │   ├── InOutFlag.java</span><br><span class="line">    │   │               │   │   ├── TradeStatus.java</span><br><span class="line">    │   │               │   │   ├── TradeType.java</span><br><span class="line">    │   │               │   │   └── WalletStatus.java</span><br><span class="line">    │   │               │   ├── event</span><br><span class="line">    │   │               │   │   └── TradeEvent.java</span><br><span class="line">    │   │               │   ├── model</span><br><span class="line">    │   │               │   │   ├── BaseEntity.java</span><br><span class="line">    │   │               │   │   ├── TradeRecord.java</span><br><span class="line">    │   │               │   │   └── Wallet.java</span><br><span class="line">    │   │               │   └── repository</span><br><span class="line">    │   │               │       ├── TradeRepository.java</span><br><span class="line">    │   │               │       └── WalletRepository.java</span><br><span class="line">    │   │               └── infrastructure</span><br><span class="line">    │   │                   ├── TradeRepositoryImpl.java</span><br><span class="line">    │   │                   ├── WalletRepositoryImpl.java</span><br><span class="line">    │   │                   ├── cache</span><br><span class="line">    │   │                   │   └── Redis.java</span><br><span class="line">    │   │                   ├── client</span><br><span class="line">    │   │                   │   ├── AuthFeignClient.java</span><br><span class="line">    │   │                   │   └── LocalAuthClient.java</span><br><span class="line">    │   │                   ├── jpa</span><br><span class="line">    │   │                   │   ├── JpaTradeRepository.java</span><br><span class="line">    │   │                   │   └── JpaWalletRepository.java</span><br><span class="line">    │   │                   └── mq</span><br><span class="line">    │   │                       └── RabbitMQSender.java</span><br><span class="line">    │   └── resources</span><br><span class="line">    │       ├── application.properties</span><br><span class="line">    │       └── rabbitmq-spring.xml</span><br><span class="line">    └── test</span><br><span class="line">        └── java</span><br></pre></td></tr></table></figure>
<p>此结构为单一微服务的简单结构，各层在同一个模块中。</p>
<p>在大型项目开发过程中，为了达到核心模块的权限控制或更好的灵活性可适当调整结构，可参考《 数字钱包系统》系统结构</p>
<h1 id="3-领域层实现domain"><a class="markdownIt-Anchor" href="#3-领域层实现domain">#</a> 3. 领域层实现（domain）</h1>
<p>在业务分析（《使用领域驱动设计分析业务》）之后，开始编写代码，首先就是写领域层，创建领域对象和领域服务接口</p>
<h1 id="1领域对象"><a class="markdownIt-Anchor" href="#1领域对象">#</a> 1）领域对象</h1>
<p>这里的领域对象包括实体对象、值对象。</p>
<p><strong>实体对象</strong>：具有唯一标识，能单独存在且可变化的对象</p>
<p><strong>值对象</strong>：不能单独存在或在逻辑层面单独存在无意义，且不可变化的对象</p>
<p><strong>聚合</strong>：多个对象的集合，对外是一个整体</p>
<p><strong>聚合根</strong>：聚合中可代表整个业务操作的实体对象，通过它提供对外访问操作，它维护聚合内部的数据一致性，它是聚合中对象的管理者</p>
<p>代码示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">// 交易</span><br><span class="line">public class TradeRecord extends BaseEntity &#123;</span><br><span class="line">    /**</span><br><span class="line">     * 交易号</span><br><span class="line">     */</span><br><span class="line">    @Column(unique = true)</span><br><span class="line">    private String tradeNumber;</span><br><span class="line">    /**</span><br><span class="line">     * 交易金额</span><br><span class="line">     */</span><br><span class="line">    private BigDecimal tradeAmount;</span><br><span class="line">    /**</span><br><span class="line">     * 交易类型</span><br><span class="line">     */</span><br><span class="line">    @Enumerated(EnumType.STRING)</span><br><span class="line">    private TradeType tradeType;</span><br><span class="line">    /**</span><br><span class="line">     * 交易余额</span><br><span class="line">     */</span><br><span class="line">    private BigDecimal balance;</span><br><span class="line">    /**</span><br><span class="line">     * 钱包</span><br><span class="line">     */</span><br><span class="line">    @ManyToOne</span><br><span class="line">    private Wallet wallet;</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 交易状态</span><br><span class="line">     */</span><br><span class="line">    @Enumerated(EnumType.STRING)</span><br><span class="line">    private TradeStatus tradeStatus;</span><br><span class="line"> </span><br><span class="line">  	@DomainEvents</span><br><span class="line">    public List&lt;Object&gt; domainEvents() &#123;</span><br><span class="line">        return Collections.singletonList(new TradeEvent(this));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">// 钱包</span><br><span class="line">public class Wallet extends BaseEntity &#123;</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 钱包ID</span><br><span class="line">     */</span><br><span class="line">    @Id</span><br><span class="line">    private String walletId;</span><br><span class="line">    /**</span><br><span class="line">     * 密码</span><br><span class="line">     */</span><br><span class="line">    private String password;</span><br><span class="line">    /**</span><br><span class="line">     * 状态</span><br><span class="line">     */</span><br><span class="line">    @Enumerated(EnumType.STRING)</span><br><span class="line">    private WalletStatus walletStatus = WalletStatus.AVAILABLE;</span><br><span class="line">    /**</span><br><span class="line">     * 用户Id</span><br><span class="line">     */</span><br><span class="line">    private Integer userId;</span><br><span class="line">    /**</span><br><span class="line">     * 余额</span><br><span class="line">     */</span><br><span class="line">    private BigDecimal balance = BigDecimal.ZERO;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>从<strong>钱包交易</strong>例子的系统设计中，钱包的任何操作如：充值、消息等都是通过交易对象驱动钱包余额的变化</li>
<li><strong>交易对象</strong>和<strong>钱包对象</strong>均为实体对象且组成聚合关系，<strong>交易对象</strong>是钱包交易业务模型的聚合根，代表聚合向外提供调用服务</li>
<li>经过分析<strong>交易对象</strong>与<strong>钱包对象</strong>为 1 对多关系（@ManyToOne），这里采用了 JPA 做<strong> ORM</strong> 架构，更多 JPA 实践请参考 &gt;&gt;</li>
<li>这里的领域建模使用的是贫血模型，结构简单，职责单一，相互隔离性好但缺乏面向对象设计思想，关于领域建模可参考《领域建模的贫血模型与充血模型》</li>
<li>domainEvents () 为领域事件发布的一种实现，作用是<strong>交易对象</strong>任何的数据操作都将触发事件的发布，再配合<strong>事件订阅</strong>实现<strong>事件驱动设计</strong>模型，当然也可以有别的实现方式</li>
</ul>
<h1 id="2领域服务"><a class="markdownIt-Anchor" href="#2领域服务">#</a> 2）领域服务</h1>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Created on 2020/9/7 11:40 上午</span><br><span class="line"> *</span><br><span class="line"> * @author barry</span><br><span class="line"> * Description: 交易服务</span><br><span class="line"> */</span><br><span class="line">public interface TradeService &#123;</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 充值</span><br><span class="line">     *</span><br><span class="line">     * @param tradeRecord</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    TradeRecord recharge(TradeRecord tradeRecord);</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 消费</span><br><span class="line">     *</span><br><span class="line">     * @param tradeRecord</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    TradeRecord consume(TradeRecord tradeRecord);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<p>先定义服务接口，接口的定义需要遵循<strong>现实业务的操作</strong>，切勿以程序逻辑或数据库逻辑来设计定义出增删改查</p>
<ul>
<li>主要的思考方向是交易对象对外可提供哪些服务，这种服务的定义是<strong>粗粒度</strong>且<strong>高内聚</strong>的，切勿将某些具体代码实现层面的方法定义出来</li>
<li>接口的输入输出参数尽量考虑以对象的形式，充分兼容各种场景变化</li>
<li>关于前端需要的复杂查询方法可不在此定义，一般情况下查询并非是一种领域服务且没有数据变化，可单独处理</li>
<li>领域服务的实现主要关注逻辑实现，切勿包含技术基础类代码，比如缓存实现，数据库实现，远程调用等</li>
</ul>
<h1 id="3基础设施接口"><a class="markdownIt-Anchor" href="#3基础设施接口">#</a> 3）基础设施接口</h1>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">public interface TradeRepository &#123;</span><br><span class="line">    /**</span><br><span class="line">     * 保存</span><br><span class="line">     * @param tradeRecord</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    TradeRecord save(TradeRecord tradeRecord);</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 查询订单</span><br><span class="line">     * @param tradeNumber</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    TradeRecord findByTradeNumber(String tradeNumber);</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 发送MQ事件消息</span><br><span class="line">     * @param tradeEvent</span><br><span class="line">     */</span><br><span class="line">    void sendMQEvent(TradeEvent tradeEvent);</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 获取所有</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    List&lt;TradeRecord&gt; findAll();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<ul>
<li>基础设施接口放在领域层主要的目的是减少领域层对基础设施层的依赖</li>
<li>接口的设计是不可暴露实现的技术细节，如不能将拼装的 SQL 作为参数</li>
</ul>
<h1 id="4-应用层实现application"><a class="markdownIt-Anchor" href="#4-应用层实现application">#</a> 4. 应用层实现（application）</h1>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">// 交易服务</span><br><span class="line">@Component</span><br><span class="line">public class TradeManager &#123;</span><br><span class="line"> </span><br><span class="line">    private final TradeService tradeService;</span><br><span class="line">    public TradeManager(TradeService tradeService) &#123;</span><br><span class="line">        this.tradeService = tradeService;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    // 充值</span><br><span class="line">    @Transactional(rollbackFor = Exception.class)</span><br><span class="line">    public TradeRecord recharge(TradeRecord tradeRecord) &#123;</span><br><span class="line">        return tradeService.recharge(tradeRecord);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">     // 消费</span><br><span class="line">    @Transactional(rollbackFor = Exception.class)</span><br><span class="line">    public TradeRecord consume(TradeRecord tradeRecord) &#123;</span><br><span class="line">        return tradeService.consume(tradeRecord);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">// 交易事件订阅</span><br><span class="line">@Component</span><br><span class="line">public class TradeEventProcessor &#123;</span><br><span class="line"> </span><br><span class="line">    @Autowired</span><br><span class="line">    private TradeRepository tradeRepository;</span><br><span class="line"> </span><br><span class="line">    @TransactionalEventListener(phase = TransactionPhase.AFTER_COMMIT, condition = &quot;# tradeEvent.tradeStatus.name() == &#x27;SUCCEED&#x27;&quot;)</span><br><span class="line">    public void TradeSucceed(TradeEvent tradeEvent) &#123;</span><br><span class="line">        tradeRepository.sendMQEvent(tradeEvent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">// 交易消息订阅</span><br><span class="line">@Component</span><br><span class="line">public class TradeMQReceiver &#123;</span><br><span class="line"> </span><br><span class="line">    @RabbitListener(queues = &quot;ddd-trade-succeed&quot;)</span><br><span class="line">    public void receiveTradeMessage(TradeEvent tradeEvent)&#123;</span><br><span class="line">        System.err.println(&quot;========MQ Receiver============&quot;);</span><br><span class="line">        System.err.println(tradeEvent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<p><strong>应用服务</strong>：</p>
<ul>
<li>应用层是很薄的一层，主要用于调用和组合领域服务，切勿包含任何业务逻辑</li>
<li>可包括少量的流程参数判断</li>
<li>由于可能是多个领域服务组合操作调用，如果存在原子性要求可以增加 **@Transactional** 事务控制</li>
</ul>
<p><strong>事件订阅</strong>：</p>
<ul>
<li>事件订阅是进程内多个领域操作协作解耦的一种实现方式，它也是进程内所有后续操作的接入口</li>
<li>它与应用服务的组合操作用途不一样，组合是根据场景需求可增可减，但事件订阅后的操作是相对固化的，主要是满足逻辑的一致性要求</li>
</ul>
<p><strong>TransactionPhase.AFTER_COMMIT</strong> 配置是在前一操作事务完成后再调用，从而减少后续操作对前操作的影响</p>
<ul>
<li>事件订阅可能会有多个消息主体，为了方便管理最好统一在一个类里处理</li>
<li>MQ 消息发布一般放在事件订阅中</li>
</ul>
<p><strong>消息订阅</strong>：</p>
<ul>
<li>消息订阅是多个微服务间协作解耦的一步实现方式</li>
<li>消息体尽量以统一的对象包装进行传递，降低对象异构带来的处理难度</li>
</ul>
<h1 id="5-基础设施层infrastructure"><a class="markdownIt-Anchor" href="#5-基础设施层infrastructure">#</a> 5. 基础设施层（infrastructure）</h1>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">@Repository</span><br><span class="line">public class TradeRepositoryImpl implements TradeRepository &#123;</span><br><span class="line"> </span><br><span class="line">    private final JpaTradeRepository jpaTradeRepository;</span><br><span class="line">    private final RabbitMQSender rabbitMQSender;</span><br><span class="line">    private final Redis redis;</span><br><span class="line"> </span><br><span class="line">    public TradeRepositoryImpl(JpaTradeRepository jpaTradeRepository, RabbitMQSender rabbitMQSender, Redis redis) &#123;</span><br><span class="line">        this.jpaTradeRepository = jpaTradeRepository;</span><br><span class="line">        this.rabbitMQSender = rabbitMQSender;</span><br><span class="line">        this.redis = redis;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public TradeRecord save(TradeRecord tradeRecord) &#123;</span><br><span class="line">        return jpaTradeRepository.save(tradeRecord);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 查询订单</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public TradeRecord findByTradeNumber(String tradeNumber) &#123;</span><br><span class="line">        TradeRecord tradeRecord = redis.getTrade(tradeNumber);</span><br><span class="line">        if (tradeRecord == null)&#123;</span><br><span class="line">            tradeRecord = jpaTradeRepository.findFirstByTradeNumber(tradeNumber);</span><br><span class="line">            // 缓存</span><br><span class="line">            redis.cacheTrade(tradeRecord);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        return tradeRecord;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 发送事件消息</span><br><span class="line">     * @param tradeEvent</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public void sendMQEvent(TradeEvent tradeEvent) &#123;</span><br><span class="line">        // 发送消息</span><br><span class="line">        rabbitMQSender.sendMQTradeEvent(tradeEvent);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 获取所有</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public List&lt;TradeRecord&gt; findAll() &#123;</span><br><span class="line">        return jpaTradeRepository.findAll();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<ul>
<li>基础设施层是数据的输出向，主要包含数据库、缓存、消息队列、远程访问等的技术实现</li>
<li>基础设计层对外隐藏技术实现细节，提供粗粒度的数据输出服务</li>
<li>数据库操作：领域层传递的是数据对象，在这里可以按数据表的实现方式进行拆分实现</li>
</ul>
<h1 id="6-用户接口层controller"><a class="markdownIt-Anchor" href="#6-用户接口层controller">#</a> 6. 用户接口层（controller）</h1>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@RequestMapping</span>(<span class="string">&quot;/trade&quot;</span>)</span><br><span class="line"><span class="variable">@RestController</span></span><br><span class="line">public class TradeController &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="variable">@Autowired</span></span><br><span class="line">    private TradeManager tradeManager;</span><br><span class="line"> </span><br><span class="line">    <span class="variable">@Autowired</span></span><br><span class="line">    private TradeRepository tradeRepository;</span><br><span class="line"> </span><br><span class="line">    <span class="variable">@PostMapping</span>(path = <span class="string">&quot;/recharge&quot;</span>)</span><br><span class="line">    public TradeDTO <span class="built_in">recharge</span>(<span class="variable">@RequestBody</span> TradeDTO tradeDTO) &#123;</span><br><span class="line">        <span class="selector-tag">return</span> <span class="selector-tag">TradeDTO</span><span class="selector-class">.toDto</span>(tradeManager.<span class="built_in">recharge</span>(tradeDTO.<span class="built_in">toEntity</span>()));</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @<span class="selector-tag">PostMapping</span>(path = <span class="string">&quot;/consume&quot;</span>)</span><br><span class="line">    <span class="selector-tag">public</span> <span class="selector-tag">TradeDTO</span> <span class="selector-tag">consume</span>(<span class="variable">@RequestBody</span> TradeDTO tradeDTO) &#123;</span><br><span class="line">        <span class="selector-tag">return</span> <span class="selector-tag">TradeDTO</span><span class="selector-class">.toDto</span>(tradeManager.<span class="built_in">consume</span>(tradeDTO.<span class="built_in">toEntity</span>()));</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @<span class="selector-tag">GetMapping</span>(path = <span class="string">&quot;/&#123;tradeNumber&#125;&quot;</span>)</span><br><span class="line">    <span class="selector-tag">public</span> <span class="selector-tag">TradeDTO</span> <span class="selector-tag">findByTradeNumber</span>(<span class="variable">@PathVariable</span>(<span class="string">&quot;tradeNumber&quot;</span>) String tradeNumber)&#123;</span><br><span class="line">        <span class="selector-tag">return</span> <span class="selector-tag">TradeDTO</span><span class="selector-class">.toDto</span>(tradeRepository.<span class="built_in">findByTradeNumber</span>(tradeNumber));</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<ul>
<li>用户接口层面向终端提供服务支持</li>
<li>可根据不同的场景单独一个模块，面向 Web 提供 http restful，面向服务间 API 调用提供 RPG 支持</li>
<li>为 Web 端提供身份认证和权限验证服务，VO 数据转换</li>
<li>为 API 端提供限流和熔断服务，DTO 数据转换</li>
<li>将数据转换从应用层提到用户接口层更方便不同场景之前的需求变化，同时也保证应用层数据格式的统一性</li>
</ul>
<h1 id="7-复杂数据查询"><a class="markdownIt-Anchor" href="#7-复杂数据查询">#</a> 7. 复杂数据查询</h1>
<p>以上可见并没有涉及复杂数据查询问题，此问题不涉及业务逻辑处理所以不应该放在领域层处理。</p>
<p>如果复杂数据查询需求较多可采用 CQRS 模式，将查询单独一个模块处理。如果较少可由基础设施层做数据查询，应用层做数据封装，用户接口层做数据调用</p>
<ul>
<li>JPA 不太适合做多表关联的数据库查询操作，可使用其它的灵活性较高的 ORM 架构</li>
</ul>
<p>在大数据大并发情况下，多表关联会严重影响数据库性能，可以考虑做<strong>宽表查询</strong></p>
<h1 id="三-综述"><a class="markdownIt-Anchor" href="#三-综述">#</a> 三、综述</h1>
<p>DDD 分层主要解决各层之间耦合度问题，做到各层各施其职互不影响。各层中领域层的设计是整个系统的中枢，最能体现领域驱动设计的核心思想。它的良好设计是保证往后架构的可持续性，可维护性。</p>
<h2 id="关于我"><a class="markdownIt-Anchor" href="#关于我">#</a> 关于我</h2>
<p>Brath 是一个热爱技术的 Java 程序猿，公众号「InterviewCoder」定期分享有趣有料的精品原创文章！</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E4%BA%8C%E7%BB%B4%E7%A0%81plus.png" alt="InterviewCoder"></p>
<p>非常感谢各位人才能看到这里，原创不易，文章如果有帮助可以关注、点赞、分享或评论，这都是对我的莫大支持！</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-04-26T01:40:26.706Z" title="2023/4/26 09:40:26">2023-04-26</time>发表</span><span class="level-item"><time dateTime="2023-04-23T09:41:18.000Z" title="2023/4/23 17:41:18">2023-04-23</time>更新</span><span class="level-item">4 分钟读完 (大约546个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/04/26/%E3%80%90MySQL%E3%80%91Linux%E4%B8%8Bdocer%E9%83%A8%E7%BD%B2mysql/">Linux下docer部署mysql</a></p><div class="content"><p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png" alt="InterviewCoder"></p>
<h2 id="linux下docer部署mysql"><a class="markdownIt-Anchor" href="#linux下docer部署mysql">#</a> Linux 下 docer 部署 mysql</h2>
<p>部署方法：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">1.首先在Linux系统中启动已经安装好的docker</span><br><span class="line">service docker start</span><br><span class="line"></span><br><span class="line">2.查看docker进程，确认docker启动成功</span><br><span class="line">ps -ef|grep docker</span><br><span class="line"></span><br><span class="line">3.在docker容器中查询MySQL</span><br><span class="line">docker search mysql</span><br><span class="line"></span><br><span class="line">4.在docker中安装MySQL</span><br><span class="line">docker pull mysql</span><br><span class="line"></span><br><span class="line">5.查看MySQL镜像</span><br><span class="line">docker images</span><br><span class="line"></span><br><span class="line">6.创建MySQL用户并且将root账户密码设置为你需要的密码</span><br><span class="line">docker run --name mysqlserver -v $PWD/conf:/etc/mysql/conf.d -v $PWD/logs:/logs -v $PWD/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=『你的账户密码』 -d -i -p 外网端口:3306 mysql:latest</span><br><span class="line"></span><br><span class="line">docker run -p 33001:3306 --name mysqlSlave2 -v /mydata/mysql/log:/var/log/mysql -v /mydata/mysql/data:/var/lib/mysql -v /mydata/mysql/conf:/etc/mysql -e MYSQL_ROOT_PASSWORD=Lgq081538 -d mysql:5.7</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">指定配置文件容器</span></span><br><span class="line">docker run -p 33001:3306 --name mysqlSlave2 \</span><br><span class="line">-v /usr/local/docker/mysql/logs:/var/log/mysql \</span><br><span class="line">-v /usr/local/docker/mysql/data:/var/lib/mysql \</span><br><span class="line">-v /usr/local/docker/mysql/conf/my.cnf:/etc/mysql/mysql.conf.d/mysqld.cnf \</span><br><span class="line">-e MYSQL_ROOT_PASSWORD=Lgq081538 \</span><br><span class="line">-d mysql:5.7</span><br><span class="line"></span><br><span class="line">7.在docker中启动MySQL</span><br><span class="line">docker exec -it mysqlSlave2 bash</span><br><span class="line"></span><br><span class="line">8.输入用户名和密码</span><br><span class="line">mysql -uroot -p</span><br><span class="line"></span><br><span class="line">9.开启MySQL远程访问权限</span><br><span class="line">use mysql;</span><br><span class="line">select host,user from user;</span><br><span class="line">ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;Lgq081538&#x27;;</span><br><span class="line">flush privileges;</span><br><span class="line"></span><br><span class="line">一些在docker的常用命令：</span><br><span class="line">1、列出正在运行的容器</span><br><span class="line">docker ps -a</span><br><span class="line"></span><br><span class="line">2、列出包括未运行的所有的容器</span><br><span class="line">docker ps</span><br><span class="line"></span><br><span class="line">3、查看某进程最近10条运行日志</span><br><span class="line">docker logs -f --tail 10 &quot;所查询的进程ID&quot;</span><br><span class="line"></span><br><span class="line">4、关闭docker中运行的进程，以MySQL为例</span><br><span class="line">docker stop mysql</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line">docker stop &quot;要停止的进程ID&quot;</span><br><span class="line"></span><br><span class="line">5、重启docker中运行的进程</span><br><span class="line">docker restart &quot;要重启的进程ID&quot;</span><br><span class="line"></span><br><span class="line">6、重启docker</span><br><span class="line">systemctl restart docker</span><br><span class="line"></span><br><span class="line">7、停止docker</span><br><span class="line">systemctl stop docker</span><br></pre></td></tr></table></figure>
<h2 id="关于我"><a class="markdownIt-Anchor" href="#关于我">#</a> 关于我</h2>
<p>Brath 是一个热爱技术的 Java 程序猿，公众号「InterviewCoder」定期分享有趣有料的精品原创文章！</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E4%BA%8C%E7%BB%B4%E7%A0%81plus.png" alt="InterviewCoder"></p>
<p>非常感谢各位人才能看到这里，原创不易，文章如果有帮助可以关注、点赞、分享或评论，这都是对我的莫大支持！</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-04-26T01:40:26.703Z" title="2023/4/26 09:40:26">2023-04-26</time>发表</span><span class="level-item"><time dateTime="2023-04-01T03:55:52.000Z" title="2023/4/1 11:55:52">2023-04-01</time>更新</span><span class="level-item">4 分钟读完 (大约549个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/04/26/%E3%80%90Redis%E3%80%91SpringBoot%E6%95%B4%E5%90%88Redis%EF%BC%8C%E7%BC%93%E5%AD%98%E6%89%B9%E9%87%8F%E5%88%A0%E9%99%A4%20%20redisTemplate.keys(pattern)%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%E6%89%BE%E4%B8%8D%E5%88%B0keys%EF%BC%8C%E2%80%9C%20%20%E2%80%9C%20%E9%80%9A%E9%85%8D%E7%AC%A6%E6%97%A0%E6%95%88/">【Redis】SpringBoot整合Redis，缓存批量删除  redisTemplate.keys(pattern)模糊查询找不到keys，“  “ 通配符无效</a></p><div class="content"><p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png" alt="InterviewCoder"></p>
<h1 id="redisspringboot整合redis缓存批量删除-redistemplatekeyspattern模糊查询找不到keys-通配符无效"><a class="markdownIt-Anchor" href="#redisspringboot整合redis缓存批量删除-redistemplatekeyspattern模糊查询找不到keys-通配符无效">#</a> 【Redis】SpringBoot 整合 Redis，缓存批量删除  redisTemplate.keys (pattern) 模糊查询找不到 keys，“  “ 通配符无效</h1>
<h3 id="引言"><a class="markdownIt-Anchor" href="#引言">#</a> 引言</h3>
<p>最近，在学习 Spring Boot 整合 Redis 的知识，在业务中需要删除某个前缀的所有<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=Redis%E7%BC%93%E5%AD%98&amp;spm=1001.2101.3001.7020"> Redis 缓存</a>，首先使用 <strong>RedisTemplate.keys () 模糊查询</strong>出所有合适的 keys，再使用 <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=redisTemplate&amp;spm=1001.2101.3001.7020">redisTemplate</a>.delete () 方法进行批量删除。参考代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Set&lt;String&gt; keys = redisTemplate.keys(prefix + <span class="string">&quot;*&quot;</span>);</span><br><span class="line">redisTemplate.delete(pageKeys);</span><br></pre></td></tr></table></figure>
<p>然而，发现 redisTemplate.keys (prefix + “*” ) 模糊查询，总是返回一个空的集合，找不到 key。</p>
<p>在日志中打印查询的 keys 集合，一直为空集合：</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/e157868f134c4420b9989e3d3e41365a.png" alt="img"></p>
<h3 id="1-问题分析"><a class="markdownIt-Anchor" href="#1-问题分析">#</a> <strong>1、问题分析：</strong></h3>
<p>首先，确保查询字符串正确。</p>
<p>然后，尝试 redisTemplate.keys (key) ，用完整的一个 key 进行查询，发现能正常返回只有一个 key 的集合。</p>
<p>说明模糊查询 的 通配符 <strong>&quot; * &quot;</strong> 没有发挥作用，可能只是被当作一个普通的字符了。</p>
<h3 id="2-问题解决"><a class="markdownIt-Anchor" href="#2-问题解决">#</a> <strong>2、问题解决：</strong></h3>
<p>为 redis 添加配置文件 RedisConfig，重新定义 RedisTemplate 的 key 为 String 类型：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean(name = &quot;redisTemplate&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> RedisTemplate&lt;String, Object&gt; <span class="title function_">redisTemplate</span><span class="params">(RedisConnectionFactory redisConnectionFactory)</span>&#123;</span><br><span class="line">        RedisTemplate&lt;String, Object&gt; redisTemplate = <span class="keyword">new</span> <span class="title class_">RedisTemplate</span>&lt;&gt;();</span><br><span class="line">        redisTemplate.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        <span class="type">StringRedisSerializer</span> <span class="variable">redisSerializer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringRedisSerializer</span>();</span><br><span class="line">        <span class="comment">// key采用String的序列化方式</span></span><br><span class="line">        redisTemplate.setKeySerializer(redisSerializer);</span><br><span class="line">        <span class="comment">// hash的key也采用String的序列化方式</span></span><br><span class="line">        redisTemplate.setHashKeySerializer(redisSerializer);</span><br><span class="line">        <span class="keyword">return</span> redisTemplate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>再次测试 redisTemplate.keys (prefix + “*” ) 模糊查询，可以正常返回缓存中的 keys 集合！！！</p>
<h2 id="关于我"><a class="markdownIt-Anchor" href="#关于我">#</a> 关于我</h2>
<p>Brath 是一个热爱技术的 Java 程序猿，公众号「InterviewCoder」定期分享有趣有料的精品原创文章！</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E4%BA%8C%E7%BB%B4%E7%A0%81plus.png" alt="InterviewCoder"></p>
<p>非常感谢各位人才能看到这里，原创不易，文章如果有帮助可以关注、点赞、分享或评论，这都是对我的莫大支持！</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-04-26T01:40:26.700Z" title="2023/4/26 09:40:26">2023-04-26</time>发表</span><span class="level-item"><time dateTime="2023-03-15T02:08:18.000Z" title="2023/3/15 10:08:18">2023-03-15</time>更新</span><span class="level-item">5 分钟读完 (大约738个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/04/26/%E3%80%90Java%E3%80%91SpringBoot%E6%95%B4%E5%90%88knife4j%E6%A1%86%E6%9E%B6(%E5%8F%AF%E7%94%9F%E6%88%90%E7%A6%BB%E7%BA%BF%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3)%EF%BC%8C%E5%B9%B6%E8%AE%BE%E7%BD%AE%E6%8E%A5%E5%8F%A3%E8%AF%B7%E6%B1%82%E5%A4%B4token%E9%BB%98%E8%AE%A4%E5%80%BC/">SpringBoot整合knife4j框架(可生成离线接口文档)，并设置接口请求头token默认值</a></p><div class="content"><p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png" alt="InterviewCoder"></p>
<h1 id="springboot整合knife4j框架可生成离线接口文档并设置接口请求头token默认值"><a class="markdownIt-Anchor" href="#springboot整合knife4j框架可生成离线接口文档并设置接口请求头token默认值">#</a> SpringBoot 整合 knife4j 框架 (可生成离线接口文档)，并设置接口请求头 token 默认值</h1>
<p>功能和 swagger 类似</p>
<p>官网地址：<a target="_blank" rel="noopener" href="https://doc.xiaominfo.com/knife4j/">https://doc.xiaominfo.com/knife4j/</a></p>
<p>引入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.xiaoymin<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>knife4j-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Knife4jConfig .java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.env.Environment;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.env.Profiles;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.ParameterBuilder;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.RequestHandlerSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.schema.ModelRef;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.ApiInfo;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.Contact;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.Parameter;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spi.DocumentationType;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spring.web.plugins.Docket;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.swagger2.annotations.EnableSwagger2; <span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List; <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yvioo。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span>  <span class="comment">//开启Swagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Knife4jConfig</span> &#123;     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置Swagger的Docket的bean实例</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Docket <span class="title function_">docket</span><span class="params">(Environment environment)</span> &#123;         <span class="comment">//设置只在开发中环境中启动swagger</span></span><br><span class="line">        Profiles profiles=Profiles.of(<span class="string">&quot;dev&quot;</span>);         <span class="comment">//表示如果现在是dev环境，则返回true 开启swagger</span></span><br><span class="line">        <span class="type">boolean</span> flag=environment.acceptsProfiles(profiles);         <span class="comment">/*添加接口请求头参数配置 没有的话 可以忽略*/</span></span><br><span class="line">        <span class="type">ParameterBuilder</span> <span class="variable">tokenPar</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ParameterBuilder</span>();</span><br><span class="line">        List&lt;Parameter&gt; pars = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        tokenPar.name(<span class="string">&quot;token&quot;</span>).description(<span class="string">&quot;令牌&quot;</span>).defaultValue(<span class="string">&quot;设置token默认值&quot;</span>).modelRef(<span class="keyword">new</span> <span class="title class_">ModelRef</span>(<span class="string">&quot;string&quot;</span>)).parameterType(<span class="string">&quot;header&quot;</span>).required(<span class="literal">false</span>).build();</span><br><span class="line">        pars.add(tokenPar.build());         <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo())</span><br><span class="line">                <span class="comment">//是否启动swagger 默认启动</span></span><br><span class="line">                .enable(flag)</span><br><span class="line">                <span class="comment">//所在分组</span></span><br><span class="line">                .groupName(<span class="string">&quot;yvioo&quot;</span>)</span><br><span class="line">                .select()</span><br><span class="line">                <span class="comment">//指定扫描的包路径</span></span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.example.demo.controller&quot;</span>))</span><br><span class="line">                <span class="comment">//指定扫描的请求，这里表示扫描 /hello/ 的请求</span></span><br><span class="line">                <span class="comment">//.paths(PathSelectors.ant(&quot;/hello/**&quot;))</span></span><br><span class="line">                .build()</span><br><span class="line">                .globalOperationParameters(pars);</span><br><span class="line">    &#125;     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置ApiInfo信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> ApiInfo <span class="title function_">apiInfo</span><span class="params">()</span> &#123;         <span class="comment">//作者信息</span></span><br><span class="line">        <span class="type">Contact</span> <span class="variable">author</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Contact</span>(<span class="string">&quot;yvioo&quot;</span>, <span class="string">&quot;https://www.cnblogs.com/pxblog/&quot;</span>, <span class="string">&quot;111@qq.com&quot;</span>);         <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ApiInfo</span>(</span><br><span class="line">                <span class="string">&quot;Knife4j测试&quot;</span>,</span><br><span class="line">                <span class="string">&quot;Knife4j描述&quot;</span>,</span><br><span class="line">                <span class="string">&quot;1.0&quot;</span>,</span><br><span class="line">                <span class="string">&quot;urn:tos&quot;</span>,</span><br><span class="line">                author,</span><br><span class="line">                <span class="string">&quot;Apache 2.0&quot;</span>,</span><br><span class="line">                <span class="string">&quot;http://www.apache.org/licenses/LICENSE-2.0&quot;</span>,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ArrayList</span>()</span><br><span class="line">        );     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>控制器的写法和 swagger 基本类似</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Api(tags = &quot;首页模块&quot;)</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IndexController</span> &#123;     <span class="meta">@ApiImplicitParam(name = &quot;name&quot;,value = &quot;姓名&quot;,required = true)</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;向客人问好&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/sayHi&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;String&gt; <span class="title function_">sayHi</span><span class="params">(<span class="meta">@RequestParam(value = &quot;name&quot;)</span>String name)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.ok(<span class="string">&quot;Hi:&quot;</span>+name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是如果有其他配置继承了 WebMvcConfigurationSupport 就需要增加资源映射 不然会失效</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebMvcConfigurer</span> <span class="keyword">extends</span> <span class="title class_">WebMvcConfigurationSupport</span> &#123;     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发现如果继承了WebMvcConfigurationSupport， 需要重新指定静态资源</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;/**&quot;</span>).addResourceLocations(</span><br><span class="line">                <span class="string">&quot;classpath:/static/&quot;</span>);</span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;doc.html&quot;</span>).addResourceLocations(</span><br><span class="line">                <span class="string">&quot;classpath:/META-INF/resources/&quot;</span>);</span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;/webjars/**&quot;</span>).addResourceLocations(</span><br><span class="line">                <span class="string">&quot;classpath:/META-INF/resources/webjars/&quot;</span>);</span><br><span class="line">        <span class="built_in">super</span>.addResourceHandlers(registry);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>效果</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/1092624-20210531140148243-852424753.png" alt="img"></p>
<p>离线接口文档</p>
<p><img src="https://brath.oss-cn-shanghai.aliyuncs.com/pigo/1092624-20210531141839463-1322211712.png" alt="img"></p>
<p>浏览器访问</p>
<p>使用 dev 环境 启动项目后 浏览器打开 http://localhost:8081/doc.html#/  我这里用的端口是 8081</p>
<p>整合 swagger 框架参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/pxblog/p/12942825.html">https://www.cnblogs.com/pxblog/p/12942825.html</a></p>
<h2 id="关于我"><a class="markdownIt-Anchor" href="#关于我">#</a> 关于我</h2>
<p>Brath 是一个热爱技术的 Java 程序猿，公众号「InterviewCoder」定期分享有趣有料的精品原创文章！</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E4%BA%8C%E7%BB%B4%E7%A0%81plus.png" alt="InterviewCoder"></p>
<p>非常感谢各位人才能看到这里，原创不易，文章如果有帮助可以关注、点赞、分享或评论，这都是对我的莫大支持！</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-04-26T01:40:26.697Z" title="2023/4/26 09:40:26">2023-04-26</time>发表</span><span class="level-item"><time dateTime="2023-02-13T12:22:37.000Z" title="2023/2/13 20:22:37">2023-02-13</time>更新</span><span class="level-item">5 分钟读完 (大约682个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/04/26/%E3%80%90SpringBoot%E3%80%91RequestParam%20%E5%92%8C%20PathVariable%E7%9A%84%E5%8C%BA%E5%88%AB/">RequestParam 和 PathVariable的区别</a></p><div class="content"><p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png" alt="InterviewCoder"></p>
<p>RequestParam 和 PathVariable 注解是用于从 request 中接收请求的，两个都可以接收参数，关键点不同的是 RequestParam 是从 request 里面拿取值，而 PathVariable 是从一个 URI 模板里面来填充</p>
<p>PathVariable<br>
 主要用于接收 http://host:port/path/{参数值} 数据:</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8887/test1/id1/name1">http://localhost:8887/test1/id1/name1</a></p>
<p>根据上面的这个 url，你可以用这样的方式来进行获取:</p>
<pre><code>RequestMapping(&quot;test1/&#123;id&#125;/&#123;name&#125;&quot;)
public String testPathVariable(PathVariable String id, PathVariable String name) &#123;
    return &quot;id=&quot; + id + &quot;, name=&quot; + name;
&#125;
PathVariable 支持下面三种参数：
</code></pre>
<p>name 绑定本次参数的名称，要跟 URL 上面的一样<br>
 required 这个参数是否必须的<br>
 value 跟 name 一样的作用，是 name 属性的一个别名<br>
 RequestParam<br>
 主要用于接收 http://host:port/path? 参数名 = 参数值数据，这里后面也可以不跟参数值；</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8887/test2?id=id2&amp;name=name2">http://localhost:8887/test2?id=id2&amp;name=name2</a></p>
<p>根据上面的这个 url，你可以用这样的方式来进行获取:</p>
<pre><code>RequestMapping(&quot;test2&quot;)
public String testRequestParam(RequestParam(&quot;id&quot;) String id, RequestParam(&quot;name&quot;) String name) &#123;
    return &quot;id=&quot; + id + &quot;, name=&quot; + name;
&#125;
RequestParam 支持下面四种参数：
</code></pre>
<p>defaultValue 如果本次请求没有携带这个参数，或者参数为空，那么就会启用默认值<br>
 name 绑定本次参数的名称，要跟 URL 上面的一样<br>
 required 这个参数是否必须的<br>
 value 跟 name 一样的作用，是 name 属性的一个别名<br>
 PathVariable 和 RequestParam 混合使用<br>
<a target="_blank" rel="noopener" href="http://localhost:8887/test3/id3?name=name3"> http://localhost:8887/test3/id3?name=name3</a></p>
<p>根据上面的这个 url，你可以用这样的方式来进行获取:</p>
<pre><code>RequestMapping(&quot;test3/&#123;id&#125;&quot;)
public String test3(PathVariable String id, RequestParam(&quot;name&quot;) String name) &#123;
    return &quot;id=&quot; + id + &quot;, name=&quot; + name;
&#125;
对比
1.用法上的不同：
PathVariable只能用于接收url路径上的参数，而RequestParam只能用于接收请求带的params
2.内部参数不同：
PathVariable有value，name，required这三个参数，而RequestParam也有这三个参数，并且比PathVariable多一个参数defaultValue（该参数用于当请求体中不包含对应的参数变量时，参数变量使用defaultValue指定的默认值）
3.PathVariable一般用于get和delete请求，RequestParam一般用于post请求。
</code></pre>
<h2 id="关于我"><a class="markdownIt-Anchor" href="#关于我">#</a> 关于我</h2>
<p>Brath 是一个热爱技术的 Java 程序猿，公众号「InterviewCoder」定期分享有趣有料的精品原创文章！</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E4%BA%8C%E7%BB%B4%E7%A0%81plus.png" alt="InterviewCoder"></p>
<p>非常感谢各位人才能看到这里，原创不易，文章如果有帮助可以关注、点赞、分享或评论，这都是对我的莫大支持！</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-04-26T01:40:26.695Z" title="2023/4/26 09:40:26">2023-04-26</time>发表</span><span class="level-item"><time dateTime="2023-02-03T21:51:17.000Z" title="2023/2/4 05:51:17">2023-02-04</time>更新</span><span class="level-item">10 分钟读完 (大约1444个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/04/26/%E3%80%90JavaScript%E3%80%91JavaScript%E5%8E%9F%E5%9E%8B%E9%93%BE/">【JavaScript】JavaScript原型链</a></p><div class="content"><p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png" alt="InterviewCoder"></p>
<h1 id="javascriptjavascript原型链"><a class="markdownIt-Anchor" href="#javascriptjavascript原型链">#</a> 【JavaScript】JavaScript 原型链</h1>
<h5 id="2023417-重温一下多年前的八股文"><a class="markdownIt-Anchor" href="#2023417-重温一下多年前的八股文">#</a> 2023/4/17 重温一下多年前的八股文</h5>
<h2 id="对象"><a class="markdownIt-Anchor" href="#对象">#</a> 对象</h2>
<p>要清楚原型链，首先要弄清楚对象：</p>
<ul>
<li>
<p>普通对象</p>
</li>
<li>
<ul>
<li>最普通的对象：有__proto__属性（指向其原型链），没有 prototype 属性。</li>
<li>原型对象 (Person.prototype 原型对象还有 constructor 属性（指向构造函数对象）)</li>
</ul>
</li>
<li>
<p>函数对象：</p>
<ul>
<li>凡是通过 new Function () 创建的都是函数对象。</li>
</ul>
</li>
</ul>
<p>拥有__proto__、prototype 属性（指向原型对象）。</p>
<p>Function、Object、Array、Date、String、自定义函数</p>
<p>特例： Function.prototype (是原型对象，却是函数对象，下面会有解释)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//函数对象  </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">F1</span>(<span class="params"></span>)&#123;&#125;;  </span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">F2</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;;  </span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">F3</span> = <span class="keyword">function</span>(<span class="params"><span class="string">&quot;n1&quot;</span>,<span class="string">&quot;n2&quot;</span>,<span class="string">&quot;return n1+n2&quot;</span></span>);  </span><br><span class="line">  </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="variable constant_">F1</span>);  <span class="comment">//function  </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="variable constant_">F2</span>);  <span class="comment">//function  </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="variable constant_">F3</span>);   <span class="comment">//function  </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="title class_">Object</span>);   <span class="comment">//function  </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="title class_">Array</span>);   <span class="comment">//function  </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="title class_">String</span>);   <span class="comment">//function  </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="title class_">Date</span>);   <span class="comment">//function  </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="title class_">Function</span>);   <span class="comment">//function  </span></span><br></pre></td></tr></table></figure>
<p><img src="https://pic3.zhimg.com/80/v2-261209138284cee7af75fd5bd4d98eea_720w.webp" alt="img"></p>
<p>Array 是函数对象，是 Function 的实例对象，Array 是通过 newFunction 创建出来的。因为 Array 是 Function 的实例，所以 Array.<strong>proto</strong> === Function.prototype</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//普通对象  </span></span><br><span class="line"><span class="keyword">var</span> o1 = <span class="keyword">new</span> <span class="title function_">F1</span>();   </span><br><span class="line"><span class="keyword">var</span> o2 = &#123;&#125;;         </span><br><span class="line"><span class="keyword">var</span> o3 = <span class="keyword">new</span> <span class="title class_">Object</span>();   </span><br><span class="line">  </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> o1);  <span class="comment">//Object  </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> o2);   <span class="comment">//Object  </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> o3);   <span class="comment">//Object  </span></span><br></pre></td></tr></table></figure>
<h1 id="原型对象"><a class="markdownIt-Anchor" href="#原型对象">#</a> 原型对象</h1>
<p>每创建一个函数都会有一个 prototype 属性，这个属性是一个指针，指向一个对象（通过该构造函数创建实例对象的原型对象）。原型对象是包含特定类型的所有实例共享的属性和方法。原型对象的好处是，可以让所有实例对象共享它所包含的属性和方法。</p>
<p>第一块中有提到，原型对象属于普通对象。Function.prototype 是个例外，它是原型对象，却又是函数对象，作为一个函数对象，它又没有 prototype 属性。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>)&#123;&#125;;  </span><br><span class="line">  </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>) <span class="comment">//Object  </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>) <span class="comment">// Object  </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>) <span class="comment">// 特殊 Function  </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property"><span class="keyword">prototype</span></span>) <span class="comment">//undefined 函数对象却没有prototype属性 </span></span><br></pre></td></tr></table></figure>
<p>解释：</p>
<p>其实原型对象就是构造函数的一个实例对象。person.prototype 就是 person 的一个实例对象。相当于在 person 创建的时候，自动创建了一个它的实例，并且把这个实例赋值给了 prototype。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>)&#123;&#125;;  </span><br><span class="line"><span class="keyword">var</span> temp = <span class="keyword">new</span> <span class="title class_">Person</span>();  </span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span> = temp;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Function</span>(<span class="params"></span>)&#123;&#125;;  </span><br><span class="line"><span class="keyword">var</span> temp = <span class="keyword">new</span> <span class="title class_">Function</span>();  </span><br><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span> = temp; <span class="comment">//由new Function()产生的对象都是函数对象  </span></span><br></pre></td></tr></table></figure>
<p>从一张图看懂原型对象、构造函数、实例对象之间的关系</p>
<p><img src="https://pic1.zhimg.com/80/v2-830f96ed4a5765089776e9702120d484_720w.webp" alt="img"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Dog</span>(<span class="params"></span>)&#123;&#125;;  </span><br><span class="line">  </span><br><span class="line"><span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">name</span> = <span class="string">&quot;小黄&quot;</span>;  </span><br><span class="line"><span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">age</span> =  <span class="number">13</span>;  </span><br><span class="line"><span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getAge</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">age</span>;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">var</span> dog1 = <span class="keyword">new</span> <span class="title class_">Dog</span>();  </span><br><span class="line"><span class="keyword">var</span> dog2 = <span class="keyword">new</span> <span class="title class_">Dog</span>();  </span><br><span class="line">  </span><br><span class="line">dog2.<span class="property">name</span> = <span class="string">&quot;小黑&quot;</span>;  </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(dog1.<span class="property">name</span>); <span class="comment">// 小黄 来自原型  </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(dog2.<span class="property">name</span>); <span class="comment">// 小黑 来自实例  </span></span><br></pre></td></tr></table></figure>
<p><img src="https://pic3.zhimg.com/80/v2-5d7fc42b450728c6a5b72a903ee3fc36_720w.webp" alt="img"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//图中的一些关系  </span><br><span class="line">dog1.__proto__ === Dog.prototype  </span><br><span class="line">  </span><br><span class="line">Dog.prototype.__proto__ === Object.prototype //继承Object 下面原型链说  </span><br><span class="line">  </span><br><span class="line">dog1.__proto__.__proto__ === Object.prototype  </span><br><span class="line">  </span><br><span class="line">Dog.prototype.constructor === Dog   </span><br><span class="line">  </span><br><span class="line">Dog.prototype.isPrototypeOf(dog1)  </span><br><span class="line">  </span><br><span class="line">//获取对象的原型  </span><br><span class="line">dog1.__proto__  //不推荐  </span><br><span class="line">Object.getPrototypeOf(dog1) === Dog.prototype   //推荐  </span><br></pre></td></tr></table></figure>
<h1 id="原型链"><a class="markdownIt-Anchor" href="#原型链">#</a> 原型链</h1>
<p>原型链是实现继承的主要方法。</p>
<p>先说一下继承，许多 OO 语言都支持两张继承方式：接口继承、实现继承。</p>
<p>|- 接口继承：只继承方法签名</p>
<p>|- 实现继承：继承实际的方法</p>
<p>由于函数没有签名，在 ECMAScript 中无法实现接口继承，只支持实现继承，而实现继承主要是依靠原型链来实现。</p>
<p>原型链基本思路：</p>
<p>利用原型让一个引用类型继承另一个引用类型的属性和方法。</p>
<p>每个构造函数都有一个原型对象，原型对象都包含一个指向构造函数想指针 (constructor)，而实例对象都包含一个指向原型对象的内部指针 (<strong>proto</strong>)。如果让原型对象等于另一个类型的实例，此时的原型对象将包含一个指向另一个原型的指针 (<strong>proto</strong>)，另一个原型也包含着一个指向另一个构造函数的指针 (constructor)。假如另一个原型又是另一个类型的实例…… 这就构成了实例与原型的链条。</p>
<p>原型链基本思路（图解）：</p>
<p><img src="https://pic3.zhimg.com/80/v2-901202a60d3f6e9fcc90a69d06fe0282_720w.webp" alt="img"></p>
<p>举例说明：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Animal</span>(<span class="params"></span>)&#123;  </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">type</span> = <span class="string">&quot;animal&quot;</span>;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="title class_">Animal</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getType</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">type</span>;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Dog</span>(<span class="params"></span>)&#123;  </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&quot;dog&quot;</span>;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Animal</span>();  </span><br><span class="line">  </span><br><span class="line"><span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getName</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">var</span> xiaohuang = <span class="keyword">new</span> <span class="title class_">Dog</span>();  </span><br><span class="line"><span class="comment">//原型链关系  </span></span><br><span class="line">xiaohuang.<span class="property">__proto__</span> === <span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>  </span><br><span class="line"><span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span> === <span class="title class_">Animal</span>.<span class="property"><span class="keyword">prototype</span></span>  </span><br><span class="line"><span class="title class_">Animal</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span> === <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>  </span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span> === <span class="literal">null</span>  </span><br></pre></td></tr></table></figure>
<p>图解:</p>
<p><img src="https://pic4.zhimg.com/80/v2-b47a3e4984d49bec824db6217cf03ea7_720w.webp" alt="img"></p>
<p>详细图</p>
<p><img src="https://pic4.zhimg.com/80/v2-2087bd26483d9aafccbb0e83904f4d1b_720w.webp" alt="img"></p>
<p>（图片修正：笔误，第一行应该是 xiaohuang.<strong>proto</strong> === Dog.prototype）</p>
<p>从 xiaohuang 这个实例，看出整个链条</p>
<p>总结：</p>
<p>Xiaohuang 这个 Dog 的实例对象继承了 Animal，Animal 继承了 Object。</p>
<p><img src="https://pic1.zhimg.com/80/v2-58d80f6a14ef493efe6c255b4991a670_720w.webp" alt="img"></p>
<h2 id="关于我"><a class="markdownIt-Anchor" href="#关于我">#</a> 关于我</h2>
<p>Brath 是一个热爱技术的 Java 程序猿，公众号「InterviewCoder」定期分享有趣有料的精品原创文章！</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E4%BA%8C%E7%BB%B4%E7%A0%81plus.png" alt="InterviewCoder"></p>
<p>非常感谢各位人才能看到这里，原创不易，文章如果有帮助可以关注、点赞、分享或评论，这都是对我的莫大支持！</p>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/2/">上一页</a></div><div class="pagination-next"><a href="/page/4/">下一页</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li><li><a class="pagination-link is-current" href="/page/3/">3</a></li><li><a class="pagination-link" href="/page/4/">4</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/13/">13</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-26T01:40:26.773Z">2023-04-26</time></p><p class="title"><a href="/2023/04/26/%E3%80%90Flutter%E3%80%91Flutter%E5%BC%80%E5%8F%91%E4%B8%AD%E4%BD%BF%E7%94%A8WIFI%E7%9C%9F%E6%9C%BA%E8%B0%83%E8%AF%95/">Flutter开发中使用WIFI真机调试</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-26T01:40:26.770Z">2023-04-26</time></p><p class="title"><a href="/2023/04/26/%E3%80%90GOSN%E3%80%91Gosn%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F%E6%80%8E%E4%B9%88%E4%BD%BF%E7%94%A8%EF%BC%9F/">【GOSN】Gosn是什么？怎么使用？</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-26T01:40:26.767Z">2023-04-26</time></p><p class="title"><a href="/2023/04/26/%E3%80%90Typora%E3%80%91typora%E9%85%8D%E7%BD%AEAliCloudOss%E5%9B%BE%E5%BA%93%E4%BD%BF%E7%94%A8picgo%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87/">Typora使用gitee作为图库用picgo上传图片的教程~</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-26T01:40:26.765Z">2023-04-26</time></p><p class="title"><a href="/2023/04/26/%E3%80%90Docker%E3%80%91%E4%BD%BF%E7%94%A8docker%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E8%AE%B0%E5%BD%95/">使用docker搭建开发环境记录</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-26T01:40:26.762Z">2023-04-26</time></p><p class="title"><a href="/2023/04/26/%E3%80%90Go%E3%80%91Go%E8%AF%AD%E8%A8%80%E4%B8%8EJava%E8%AF%AD%E8%A8%80%E5%AF%B9%E6%AF%94/">【Go】Go语言与Java语言对比</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/"><span class="level-start"><span class="level-item">2023</span></span><span class="level-end"><span class="level-item tag">121</span></span></a></li></ul></div></div></div><!--!--><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E4%BA%8C%E7%BB%B4%E7%A0%81plus.png" alt="InterviewCoder"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">InterviewCoder</p><p class="is-size-6 is-block">面试记官方公众号</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">121</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">0</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://mp.weixin.qq.com/s/jWs6lLHl5L-atXJhHc4YvA" target="_blank" rel="noopener">关注我</a></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://brath.cloud/me.png" alt="Brath"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Brath</p><p class="is-size-6 is-block">技能改变人生，知识改变命运。</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国·江苏·无锡</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">121</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">0</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/Guoqing815" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Guoqing815"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Gitee" href="https://gitee.com/Guoqing-Li"><i class="fab fa-gitee"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://schokolade.cn/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">泠灵(特别呜谢)</span></span><span class="level-right"><span class="level-item tag">schokolade.cn</span></span></a></li><li><a class="level is-mobile" href="https://gitee.com/Guoqing-Li" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Gitee(码云)</span></span><span class="level-right"><span class="level-item tag">gitee.com</span></span></a></li><li><a class="level is-mobile" href="https://blog.csdn.net/Brath?type=blog" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">CSDN</span></span><span class="level-right"><span class="level-item tag">blog.csdn.net</span></span></a></li><li><a class="level is-mobile" href="https://juejin.cn/user/settings/profile" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">掘金</span></span><span class="level-right"><span class="level-item tag">juejin.cn</span></span></a></li><li><a class="level is-mobile" href="https://oss.console.aliyun.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">AliCloud(阿里云)</span></span><span class="level-right"><span class="level-item tag">oss.console.aliyun.com</span></span></a></li><li><a class="level is-mobile" href="https://cloud.tencent.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">TencentCloud(腾讯云)</span></span><span class="level-right"><span class="level-item tag">cloud.tencent.com</span></span></a></li><li><a class="level is-mobile" href="https://www.zhipin.com/web/user/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">BOSS</span></span><span class="level-right"><span class="level-item tag">www.zhipin.com</span></span></a></li><li><a class="level is-mobile" href="https://www.bilibili.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bilibili(B站)</span></span><span class="level-right"><span class="level-item tag">www.bilibili.com</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://brath.cloud/me.png" alt="Brath-Blog" height="28"></a><p class="is-size-7"><span>&copy; 2023 Brath</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p><p class="is-size-7">© 2029</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>