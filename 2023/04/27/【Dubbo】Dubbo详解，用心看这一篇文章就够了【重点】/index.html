<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>【Dubbo】Dubbo详解，用心看这一篇文章就够了【重点】 - Brath-Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Brath-Blog"><meta name="msapplication-TileImage" content="https://brath.cloud/me.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Brath-Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="# 【Dubbo】Dubbo 详解，用心看这一篇文章就够了【重点】 # 1.1  Dubbo  概述  Dubbo  是阿里巴巴开源的基于  Java  的高性能 RPC （一种远程调用） 分布式服务框架，致力于提供高性能和透明化的 RPC  远程服务调用方案，以及 SOA  服务治理方案。 每天为 2  千多个服务提供大于 30  亿次访问量支持，并被广泛应用于阿里巴巴集团的各成员站点以及别的"><meta property="og:type" content="blog"><meta property="og:title" content="【Dubbo】Dubbo详解，用心看这一篇文章就够了【重点】"><meta property="og:url" content="http://example.com/2023/04/27/%E3%80%90Dubbo%E3%80%91Dubbo%E8%AF%A6%E8%A7%A3%EF%BC%8C%E7%94%A8%E5%BF%83%E7%9C%8B%E8%BF%99%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B0%B1%E5%A4%9F%E4%BA%86%E3%80%90%E9%87%8D%E7%82%B9%E3%80%91/"><meta property="og:site_name" content="Brath-Blog"><meta property="og:description" content="# 【Dubbo】Dubbo 详解，用心看这一篇文章就够了【重点】 # 1.1  Dubbo  概述  Dubbo  是阿里巴巴开源的基于  Java  的高性能 RPC （一种远程调用） 分布式服务框架，致力于提供高性能和透明化的 RPC  远程服务调用方案，以及 SOA  服务治理方案。 每天为 2  千多个服务提供大于 30  亿次访问量支持，并被广泛应用于阿里巴巴集团的各成员站点以及别的"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/9529d3b51c5f4fa4944fc793a542688a.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/a7579c9f3b0e4a928d2bedde32fd2f1f.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/36242cd9be084aea8c2c30643485c960.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/58b4c7452c0243fdb318d0282d603f94.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/b42b2f9c1b1e4c56b36ea55673c037fd.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/7792efd1449d4117b828af6c1022e089.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/5b512b42ca2b41ed82fd82aaeee060dd.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/fb50e61a90ab4e6c873323a7bac4d345.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/e6964bf9a44b442ca792e91ca7e098b0.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/af173265c9fd4e72a6118916e5f4bf32.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/7a5a1b4a974a48ceb5aa80f1d516f5f4.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/e0f491e8de154c93b814e9e87df52f54.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/99006e3f58d0417dbf27fa7068633b05.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/1ad33df6d381480793d65ee4212b5ea6.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/7a607c56fd774c65acf83b23b10bc831.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/5f2fc6b4d06b48fea91f16dfb130eb70.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/0ff7a379a9df48e5a08f4669871a8832.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/994174d242d84c92a8eb2489b6bc8930.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/82d1dafceb4d4562a5bf143dd1bcaed9.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/752b5bf0d635420980b39495b8bf029d.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/272a429bc9a547108334d08a1188e774.png"><meta property="og:image" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E4%BA%8C%E7%BB%B4%E7%A0%81plus.png"><meta property="article:published_time" content="2023-04-27T09:20:49.000Z"><meta property="article:modified_time" content="2023-04-29T11:04:20.517Z"><meta property="article:author" content="Brath"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2023/04/27/%E3%80%90Dubbo%E3%80%91Dubbo%E8%AF%A6%E8%A7%A3%EF%BC%8C%E7%94%A8%E5%BF%83%E7%9C%8B%E8%BF%99%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B0%B1%E5%A4%9F%E4%BA%86%E3%80%90%E9%87%8D%E7%82%B9%E3%80%91/"},"headline":"【Dubbo】Dubbo详解，用心看这一篇文章就够了【重点】","image":["https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/9529d3b51c5f4fa4944fc793a542688a.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/a7579c9f3b0e4a928d2bedde32fd2f1f.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/36242cd9be084aea8c2c30643485c960.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/58b4c7452c0243fdb318d0282d603f94.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/b42b2f9c1b1e4c56b36ea55673c037fd.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/7792efd1449d4117b828af6c1022e089.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/5b512b42ca2b41ed82fd82aaeee060dd.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/fb50e61a90ab4e6c873323a7bac4d345.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/e6964bf9a44b442ca792e91ca7e098b0.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/af173265c9fd4e72a6118916e5f4bf32.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/7a5a1b4a974a48ceb5aa80f1d516f5f4.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/e0f491e8de154c93b814e9e87df52f54.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/99006e3f58d0417dbf27fa7068633b05.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/1ad33df6d381480793d65ee4212b5ea6.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/7a607c56fd774c65acf83b23b10bc831.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/5f2fc6b4d06b48fea91f16dfb130eb70.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/0ff7a379a9df48e5a08f4669871a8832.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/994174d242d84c92a8eb2489b6bc8930.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/82d1dafceb4d4562a5bf143dd1bcaed9.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/752b5bf0d635420980b39495b8bf029d.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/272a429bc9a547108334d08a1188e774.png","https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E4%BA%8C%E7%BB%B4%E7%A0%81plus.png"],"datePublished":"2023-04-27T09:20:49.000Z","dateModified":"2023-04-29T11:04:20.517Z","author":{"@type":"Person","name":"Brath"},"publisher":{"@type":"Organization","name":"Brath-Blog","logo":{"@type":"ImageObject","url":"https://brath.cloud/me.png"}},"description":"# 【Dubbo】Dubbo 详解，用心看这一篇文章就够了【重点】 # 1.1  Dubbo  概述  Dubbo  是阿里巴巴开源的基于  Java  的高性能 RPC （一种远程调用） 分布式服务框架，致力于提供高性能和透明化的 RPC  远程服务调用方案，以及 SOA  服务治理方案。 每天为 2  千多个服务提供大于 30  亿次访问量支持，并被广泛应用于阿里巴巴集团的各成员站点以及别的"}</script><link rel="canonical" href="http://example.com/2023/04/27/%E3%80%90Dubbo%E3%80%91Dubbo%E8%AF%A6%E8%A7%A3%EF%BC%8C%E7%94%A8%E5%BF%83%E7%9C%8B%E8%BF%99%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B0%B1%E5%A4%9F%E4%BA%86%E3%80%90%E9%87%8D%E7%82%B9%E3%80%91/"><link rel="icon" href="https://brath.cloud/me.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://brath.cloud/me.png" alt="Brath-Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">文章列表</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">更多</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Guoqing815"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-04-27T09:20:49.000Z" title="2023/4/27 17:20:49">2023-04-27</time>发表</span><span class="level-item"><time dateTime="2023-04-29T11:04:20.517Z" title="2023/4/29 19:04:20">2023-04-29</time>更新</span><span class="level-item">1 小时读完 (大约11033个字)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">【Dubbo】Dubbo详解，用心看这一篇文章就够了【重点】</h1><div class="content"><p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png" alt="InterviewCoder"></p>
<h2 id="dubbodubbo详解用心看这一篇文章就够了重点"><a class="markdownIt-Anchor" href="#dubbodubbo详解用心看这一篇文章就够了重点">#</a> 【Dubbo】Dubbo 详解，用心看这一篇文章就够了【重点】</h2>
<h2 id="11-dubbo概述"><a class="markdownIt-Anchor" href="#11-dubbo概述">#</a> 1.1  <code>Dubbo</code>  概述</h2>
<p><strong> <code>Dubbo</code>  是阿里巴巴开源的基于  <code>Java</code>  的高性能 <code>RPC</code> （一种远程调用） 分布式服务框架，致力于提供高性能和透明化的 <code>RPC</code>  远程服务调用方案，以及 <code>SOA</code>  服务治理方案</strong>。</p>
<p>每天为 <code>2</code>  千多个服务提供大于 <code>30</code>  亿次访问量支持，并被广泛应用于阿里巴巴集团的各成员站点以及别的公司的业务中。</p>
<p>简单的说， <code>Dubbo</code>  就是个服务框架，如果没有分布式的需求，其实是不需要用的，只有在分布式的时候，才有 <code>Dubbo</code>  这样的分布式服务框架的需求。</p>
<p>并且本质上是个远程服务调用的分布式框架（告别 <code>Web Service</code>  模式中的 <code>WSdl</code> ，以服务者与消费者的方式在 <code>Dubbo</code>  上注册）</p>
<p>其核心部分包含：</p>
<p>1、<strong>远程通讯</strong>：提供对多种基于长连接的 <code>NIO</code>  框架抽象封装，包括多种线程模型，序列化，以及 “请求 - 响应” 模式的信息交换方式。<br>
2、<strong>集群容错</strong>：提供基于接口方法的透明远程过程调用，包括多协议支持，以及软负载均衡，失败容错，地址路由，动态配置等集群支持。<br>
3、<strong>自动发现</strong>：基于注册中心目录服务，使服务消费方能动态的查找服务提供方，使地址透明，使服务提供方可以平滑增加或减少机器。</p>
<h2 id="12-dubbo背景"><a class="markdownIt-Anchor" href="#12-dubbo背景">#</a> 1.2  <code>Dubbo</code>  背景</h2>
<p><code>Dubbo</code>  开始于电商系统，因此在这里先从电商系统的演变讲起。</p>
<h3 id="121-单一应用框架"><a class="markdownIt-Anchor" href="#121-单一应用框架">#</a> 1.2.1 单一应用框架</h3>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/9529d3b51c5f4fa4944fc793a542688a.png" alt="在这里插入图片描述"><br>
当网站流量很小时，只需一个应用，将所有功能如下单支付等都部署在一起，以减少部署节点和成本。</p>
<p><strong>缺点</strong>：单一的系统架构，使得在开发过程中，占用的资源越来越多，而且随着流量的增加越来越难以维护。</p>
<h3 id="122-垂直应用框架"><a class="markdownIt-Anchor" href="#122-垂直应用框架">#</a> 1.2.2 垂直应用框架</h3>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/a7579c9f3b0e4a928d2bedde32fd2f1f.png" alt="在这里插入图片描述"><br>
垂直应用架构解决了单一应用架构所面临的扩容问题，流量能够分散到各个子系统当中，且系统的体积可控，一定程度上降低了开发人员之间协同以及维护的成本，提升了开发效率。</p>
<p><strong>缺点</strong>：但是在垂直架构中相同逻辑代码需要不断的复制，不能复用。</p>
<h3 id="123-分布式应用架构rpc"><a class="markdownIt-Anchor" href="#123-分布式应用架构rpc">#</a> 1.2.3 分布式应用架构 ( <code>RPC</code> )</h3>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/36242cd9be084aea8c2c30643485c960.png" alt="在这里插入图片描述"><br>
当垂直应用越来越多，应用之间交互不可避免，将核心业务抽取出来，作为独立的服务，逐渐形成稳定的服务中心。</p>
<h3 id="124-流动计算架构soa"><a class="markdownIt-Anchor" href="#124-流动计算架构soa">#</a> 1.2.4 流动计算架构 ( <code>SOA</code> )</h3>
<p>随着服务化的进一步发展，服务越来越多，服务之间的调用和依赖关系也越来越复杂，诞生了面向服务的架构体系 ( <code>SOA</code> )，也因此衍生出了一系列相应的技术，如对服务提供、服务调用、连接处理、通信协议、序列化方式、服务发现、服务路由、日志输出等行为进行封装的服务框架。</p>
<h3 id="125-架构演变详解"><a class="markdownIt-Anchor" href="#125-架构演变详解">#</a> 1.2.5 架构演变详解</h3>
<p>从以上是电商系统的演变可以看出架构演变的过程：<br>
<img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/58b4c7452c0243fdb318d0282d603f94.png" alt="在这里插入图片描述"><br>
 1、单应用单服务器；<br>
2、单应用拆分成多个应用并部署到多个服务器；<br>
3、单应用拆分成多个应用并实现分布式部署；<br>
4、流动计算框架（用于提高机器利用率的资源调度和治理中心）</p>
<h4 id="1251-单一应用架构"><a class="markdownIt-Anchor" href="#1251-单一应用架构">#</a> 1.2.5.1 单一应用架构</h4>
<p>当网站流量很小时，只需一个应用，将所有功能都部署在一起，以减少部署节点和成本。 此时，用于简化增删改查工作量的 数据访问框架 ( <code>ORM</code> ) 是关键。</p>
<h4 id="1252-垂直应用架构"><a class="markdownIt-Anchor" href="#1252-垂直应用架构">#</a> 1.2.5.2 垂直应用架构</h4>
<p>当访问量逐渐增大，单一应用增加机器带来的加速度越来越小，将应用拆成互不相干的几个应用，以提升效率。此时，用于加速前端页面开发的  <code>Web</code>  框架 ( <code>MVC</code> ) 是关键。</p>
<h4 id="1253-分布式服务架构"><a class="markdownIt-Anchor" href="#1253-分布式服务架构">#</a> 1.2.5.3 分布式服务架构</h4>
<p>当垂直应用越来越多，应用之间交互不可避免，将核心业务抽取出来，作为独立的服务，逐渐形成稳定的服务中心，使前端应用能更快速的响应多变的市场需求。此时，用于提高业务复用及整合的 分布式服务框架 ( <code>RPC</code> ) 是关键。</p>
<h4 id="1254-流动计算架构"><a class="markdownIt-Anchor" href="#1254-流动计算架构">#</a> 1.2.5.4 流动计算架构</h4>
<p>当服务越来越多，容量的评估，小服务资源的浪费等问题逐渐显现，此时需增加一个调度中心基于访问压力实时管理集群容量，提高集群利用率。此时，用于提高机器利用率的 资源调度和治理中心 ( <code>SOA</code> ) 是关键。</p>
<h3 id="126-rpc的简介"><a class="markdownIt-Anchor" href="#126-rpc的简介">#</a> 1.2.6  <code>RPC</code>  的简介</h3>
<p><strong> <code>RPC(Remote Procedure Call Protocol)</code> ：远程过程调用</strong></p>
<p>两台服务器 <code>A、B</code> ，分别部署不同的应用 <code>a,b</code> 。当 <code>A</code>  服务器想要调用 <code>B</code>  服务器上应用 <code>b</code>  提供的函数或方法的时候，由于不在一个内存空间，不能直接调用，需要通过网络来表达调用的语义传达调用的数据。<br>
说白了，就是你在你的机器上写了一个程序，我这边是无法直接调用的，这个时候就出现了一个远程服务调用的概念。</p>
<p><code>RPC</code>  是一种通过网络从远程计算机程序上请求服务，而不需要了解底层网络技术的协议。 <code>RPC</code>  协议假定某些传输协议的存在，如 <code>TCP</code>  或 <code>UDP</code> ，为通信程序之间携带信息数据。在 <code>OSI</code>  网络通信模型中， <code>RPC</code>  跨越了传输层和应用层。 <code>RPC</code>  使得开发包括网络分布式多程序在内的应用程序更加容易。<br>
<strong> <code>RPC</code>  采用客户机 / 服务器模式</strong>。请求程序就是一个客户机，而服务提供程序就是一个服务器。首先，客户机调用进程发送一个有进程参数的调用信息到服务进程，然后等待应答信息。在服务器端，进程保持睡眠状态直到调用信息到达为止。当一个调用信息到达，服务器获得进程参数，计算结果，发送答复信息，然后等待下一个调用信息，最后，客户端调用进程接收答复信息，获得进程结果，然后调用执行继续进行。</p>
<h4 id="1261-rpc需要解决的问题"><a class="markdownIt-Anchor" href="#1261-rpc需要解决的问题">#</a> 1.2.6.1  <code>RPC</code>  需要解决的问题</h4>
<ul>
<li><strong>通讯问题</strong>：主要是通过在客户端和服务器之间建立 TCP 连接，远程过程调用的所有交换的数据都在这个连接里传输。连接可以是按需连接，调用结束后就断掉，也可以是长连接，多个远程过程调用共享同一个连接。</li>
<li><strong>寻址问题</strong>：A 服务器上的应用怎么告诉底层的 RPC 框架，如何连接到 B 服务器（如主机或 <code>IP</code>  地址）以及特定的端口，方法的名称名称是什么，这样才能完成调用。比如基于 <code>Web</code>  服务协议栈的 <code>RPC</code> ，就要提供一个 <code>endpoint URI</code> ，或者是从 <code>UDDI</code>  服务上查找。如果是 <code>RMI</code>  调用的话，还需要一个 <code>RMI Registry</code>  来注册服务的地址。</li>
<li><strong>序列化 与 反序列化</strong>：当 <code>A</code>  服务器上的应用发起远程过程调用时，方法的参数需要通过底层的网络协议如 <code>TCP</code>  传递到 <code>B</code>  服务器，由于网络协议是基于二进制的，内存中的参数的值要序列化成二进制的形式，也就是序列化（ <code>Serialize</code> ）或编组（ <code>marshal</code> ），通过寻址和传输将序列化的二进制发送给 <code>B</code>  服务器。<br>
同理， <code>B</code>  服务器接收参数要将参数反序列化。B 服务器应用调用自己的方法处理后返回的结果也要序列化给 <code>A</code>  服务器， <code>A</code>  服务器接收也要经过反序列化的过程。</li>
</ul>
<h2 id="13-dubbo作用"><a class="markdownIt-Anchor" href="#13-dubbo作用">#</a> 1.3  <code>Dubbo</code>  作用</h2>
<p>我们一起来看一下 <code>Dubbo</code>  的服务治理图：</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/b42b2f9c1b1e4c56b36ea55673c037fd.png" alt="在这里插入图片描述"></p>
<h3 id="131-为什么使用dubbo"><a class="markdownIt-Anchor" href="#131-为什么使用dubbo">#</a> 1.3.1 为什么使用 <code>Dubbo</code></h3>
<p>因为是阿里开源项目，国内很多互联网公司都在用，已经经过很多线上考验。内部使用了 <code>Netty、Zookeeper</code> ，保证了高性能高可用性。</p>
<ul>
<li><strong>使用 <code>Dubbo</code>  可以将核心业务抽取出来，作为独立的服务</strong>，逐渐形成稳定的服务中心，可用于提高业务复用灵活扩展，使前端应用能更快速的响应多变的市场需求。</li>
<li>分布式架构可以承受更大规模的并发流量。</li>
</ul>
<h3 id="132-dubbo能做什么"><a class="markdownIt-Anchor" href="#132-dubbo能做什么">#</a> 1.3.2  <code>Dubbo</code>  能做什么</h3>
<p>1、<strong>透明化的远程方法调用</strong>，就像调用本地方法一样调用远程方法，只需简单配置，没有任何 <code>API</code>  侵入。<br>
2、<strong>软负载均衡及容错机制</strong>，可在内网替代 <code>F5</code>  等硬件负载均衡器，降低成本，减少单点。<br>
3.、<strong>服务自动注册与发现</strong>，不再需要写死服务提供方地址，注册中心基于接口名查询服务提供者的 <code>IP</code>  地址，并且能够平滑添加或删除服务提供者。</p>
<p><strong> <code>Dubbo</code>  采用全 <code>Spring</code>  配置方式，透明化接入应用，对应用没有任何 <code>API</code>  侵入，只需用 <code>Spring</code>  加载 <code>Dubbo</code>  的配置即可</strong>， <code>Dubbo</code>  基于 <code>Spring</code>  的 <code>Schema</code>  扩展进行加载。</p>
<h2 id="14-dubbo-和-spring-cloud区别"><a class="markdownIt-Anchor" href="#14-dubbo-和-spring-cloud区别">#</a> 1.4  <code>Dubbo</code>  和  <code>Spring Cloud</code>  区别</h2>
<p>1、<strong>通信方式不同</strong>： <code>Dubbo</code>  使用的是  <code>RPC</code>  通信，而 <code>Spring Cloud</code>  使用的是 <code>HTTP RESTFul</code>  方式。<br>
2、<strong>组成不一样</strong>：</p>
<ul>
<li><code>dubbo</code>  的服务注册中心为 <code>Zookeerper</code> ，服务监控中心为 <code>dubbo-monitor</code> ，无消息总线、服务跟踪、批量任务等组件；</li>
<li><code>Spring Cloud</code>  的服务注册中心为 <code>spring-cloud netflix enruka</code> ，服务监控中心为 <code>spring-boot admin</code> ，有消息总线、数据流、服务跟踪、批量任务等组件；</li>
</ul>
<h2 id="15-dubbo技术架构"><a class="markdownIt-Anchor" href="#15-dubbo技术架构">#</a> 1.5  <code>Dubbo</code>  技术架构</h2>
<p>首先我们一起来看一下 <code>Dubbo</code>  官网提供的架构图：<br>
<img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/7792efd1449d4117b828af6c1022e089.png" alt="在这里插入图片描述"><br>
<strong>节点角色说明</strong></p>
<table>
<thead>
<tr>
<th>节点</th>
<th>角色说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Provider</td>
<td>暴露服务的服务提供方</td>
</tr>
<tr>
<td>Consumer</td>
<td>调用远程服务的服务消费方</td>
</tr>
<tr>
<td>Registry</td>
<td>服务注册与发现的注册中心</td>
</tr>
<tr>
<td>Monitor</td>
<td>统计服务的调用次数和调用时间的监控中心</td>
</tr>
<tr>
<td>Container</td>
<td>服务运行容器</td>
</tr>
</tbody>
</table>
<p>看了这几个概念后似乎发现其实 <code>Dubbo</code>  的架构也是很简单的 (其实现细节是复杂)，为什么这么说呢，有没有发现，其实很像<strong>生产者 - 消费者</strong>模型。只是在这种模型上，加上了<strong>注册中心和监控中心</strong>，用于管理提供方提供的 <code>url</code> ，以及管理整个过程。</p>
<p><strong>调用关系说明</strong></p>
<p>1、服务容器负责启动，加载，运行服务提供者。<br>
2、服务提供者在启动时，向注册中心注册自己提供的服务。<br>
3、服务消费者在启动时，向注册中心订阅自己所需的服务。<br>
4、注册中心返回服务提供者地址列表给消费者，如果有变更，注册中心将基于长连接推送变更数据给消费者。<br>
5、服务消费者，从提供者地址列表中，基于软负载均衡算法，选一台提供者进行调用，如果调用失败，再选另一台调用。<br>
6、服务消费者和提供者，在内存中累计调用次数和调用时间，定时每分钟发送一次统计数据到监控中心。</p>
<hr>
<p>那么，整个<strong>发布 - 订阅</strong>的过程就非常的简单了：</p>
<ul>
<li>启动容器，加载，运行服务提供者。</li>
<li>服务提供者在启动时，在注册中心发布注册自己提供的服务。</li>
<li>服务消费者在启动时，在注册中心订阅自己所需的服务。</li>
</ul>
<p>如果考虑<strong>失败或变更</strong>的情况，就需要考虑下面的过程：</p>
<ul>
<li>注册中心返回服务提供者地址列表给消费者，如果有变更，注册中心将基于长连接推送变更数据给消费者。</li>
<li>服务消费者，从提供者地址列表中，基于软负载均衡算法，选一台提供者进行调用，如果调用失败，再选另一台调用。</li>
<li>服务消费者和提供者，在内存中累计调用次数和调用时间，定时每分钟发送一次统计数据到监控中心。</li>
</ul>
<h2 id="16-dubbo入门案例"><a class="markdownIt-Anchor" href="#16-dubbo入门案例">#</a> 1.6  <code>Dubbo</code>  入门案例</h2>
<h3 id="161-服务端"><a class="markdownIt-Anchor" href="#161-服务端">#</a> 1.6.1 服务端</h3>
<p>首先，我们先把服务端的接口写好，因为其实 <code>dubbo</code>  的作用简单来说就是给消费端提供接口。</p>
<p><strong>接口定义</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * xml方式服务提供者接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ProviderService</span> &#123;</span><br><span class="line">    String <span class="title function_">SayHello</span><span class="params">(String word)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这个接口非常简单，只是包含一个  <code>SayHello</code>  的方法。</p>
<p>接着，定义它的<strong>实现类</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * xml方式服务提供者实现类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProviderServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">ProviderService</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">SayHello</span><span class="params">(String word)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> word;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样我们就把我们的接口写好了，那么我们应该怎么将我们的服务暴露出去呢？</p>
<p><strong>导入 maven 依赖</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.ouyangsihai<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo-provider<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/dubbo --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.zookeeper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zookeeper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.101tec<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zkclient<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.netty<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>netty-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.32.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.curator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>curator-framework<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.curator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>curator-recipes<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里使用的 <code>dubbo</code>  的版本是 <code>2.6.6</code> ，需要注意的是，如果你只导入 <code>dubbo</code>  的包的时候是会报错的，找不到 <code>netty</code>  和 <code>curator</code>  的依赖，所以，在这里我们需要把这两个的依赖加上，就不会报错了。</p>
<p>另外，这里我们使用  <code>zookeeper</code>  作为注册中心。</p>
<p>到目前为止， <code>dubbo</code>  需要的环境就已经可以了，下面，我们就把上面刚刚定义的接口暴露出去。</p>
<p><strong>暴露接口（ <code>xml</code>  配置方法）</strong><br>
首先，我们在我们项目的 <code>resource</code>  目录下创建  <code>META-INF.spring</code>  包，然后再创建  <code>provider.xml</code>  文件，名字可以任取哦，如下图所示</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/5b512b42ca2b41ed82fd82aaeee060dd.png" alt="在这里插入图片描述"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:dubbo</span>=<span class="string">&quot;http://code.alibabatech.com/schema/dubbo&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans.xsd        http://code.alibabatech.com/schema/dubbo        http://code.alibabatech.com/schema/dubbo/dubbo.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--当前项目在整个分布式架构里面的唯一名称，计算依赖关系的标签--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:application</span> <span class="attr">name</span>=<span class="string">&quot;provider&quot;</span> <span class="attr">owner</span>=<span class="string">&quot;sihai&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dubbo:parameter</span> <span class="attr">key</span>=<span class="string">&quot;qos.enable&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dubbo:parameter</span> <span class="attr">key</span>=<span class="string">&quot;qos.accept.foreign.ip&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dubbo:parameter</span> <span class="attr">key</span>=<span class="string">&quot;qos.port&quot;</span> <span class="attr">value</span>=<span class="string">&quot;55555&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dubbo:application</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:monitor</span> <span class="attr">protocol</span>=<span class="string">&quot;registry&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--dubbo这个服务所要暴露的服务地址所对应的注册中心--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;dubbo:registry address=&quot;N/A&quot;/&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">address</span>=<span class="string">&quot;N/A&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--当前服务发布所依赖的协议；webservice、Thrift、Hessain、http--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:protocol</span> <span class="attr">name</span>=<span class="string">&quot;dubbo&quot;</span> <span class="attr">port</span>=<span class="string">&quot;20880&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--服务发布的配置，需要暴露的服务接口--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:service</span></span></span><br><span class="line"><span class="tag">            <span class="attr">interface</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">ref</span>=<span class="string">&quot;providerService&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--Bean bean定义--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;providerService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderServiceImpl&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>说明：</p>
<p>1、上面的文件其实就是类似  <code>spring</code>  的配置文件，而且， <code>dubbo</code>  底层就是  <code>spring</code> 。<br>
2、节点： <code>dubbo:application</code> <br>
 就是整个项目在分布式架构中的唯一名称，可以在 <code>name</code>  属性中配置，另外还可以配置 <code>owner</code>  字段，表示属于谁。<br>
下面的参数是可以不配置的，这里配置是因为出现了端口的冲突，所以配置。<br>
3、节点： <code>dubbo:monitor</code> <br>
 监控中心配置， 用于配置连接监控中心相关信息，可以不配置，不是必须的参数。<br>
4、节点： <code>dubbo:registry</code> <br>
 配置注册中心的信息，比如，这里我们可以配置  <code>zookeeper</code>  作为我们的注册中心。 <code>address</code>  是注册中心的地址，这里我们配置的是  <code>N/A</code>  表示由  <code>dubbo</code>  自动分配地址。或者说是一种直连的方式，不通过注册中心。<br>
5、节点： <code>dubbo:protocol</code> <br>
 服务发布的时候  <code>dubbo</code>  依赖什么协议，可以配置 <code>dubbo</code> 、 <code>webservice</code> 、 <code>http</code>  等协议。<br>
6、节点： <code>dubbo:service</code> <br>
 这个节点就是我们的重点了，当我们服务发布的时候，我们就是通过这个配置将我们的服务发布出去的。 <code>interface</code>  是接口的包路径， <code>ref</code>  是第 ⑦ 点配置的接口的 <code>bean</code> 。<br>
7、最后，我们需要像配置 <code>spring</code>  的接口一样，配置接口的  <code>bean</code> 。</p>
<p>到这一步，关于服务端的配置就完成了，下面我们通过  <code>main</code>  方法将接口发布出去。</p>
<p><strong>发布接口</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sihai.dubbo.provider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.ApplicationConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.ProtocolConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.RegistryConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.ServiceConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.container.Main;</span><br><span class="line"><span class="keyword">import</span> com.sihai.dubbo.provider.service.ProviderService;</span><br><span class="line"><span class="keyword">import</span> com.sihai.dubbo.provider.service.ProviderServiceImpl;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * xml方式启动</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">( String[] args )</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//加载xml配置文件启动</span></span><br><span class="line">        <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;META-INF/spring/provider.xml&quot;</span>);</span><br><span class="line">        context.start();</span><br><span class="line">        System.in.read(); <span class="comment">// 按任意键退出</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发布接口非常简单，因为 <code>dubbo</code>  底层就是依赖  <code>spring</code>  的，所以，我们只需要通过  <code>ClassPathXmlApplicationContext</code>  拿到我们刚刚配置好的  <code>xml</code> ，然后调用  <code>context.start()</code>  方法就启动了。</p>
<p>看到下面的截图，就算是启动成功了，接口也就发布出去了。</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/fb50e61a90ab4e6c873323a7bac4d345.png" alt="在这里插入图片描述"><br>
你以为到这里就结束了了，并不是的，我们拿到  <code>dubbo</code>  暴露出去的  <code>url</code>  分析分析。</p>
<p><strong>Dubbo 暴露的 URL</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dubbo://192.168.234.1:20880/com.sihai.dubbo.provider.service.ProviderService?anyhost=true&amp;application=provider&amp;bean.name=com.sihai.dubbo.provider.service.ProviderService&amp;bind.ip=192.168.234.1&amp;bind.port=20880&amp;dubbo=2.0.2&amp;generic=false&amp;interface=com.sihai.dubbo.provider.service.ProviderService&amp;methods=SayHello&amp;owner=sihai&amp;pid=8412&amp;qos.accept.foreign.ip=false&amp;qos.enable=true&amp;qos.port=55555&amp;side=provider&amp;timestamp=1562077289380</span><br></pre></td></tr></table></figure>
<p>分析如下：</p>
<p>1、首先，在形式上我们发现，其实这么牛逼的  <code>dubbo</code>  也是用类似于  <code>http</code>  的协议发布自己的服务的，只是这里我们用的是 <code>dubbo</code>  协议。<br>
2、 <code>dubbo://192.168.234.1:20880/com.sihai.dubbo.provider.service.ProviderService</code> <br>
 上面这段链接就是  <code>?</code>  之前的链接，构成：<strong>协议://ip: 端口 / 接口</strong>。发现是不是也没有什么神秘的。<br>
3、 <code>anyhost=true&amp;application=provider&amp;bean.name=com.sihai.dubbo.provider.service.ProviderService&amp;bind.ip=192.168.234.1&amp;bind.port=20880&amp;dubbo=2.0.2&amp;generic=false&amp;interface=com.sihai.dubbo.provider.service.ProviderService&amp;methods=SayHello&amp;owner=sihai&amp;pid=8412&amp;qos.accept.foreign.ip=false&amp;qos.enable=true&amp;qos.port=55555&amp;side=provider&amp;timestamp=1562077289380</code> <br>
 <code>?</code>  之后的字符串，分析后你发现，这些都是刚刚在 <code>provider.xml</code>  中配置的字段，然后通过 <code>&amp;</code>  拼接而成的，闻到了  <code>http</code>  的香味了吗？</p>
<p>终于， <code>dubbo</code>  服务端入门了。下面我们看看拿到了  <code>url</code>  后，怎么消费呢？</p>
<h3 id="162-消费端"><a class="markdownIt-Anchor" href="#162-消费端">#</a> 1.6.2 消费端</h3>
<p>上面提到，我们在服务端提供的只是点对点的方式提供服务，并没有使用注册中心，所以，下面的配置也是会有一些不一样的。</p>
<p><strong>消费端环境配置</strong><br>
首先，我们在消费端的  <code>resource</code>  下建立配置文件  <code>consumer.xml</code></p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/e6964bf9a44b442ca792e91ca7e098b0.png" alt="在这里插入图片描述"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:dubbo</span>=<span class="string">&quot;http://code.alibabatech.com/schema/dubbo&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans.xsd        http://code.alibabatech.com/schema/dubbo        http://code.alibabatech.com/schema/dubbo/dubbo.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--当前项目在整个分布式架构里面的唯一名称，计算依赖关系的标签--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:application</span> <span class="attr">name</span>=<span class="string">&quot;consumer&quot;</span> <span class="attr">owner</span>=<span class="string">&quot;sihai&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--dubbo这个服务所要暴露的服务地址所对应的注册中心--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--点对点的方式--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">address</span>=<span class="string">&quot;N/A&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;dubbo:registry address=&quot;zookeeper://localhost:2181&quot; check=&quot;false&quot;/&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--生成一个远程服务的调用代理--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--点对点方式--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:reference</span> <span class="attr">id</span>=<span class="string">&quot;providerService&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">interface</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">url</span>=<span class="string">&quot;dubbo://192.168.234.1:20880/com.sihai.dubbo.provider.service.ProviderService&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--&lt;dubbo:reference id=&quot;providerService&quot;  </span></span><br><span class="line"><span class="comment">                    interface=&quot;com.sihai.dubbo.provider.service.ProviderService&quot;/&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>分析如下所示：</p>
<p>1、发现这里的  <code>dubbo:application</code>  和  <code>dubbo:registry</code>  是一致的<br>
 2、 <code>dubbo:reference</code>  ：我们这里采用点对点的方式，所以，需要配置在服务端暴露的  <code>url</code></p>
<p><strong>maven 依赖</strong><br>
和服务端一样</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.ouyangsihai<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo-consumer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.ouyangsihai<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo-provider<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/dubbo --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.zookeeper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zookeeper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.101tec<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zkclient<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.netty<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>netty-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.32.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.curator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>curator-framework<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.curator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>curator-recipes<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>调用服务</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sihai.dubbo.consumer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.ApplicationConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.ReferenceConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.RegistryConfig;</span><br><span class="line"><span class="keyword">import</span> com.sihai.dubbo.provider.service.ProviderService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * xml的方式调用</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">( String[] args )</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        ClassPathXmlApplicationContext context=<span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;consumer.xml&quot;</span>);</span><br><span class="line">        context.start();</span><br><span class="line">        <span class="type">ProviderService</span> <span class="variable">providerService</span> <span class="operator">=</span> (ProviderService) context.getBean(<span class="string">&quot;providerService&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> providerService.SayHello(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        System.out.println(str);</span><br><span class="line">        System.in.read();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里和服务端的发布如出一辙<br>
<img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/af173265c9fd4e72a6118916e5f4bf32.png" alt="在这里插入图片描述"><br>
如此，我们就成功调用接口了。</p>
<h2 id="17-加入zookeeper作为注册中心"><a class="markdownIt-Anchor" href="#17-加入zookeeper作为注册中心">#</a> 1.7 加入 <code>zookeeper</code>  作为注册中心</h2>
<p>在前面的案例中，我们没有使用任何的注册中心，而是用一种直连的方式进行的。但是，实际上很多时候，我们都是使用 <code>dubbo + zookeeper</code>  的方式，使用  <code>zookeeper</code>  作为注册中心，这里，我们就介绍一下  <code>zookeeper</code>  作为注册中心的使用方法。</p>
<p>这里，我们在前面的入门实例中进行改造。</p>
<h3 id="171-服务端"><a class="markdownIt-Anchor" href="#171-服务端">#</a> 1.7.1 服务端</h3>
<p>在服务端中，我们只需要修改 <code>provider.xml</code>  即可。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:dubbo</span>=<span class="string">&quot;http://code.alibabatech.com/schema/dubbo&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans.xsd        http://code.alibabatech.com/schema/dubbo        http://code.alibabatech.com/schema/dubbo/dubbo.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--当前项目在整个分布式架构里面的唯一名称，计算依赖关系的标签--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:application</span> <span class="attr">name</span>=<span class="string">&quot;provider&quot;</span> <span class="attr">owner</span>=<span class="string">&quot;sihai&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dubbo:parameter</span> <span class="attr">key</span>=<span class="string">&quot;qos.enable&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dubbo:parameter</span> <span class="attr">key</span>=<span class="string">&quot;qos.accept.foreign.ip&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dubbo:parameter</span> <span class="attr">key</span>=<span class="string">&quot;qos.port&quot;</span> <span class="attr">value</span>=<span class="string">&quot;55555&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dubbo:application</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:monitor</span> <span class="attr">protocol</span>=<span class="string">&quot;registry&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--dubbo这个服务所要暴露的服务地址所对应的注册中心--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;dubbo:registry address=&quot;N/A&quot;/&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">address</span>=<span class="string">&quot;zookeeper://localhost:2181&quot;</span> <span class="attr">check</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--当前服务发布所依赖的协议；webservice、Thrift、Hessain、http--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:protocol</span> <span class="attr">name</span>=<span class="string">&quot;dubbo&quot;</span> <span class="attr">port</span>=<span class="string">&quot;20880&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--服务发布的配置，需要暴露的服务接口--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:service</span></span></span><br><span class="line"><span class="tag">            <span class="attr">interface</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">ref</span>=<span class="string">&quot;providerService&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--Bean bean定义--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;providerService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderServiceImpl&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>重点关注这句话</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;dubbo:registry address=&quot;zookeeper://localhost:2181&quot; /&gt;</span><br></pre></td></tr></table></figure>
<p>在  <code>address</code>  中，使用我们的  <code>zookeeper</code>  的地址。</p>
<p>如果是 <code>zookeeper</code>  集群的话，使用下面的方式。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;dubbo:registry protocol=&quot;zookeeper&quot; address=&quot;192.168.11.129:2181,192.168.11.137:2181,192.168.11.138:2181&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p>服务端的配置就好了，其他的跟 入门案例 一样。</p>
<h3 id="172-消费端"><a class="markdownIt-Anchor" href="#172-消费端">#</a> 1.7.2 消费端</h3>
<p>跟服务端一样，在消费端，我们也只需要修改  <code>consumer.xml</code>  即可。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:dubbo</span>=<span class="string">&quot;http://code.alibabatech.com/schema/dubbo&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans.xsd        http://code.alibabatech.com/schema/dubbo        http://code.alibabatech.com/schema/dubbo/dubbo.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--当前项目在整个分布式架构里面的唯一名称，计算依赖关系的标签--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:application</span> <span class="attr">name</span>=<span class="string">&quot;consumer&quot;</span> <span class="attr">owner</span>=<span class="string">&quot;sihai&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--dubbo这个服务所要暴露的服务地址所对应的注册中心--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--点对点的方式--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;dubbo:registry address=&quot;N/A&quot; /&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">address</span>=<span class="string">&quot;zookeeper://localhost:2181&quot;</span> <span class="attr">check</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--生成一个远程服务的调用代理--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--点对点方式--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;dubbo:reference id=&quot;providerService&quot;</span></span><br><span class="line"><span class="comment">                     interface=&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span></span><br><span class="line"><span class="comment">                     url=&quot;dubbo://192.168.234.1:20880/com.sihai.dubbo.provider.service.ProviderService&quot;/&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:reference</span> <span class="attr">id</span>=<span class="string">&quot;providerService&quot;</span></span></span><br><span class="line"><span class="tag">                     <span class="attr">interface</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>1、注册中心配置跟服务端一样</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;dubbo:registry address=&quot;zookeeper://localhost:2181&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p>2、 <code>dubbo:reference</code> <br>
 由于我们这里使用  <code>zookeeper</code>  作为注册中心，所以，跟点对点的方式是不一样的，这里不再需要  <code>dubbo</code>  服务端提供的 url 了，只需要直接引用服务端提供的接口即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;dubbo:reference id=&quot;providerService&quot;</span><br><span class="line">                     interface=&quot;com.sihai.dubbo.provider.service.ProviderService&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p>好了，消费端也配置好了，这样就可以使用修改的入门案例，重新启动运行了。</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/7a5a1b4a974a48ceb5aa80f1d516f5f4.png" alt="在这里插入图片描述"><br>
同样成功了。</p>
<p>这时候的区别在于，<strong>将  <code>dubbo</code>  发布的 <code>url</code>  注册到了  <code>zookeeper</code> ，消费端从  <code>zookeeper</code>  消费， <code>zookeeper</code>  相当于一个中介，给消费者提供服务</strong>。</p>
<p>你以为这就完了？不，好戏才刚刚开始呢。</p>
<h2 id="18-多种配置方式"><a class="markdownIt-Anchor" href="#18-多种配置方式">#</a> 1.8 多种配置方式</h2>
<p>在入门实例的时候，我们使用的是  <code>xml</code>  配置的方式，对  <code>dubbo</code>  的环境进行了配置，但是，官方还提供了其他的配置方式，这里我们也一一分解。</p>
<h3 id="181-api配置方式"><a class="markdownIt-Anchor" href="#181-api配置方式">#</a> 1.8.1  <code>API</code>  配置方式</h3>
<p>这种方式其实官方是不太推荐的，官方推荐使用 <code>xml</code>  配置的方式，但是，在有的时候测试的时候，还是可以用的到的，另外，为了保证完整性，这些内容还是有必要讲讲的。</p>
<p>首先还是回到服务端工程。</p>
<p><strong>服务端</strong><br>
<img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/e0f491e8de154c93b814e9e87df52f54.png" alt="在这里插入图片描述"><br>
这里我们使用  <code>api</code>  的方式配置，所以， <code>provider.xml</code>  这个配置文件就暂时不需要了，我们只需要在上面的  <code>AppApi</code>  这个类中的  <code>main</code>  方法中用 <code>api</code>  配置及启动即可。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sihai.dubbo.provider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.ApplicationConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.ProtocolConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.RegistryConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.ServiceConfig;</span><br><span class="line"><span class="keyword">import</span> com.sihai.dubbo.provider.service.ProviderService;</span><br><span class="line"><span class="keyword">import</span> com.sihai.dubbo.provider.service.ProviderServiceImpl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Api方式启动</span></span><br><span class="line"><span class="comment"> * api的方式调用不需要其他的配置，只需要下面的代码即可。</span></span><br><span class="line"><span class="comment"> * 但是需要注意，官方建议：</span></span><br><span class="line"><span class="comment"> * Api方式用于测试用例使用，推荐xml的方式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppApi</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">( String[] args )</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 服务实现</span></span><br><span class="line">        <span class="type">ProviderService</span> <span class="variable">providerService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProviderServiceImpl</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 当前应用配置</span></span><br><span class="line">        <span class="type">ApplicationConfig</span> <span class="variable">application</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ApplicationConfig</span>();</span><br><span class="line">        application.setName(<span class="string">&quot;provider&quot;</span>);</span><br><span class="line">        application.setOwner(<span class="string">&quot;sihai&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 连接注册中心配置</span></span><br><span class="line">        <span class="type">RegistryConfig</span> <span class="variable">registry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RegistryConfig</span>();</span><br><span class="line">        registry.setAddress(<span class="string">&quot;zookeeper://localhost:2181&quot;</span>);</span><br><span class="line"><span class="comment">//        registry.setUsername(&quot;aaa&quot;);</span></span><br><span class="line"><span class="comment">//        registry.setPassword(&quot;bbb&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 服务提供者协议配置</span></span><br><span class="line">        <span class="type">ProtocolConfig</span> <span class="variable">protocol</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProtocolConfig</span>();</span><br><span class="line">        protocol.setName(<span class="string">&quot;dubbo&quot;</span>);</span><br><span class="line">        protocol.setPort(<span class="number">20880</span>);</span><br><span class="line">        <span class="comment">//protocol.setThreads(200);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 注意：ServiceConfig为重对象，内部封装了与注册中心的连接，</span></span><br><span class="line">        <span class="comment">//以及开启服务端口</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 服务提供者暴露服务配置</span></span><br><span class="line">        <span class="comment">// 此实例很重，封装了与注册中心的连接，请自行缓存，</span></span><br><span class="line">        <span class="comment">//否则可能造成内存和连接泄漏</span></span><br><span class="line">        ServiceConfig&lt;ProviderService&gt; service = <span class="keyword">new</span> <span class="title class_">ServiceConfig</span>&lt;ProviderService&gt;(); </span><br><span class="line">        service.setApplication(application);</span><br><span class="line">        <span class="comment">// 多个注册中心可以用setRegistries()</span></span><br><span class="line">        service.setRegistry(registry); </span><br><span class="line">        <span class="comment">// 多个协议可以用setProtocols()</span></span><br><span class="line">        service.setProtocol(protocol); </span><br><span class="line">        service.setInterface(ProviderService.class);</span><br><span class="line">        service.setRef(providerService);</span><br><span class="line">        service.setVersion(<span class="string">&quot;1.0.0&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 暴露及注册服务</span></span><br><span class="line">        service.export();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析说明如下所示：</p>
<p>看到上面的代码是不是云里雾里，不要慌，我们通过对照  <code>xml</code>  的方式分析一下。</p>
<p><strong>registry 的 xml 方式</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;dubbo:registry protocol=&quot;zookeeper&quot; address=&quot;localhost:2181&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p><strong>API 的方式</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">RegistryConfig</span> <span class="variable">registry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RegistryConfig</span>();</span><br><span class="line">registry.setAddress(<span class="string">&quot;zookeeper://localhost:2181&quot;</span>);</span><br></pre></td></tr></table></figure>
<p><code>dubbo:registry</code>  节点对应 <code>RegistryConfig</code>  ， <code>xml</code>  的属性对应  <code>API</code>  方式用  <code>set</code>  方法就可以了。对比之下，你就会发现，如果  <code>API</code>  的方式不熟悉，可以对照 <code>xml</code>  配置方式就可以。</p>
<p><strong>其他 API</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">org.apache.dubbo.config.ServiceConfig</span><br><span class="line">org.apache.dubbo.config.ReferenceConfig</span><br><span class="line">org.apache.dubbo.config.ProtocolConfig</span><br><span class="line">org.apache.dubbo.config.RegistryConfig</span><br><span class="line">org.apache.dubbo.config.MonitorConfig</span><br><span class="line">org.apache.dubbo.config.ApplicationConfig</span><br><span class="line">org.apache.dubbo.config.ModuleConfig</span><br><span class="line">org.apache.dubbo.config.ProviderConfig</span><br><span class="line">org.apache.dubbo.config.ConsumerConfig</span><br><span class="line">org.apache.dubbo.config.MethodConfig</span><br><span class="line">org.apache.dubbo.config.ArgumentConfig</span><br></pre></td></tr></table></figure>
<p>更详细的可以查看官方文档：</p>
<blockquote>
<p>http://<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=dubbo&amp;spm=1001.2101.3001.7020">dubbo</a>.apache.org/zh-cn…</p>
</blockquote>
<p>我们再看看我配置的消费端的 <code>Api</code>  方式。</p>
<p><strong>消费端</strong><br>
同样，我们不需要  <code>consumer.xml</code>  配置文件了，只需要在  <code>main</code>  方法中启动即可。</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/99006e3f58d0417dbf27fa7068633b05.png" alt="在这里插入图片描述"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sihai.dubbo.consumer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.ApplicationConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.ReferenceConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.RegistryConfig;</span><br><span class="line"><span class="keyword">import</span> com.sihai.dubbo.provider.service.ProviderService;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * api的方式调用</span></span><br><span class="line"><span class="comment"> * api的方式调用不需要其他的配置，只需要下面的代码即可。</span></span><br><span class="line"><span class="comment"> * 但是需要注意，官方建议：</span></span><br><span class="line"><span class="comment"> * Api方式用于测试用例使用，推荐xml的方式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppApi</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 当前应用配置</span></span><br><span class="line">        <span class="type">ApplicationConfig</span> <span class="variable">application</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ApplicationConfig</span>();</span><br><span class="line">        application.setName(<span class="string">&quot;consumer&quot;</span>);</span><br><span class="line">        application.setOwner(<span class="string">&quot;sihai&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 连接注册中心配置</span></span><br><span class="line">        <span class="type">RegistryConfig</span> <span class="variable">registry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RegistryConfig</span>();</span><br><span class="line">        registry.setAddress(<span class="string">&quot;zookeeper://localhost:2181&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 注意：ReferenceConfig为重对象，内部封装了与注册中心的连接，</span></span><br><span class="line">        <span class="comment">//以及与服务提供方的连接</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 引用远程服务</span></span><br><span class="line">        ReferenceConfig&lt;ProviderService&gt; reference = <span class="keyword">new</span> <span class="title class_">ReferenceConfig</span>&lt;ProviderService&gt;(); <span class="comment">// 此实例很重，封装了与注册中心的连接以及与提供者的连接，请自行缓存，否则可能造成内存和连接泄漏</span></span><br><span class="line">        reference.setApplication(application);</span><br><span class="line">        reference.setRegistry(registry); <span class="comment">// 多个注册中心可以用setRegistries()</span></span><br><span class="line">        reference.setInterface(ProviderService.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 和本地bean一样使用xxxService</span></span><br><span class="line">        <span class="type">ProviderService</span> <span class="variable">providerService</span> <span class="operator">=</span> reference.get(); <span class="comment">// 注意：此代理对象内部封装了所有通讯细节，对象较重，请缓存复用</span></span><br><span class="line">        providerService.SayHello(<span class="string">&quot;hello dubbo! I am sihai!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这部分的  <code>API</code>  配置的方式就到这了，注意：官方推荐  <code>xml</code>  的配置方法</p>
<h3 id="182-注解配置方式"><a class="markdownIt-Anchor" href="#182-注解配置方式">#</a> 1.8.2 注解配置方式</h3>
<p>注解配置方式还是需要了解一下的，现在微服务都倾向于这种方式，这也是以后发展的趋势， <code>0</code>  配置应该是这几年的趋势。</p>
<p>那么如何对 <code>dubbo</code>  使用注解的方式呢？我们先看服务端。</p>
<p><strong>服务端</strong><br>
<img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/1ad33df6d381480793d65ee4212b5ea6.png" alt="在这里插入图片描述"><br>
<strong>第一步：定义接口及实现类，在上面的截图中的  <code>annotation</code>  包下</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sihai.dubbo.provider.service.annotation;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 注解方式接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ProviderServiceAnnotation</span> &#123;</span><br><span class="line">    String <span class="title function_">SayHelloAnnotation</span><span class="params">(String word)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sihai.dubbo.provider.service.annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.annotation.Service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 注解方式实现类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service(timeout = 5000)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProviderServiceImplAnnotation</span> <span class="keyword">implements</span> <span class="title class_">ProviderServiceAnnotation</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">SayHelloAnnotation</span><span class="params">(String word)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> word;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>@Service</strong></p>
<p><code>@Service</code>  用来配置  <code>Dubbo</code>  的服务提供方。</p>
<p><strong>第二步：组装服务提供方</strong>。通过  <code>Spring</code>  中  <code>Java Config</code>  的技术（ <code>@Configuration</code> ）和  <code>annotation</code>  扫描（ <code>@EnableDubbo</code> ）来发现、组装、并向外提供 <code>Dubbo</code>  的服务。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sihai.dubbo.provider.configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.ApplicationConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.ProtocolConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.ProviderConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.RegistryConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.spring.context.annotation.EnableDubbo;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 注解方式配置</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableDubbo(scanBasePackages = &quot;com.sihai.dubbo.provider.service.annotation&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DubboConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span> <span class="comment">// #1 服务提供者信息配置</span></span><br><span class="line">    <span class="keyword">public</span> ProviderConfig <span class="title function_">providerConfig</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ProviderConfig</span> <span class="variable">providerConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProviderConfig</span>();</span><br><span class="line">        providerConfig.setTimeout(<span class="number">1000</span>);</span><br><span class="line">        <span class="keyword">return</span> providerConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span> <span class="comment">// #2 分布式应用信息配置</span></span><br><span class="line">    <span class="keyword">public</span> ApplicationConfig <span class="title function_">applicationConfig</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ApplicationConfig</span> <span class="variable">applicationConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ApplicationConfig</span>();</span><br><span class="line">        applicationConfig.setName(<span class="string">&quot;dubbo-annotation-provider&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> applicationConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span> <span class="comment">// #3 注册中心信息配置</span></span><br><span class="line">    <span class="keyword">public</span> RegistryConfig <span class="title function_">registryConfig</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">RegistryConfig</span> <span class="variable">registryConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RegistryConfig</span>();</span><br><span class="line">        registryConfig.setProtocol(<span class="string">&quot;zookeeper&quot;</span>);</span><br><span class="line">        registryConfig.setAddress(<span class="string">&quot;localhost&quot;</span>);</span><br><span class="line">        registryConfig.setPort(<span class="number">2181</span>);</span><br><span class="line">        <span class="keyword">return</span> registryConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span> <span class="comment">// #4 使用协议配置，这里使用 dubbo</span></span><br><span class="line">    <span class="keyword">public</span> ProtocolConfig <span class="title function_">protocolConfig</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ProtocolConfig</span> <span class="variable">protocolConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProtocolConfig</span>();</span><br><span class="line">        protocolConfig.setName(<span class="string">&quot;dubbo&quot;</span>);</span><br><span class="line">        protocolConfig.setPort(<span class="number">20880</span>);</span><br><span class="line">        <span class="keyword">return</span> protocolConfig;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析说明如下：<br>
1、通过  <code>@EnableDubbo</code>  指定在 <code>com.sihai.dubbo.provider.service.annotation</code>  下扫描所有标注有  <code>@Service</code>  的类</p>
<p>2、通过  <code>@Configuration</code>  将  <code>DubboConfiguration</code>  中所有的  <code>@Bean</code>  通过 <code>Java Config</code>  的方式组装出来并注入给  <code>Dubbo</code>  服务，也就是标注有 <code>@Service</code>  的类。</p>
<p>这其中就包括了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ProviderConfig：服务提供方配置</span><br><span class="line">ApplicationConfig：应用配置</span><br><span class="line">RegistryConfig：注册中心配置</span><br><span class="line">ProtocolConfig：协议配置</span><br></pre></td></tr></table></figure>
<p>看起来很复杂，其实。。。<br>
<img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/7a607c56fd774c65acf83b23b10bc831.png" alt="在这里插入图片描述"><br>
<strong>第三步：启动服务</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sihai.dubbo.provider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.spring.context.annotation.DubboComponentScan;</span><br><span class="line"><span class="keyword">import</span> com.sihai.dubbo.provider.configuration.DubboConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"><span class="keyword">import</span> sun.applet.Main;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 注解启动方式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppAnnotation</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(DubboConfiguration.class); </span><br><span class="line">        context.start();</span><br><span class="line">        System.in.read(); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现输出下面信息就表示  <code>success</code>  了</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/5f2fc6b4d06b48fea91f16dfb130eb70.png" alt="在这里插入图片描述"><br>
<strong>消费端</strong></p>
<p>同样我们下看看消费端的工程，有一个感性认识。</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/0ff7a379a9df48e5a08f4669871a8832.png" alt="在这里插入图片描述"><br>
<strong>第一步：引用服务</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sihai.dubbo.consumer.Annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.annotation.Reference;</span><br><span class="line"><span class="keyword">import</span> com.sihai.dubbo.provider.service.annotation.ProviderServiceAnnotation;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 注解方式的service</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component(&quot;annotatedConsumer&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerAnnotationService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Reference</span></span><br><span class="line">    <span class="keyword">private</span> ProviderServiceAnnotation providerServiceAnnotation;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">doSayHello</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> providerServiceAnnotation.SayHelloAnnotation(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在  <code>ConsumerAnnotationService</code>  类中，通过  <code>@Reference</code>  引用服务端提供的类，然后通过方法调用这个类的方式，给消费端提供接口。</p>
<p>注意：如果这里找不到  <code>ProviderServiceAnnotation</code>  类，请在服务端先把服务端工程用  <code>Maven intall</code>  一下，然后将服务端的依赖放到消费端的 <code>pom</code>  中。如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">          &lt;groupId&gt;com.ouyangsihai&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;dubbo-provider&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>解释一下：引入的 <code>jar</code>  包里面只是未被实现的接口， <code>rpc</code>  需要在客户端服务端定义一套统一的接口，然后在服务端实现接口，实际上还是网络通信，只不过长得像本地实现</p>
<p><strong>第二步：组装服务消费者</strong></p>
<p>这一步和服务端是类似的，这里就不在重复了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sihai.dubbo.consumer.configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.ApplicationConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.ConsumerConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.RegistryConfig;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.dubbo.config.spring.context.annotation.EnableDubbo;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 注解配置类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableDubbo(scanBasePackages = &quot;com.sihai.dubbo.consumer.Annotation&quot;)</span></span><br><span class="line"><span class="meta">@ComponentScan(value = &#123;&quot;com.sihai.dubbo.consumer.Annotation&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerConfiguration</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span> <span class="comment">// 应用配置</span></span><br><span class="line">    <span class="keyword">public</span> ApplicationConfig <span class="title function_">applicationConfig</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ApplicationConfig</span> <span class="variable">applicationConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ApplicationConfig</span>();</span><br><span class="line">        applicationConfig.setName(<span class="string">&quot;dubbo-annotation-consumer&quot;</span>);</span><br><span class="line">        Map&lt;String, String&gt; stringStringMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, String&gt;();</span><br><span class="line">        stringStringMap.put(<span class="string">&quot;qos.enable&quot;</span>,<span class="string">&quot;true&quot;</span>);</span><br><span class="line">        stringStringMap.put(<span class="string">&quot;qos.accept.foreign.ip&quot;</span>,<span class="string">&quot;false&quot;</span>);</span><br><span class="line">        stringStringMap.put(<span class="string">&quot;qos.port&quot;</span>,<span class="string">&quot;33333&quot;</span>);</span><br><span class="line">        applicationConfig.setParameters(stringStringMap);</span><br><span class="line">        <span class="keyword">return</span> applicationConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span> <span class="comment">// 服务消费者配置</span></span><br><span class="line">    <span class="keyword">public</span> ConsumerConfig <span class="title function_">consumerConfig</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ConsumerConfig</span> <span class="variable">consumerConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConsumerConfig</span>();</span><br><span class="line">        consumerConfig.setTimeout(<span class="number">3000</span>);</span><br><span class="line">        <span class="keyword">return</span> consumerConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span> <span class="comment">// 配置注册中心</span></span><br><span class="line">    <span class="keyword">public</span> RegistryConfig <span class="title function_">registryConfig</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">RegistryConfig</span> <span class="variable">registryConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RegistryConfig</span>();</span><br><span class="line">        registryConfig.setProtocol(<span class="string">&quot;zookeeper&quot;</span>);</span><br><span class="line">        registryConfig.setAddress(<span class="string">&quot;localhost&quot;</span>);</span><br><span class="line">        registryConfig.setPort(<span class="number">2181</span>);</span><br><span class="line">        <span class="keyword">return</span> registryConfig;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>第三步：发起远程调用</strong></p>
<p>在 <code>main</code>  方法中通过启动一个 <code>Spring Context</code> ，从其中查找到组装好的 <code>Dubbo</code>  的服务消费者，并发起一次<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E8%BF%9C%E7%A8%8B%E8%B0%83%E7%94%A8&amp;spm=1001.2101.3001.7020">远程调用</a>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sihai.dubbo.consumer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sihai.dubbo.consumer.Annotation.ConsumerAnnotationService;</span><br><span class="line"><span class="keyword">import</span> com.sihai.dubbo.consumer.configuration.ConsumerConfiguration;</span><br><span class="line"><span class="keyword">import</span> com.sihai.dubbo.provider.service.ProviderService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 注解方式启动</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppAnnotation</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">( String[] args )</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(ConsumerConfiguration.class); </span><br><span class="line">        context.start(); <span class="comment">// 启动</span></span><br><span class="line">        <span class="type">ConsumerAnnotationService</span> <span class="variable">consumerAnnotationService</span> <span class="operator">=</span> context.getBean(ConsumerAnnotationService.class); </span><br><span class="line">        <span class="type">String</span> <span class="variable">hello</span> <span class="operator">=</span> consumerAnnotationService.doSayHello(<span class="string">&quot;annotation&quot;</span>); <span class="comment">// 调用方法</span></span><br><span class="line">        System.out.println(<span class="string">&quot;result: &quot;</span> + hello); <span class="comment">// 输出结果</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/994174d242d84c92a8eb2489b6bc8930.png" alt="在这里插入图片描述"></p>
<h2 id="19-常用场景"><a class="markdownIt-Anchor" href="#19-常用场景">#</a> 1.9 常用场景</h2>
<p>在下面的讲解中，都会是以 <code>xml</code>  配置的方式来讲解的，这也是 <code>dubbo</code>  官方比较推荐的方式。以下的操作都是在服务端的  <code>xml</code>  配置文件和消费端的配置文件来讲解的。</p>
<h3 id="191-启动时检查"><a class="markdownIt-Anchor" href="#191-启动时检查">#</a> 1.9.1 启动时检查</h3>
<p><code>Dubbo</code>  缺省会在启动时检查依赖的服务是否可用，不可用时会抛出异常，阻止  <code>Spring</code>  初始化完成，以便上线时，能及早发现问题，默认 <code>check=&quot;true&quot;</code> 。</p>
<p>但是，有的时候，我们并不是都需要启动时就检查的，比如测试的时候，我们是需要更快速的启动，所以，这种场景的时候，我们是需要关闭这个功能的。</p>
<p>下面，我们看看如何使用这个功能。</p>
<p>在服务端注册的时候（客户端注册时同样适用）；</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">protocol</span>=<span class="string">&quot;zookeeper&quot;</span> <span class="attr">address</span>=<span class="string">&quot;localhost:2181,localhost:2182,localhost:2183&quot;</span> <span class="attr">check</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>在客户端引用服务端服务的时候；</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dubbo:reference</span> <span class="attr">check</span>=<span class="string">&quot;false&quot;</span> <span class="attr">id</span>=<span class="string">&quot;providerService&quot;</span></span></span><br><span class="line"><span class="tag">                     <span class="attr">interface</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>就是这么简单，就是这么强！</p>
<h3 id="192-集群容错"><a class="markdownIt-Anchor" href="#192-集群容错">#</a> 1.9.2 集群容错</h3>
<p><code>dubbo</code>  也是支持集群容错的，同时也有很多可选的方案，其中，默认的方案是  <code>failover</code> ，也就是重试机制。</p>
<p>首先，我们先把所有的容错机制都整理一遍，然后再看看使用。</p>
<table>
<thead>
<tr>
<th>集群模式</th>
<th>说明</th>
<th>使用方法</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Failover Cluster</code></td>
<td>失败自动切换，当出现失败，重试其它服务器。通常用于读操作，但重试会带来更长延迟。可通过 <code>retries=&quot;2&quot;</code>  来设置重试次数 (不含第一次)。</td>
<td><code>cluster=&quot;xxx&quot;</code> xxx：集群模式名称 ，例如 <code>cluster=&quot;failover&quot;</code></td>
</tr>
<tr>
<td><code>Failfast Cluster</code></td>
<td>快速失败，只发起一次调用，失败立即报错。通常用于非幂等性的写操作，比如新增记录。</td>
<td></td>
</tr>
<tr>
<td><code>Failsafe Cluster</code></td>
<td>失败安全，出现异常时，直接忽略。</td>
<td></td>
</tr>
<tr>
<td><code>Failback Cluster</code></td>
<td>失败自动恢复，后台记录失败请求，定时重发。通常用于消息通知操作。</td>
<td></td>
</tr>
<tr>
<td><code>Forking Cluster</code></td>
<td>并行调用多个服务器，只要一个成功即返回。通常用于实时性要求较高的读操作，但需要浪费更多服务资源。可通过 <code>forks=&quot;2&quot;</code>  来设置最大并行数。</td>
<td></td>
</tr>
<tr>
<td><code>Broadcast Cluster</code></td>
<td>广播调用所有提供者，逐个调用，任意一台报错则报错。通常用于通知所有提供者更新缓存或日志等本地资源信息。</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>使用实例</strong><br>
在发布服务或者引用服务的时候设置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--服务发布的配置，需要暴露的服务接口--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">cluster</span>=<span class="string">&quot;failover&quot;</span> <span class="attr">retries</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">interface</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">ref</span>=<span class="string">&quot;providerService&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dubbo:reference</span> <span class="attr">cluster</span>=<span class="string">&quot;failover&quot;</span> <span class="attr">retries</span>=<span class="string">&quot;2&quot;</span> <span class="attr">check</span>=<span class="string">&quot;false&quot;</span> <span class="attr">id</span>=<span class="string">&quot;providerService&quot;</span></span></span><br><span class="line"><span class="tag">                     <span class="attr">interface</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="193-负载均衡"><a class="markdownIt-Anchor" href="#193-负载均衡">#</a> 1.9.3 负载均衡</h3>
<p>负载均衡想必是一个再熟悉不过的概念了，所以， <code>dubbo</code>  支持也是再正常不过了，这里也总结一下 <code>dubbo</code>  支持的负载均衡的一些方案及使用方法。</p>
<table>
<thead>
<tr>
<th>负载均衡模式</th>
<th>说明</th>
<th>使用方法</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Random LoadBalance</code></td>
<td>随机 按权重设置随机概率</td>
<td><code>&lt;dubbo:service loadbalance=&quot;xxx&quot;/&gt;</code> xxx：负载均衡方法</td>
</tr>
<tr>
<td><code>RoundRobin LoadBalance</code></td>
<td>轮询 按公约后的权重设置轮询比率。</td>
<td></td>
</tr>
<tr>
<td><code>LeastActive LoadBalance</code></td>
<td>最少活跃调用数 相同活跃数的随机，活跃数指调用前后计数差。</td>
<td></td>
</tr>
<tr>
<td><code>ConsistentHash LoadBalance</code></td>
<td>一致性  <code>Hash</code>  相同参数的请求总是发到同一提供者。 当某一台提供者挂时，原本发往该提供者的请求，基于虚拟节点，平摊到其它提供者，不会引起剧烈变动。</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="194-直连提供者"><a class="markdownIt-Anchor" href="#194-直连提供者">#</a> 1.9.4 直连提供者</h3>
<p>在开发及测试环境下，经常需要绕过注册中心，只测试指定服务提供者，所以，这种情况下，我们只需要直接连接服务端的地即可，其实，这种方法在前面的讲解已经使用到了，第一种讲解的方式就是这种方式，因为这种方式简单。</p>
<p>使用方法如下所示：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dubbo:reference</span> <span class="attr">id</span>=<span class="string">&quot;providerService&quot;</span></span></span><br><span class="line"><span class="tag">                     <span class="attr">interface</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span></span></span><br><span class="line"><span class="tag">                     <span class="attr">url</span>=<span class="string">&quot;dubbo://192.168.234.1:20880/com.sihai.dubbo.provider.service.ProviderService&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>说明：可以看到，只要在消费端在・ <code>dubbo:reference</code>  节点使用 <code>url</code>  给出服务端的方法即可。</p>
<h3 id="195-只订阅"><a class="markdownIt-Anchor" href="#195-只订阅">#</a> 1.9.5 只订阅</h3>
<p>只订阅就是只能够订阅服务端的服务，而不能够注册。</p>
<p>引用官方的使用场景如下：</p>
<blockquote>
<p>为方便开发测试，经常会在线下共用一个所有服务可用的注册中心，这时，如果一个正在开发中的服务提供者注册，可能会影响消费者不能正常运行。<br>
可以让服务提供者开发方，只订阅服务 (开发的服务可能依赖其它服务)，而不注册正在开发的服务，通过直连测试正在开发的服务。</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">register</span>=<span class="string">&quot;false&quot;</span> <span class="attr">protocol</span>=<span class="string">&quot;zookeeper&quot;</span> <span class="attr">address</span>=<span class="string">&quot;localhost:2181,localhost:2182,localhost:2183&quot;</span> <span class="attr">check</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>1、使用只订阅方式<br>
当在服务提供端使用  <code>register=&quot;false&quot;</code>  的时候，我们使用下面的方式获取服务端的服务；</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dubbo:reference</span> <span class="attr">cluster</span>=<span class="string">&quot;failover&quot;</span> <span class="attr">retries</span>=<span class="string">&quot;2&quot;</span> <span class="attr">check</span>=<span class="string">&quot;false&quot;</span> <span class="attr">id</span>=<span class="string">&quot;providerService&quot;</span></span></span><br><span class="line"><span class="tag">                     <span class="attr">interface</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>启动信息</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/82d1dafceb4d4562a5bf143dd1bcaed9.png" alt="在这里插入图片描述"><br>
发现，这时候并不是向注册中心  <code>zookeeper</code>  注册，而只是做了发布服务和启动 <code>netty</code> 。</p>
<p>2、不使用只订阅方式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;dubbo:registry protocol=<span class="string">&quot;zookeeper&quot;</span> address=<span class="string">&quot;localhost:2181,localhost:2182,localhost:2183&quot;</span> check=<span class="string">&quot;false&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>
<p>启动信息</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/752b5bf0d635420980b39495b8bf029d.png" alt="在这里插入图片描述"><br>
可以发现，这里就向注册中心  <code>zookeeper</code>  注册了。</p>
<h3 id="196-只注册"><a class="markdownIt-Anchor" href="#196-只注册">#</a> 1.9.6 只注册</h3>
<p>只注册正好跟前面的只订阅相反，这个时候可以向注册中心注册，但是，消费端却不能够读到服务。</p>
<p><strong>应用场景</strong></p>
<blockquote>
<p>如果有两个镜像环境，两个注册中心，有一个服务只在其中一个注册中心有部署，另一个注册中心还没来得及部署，而两个注册中心的其它应用都需要依赖此服务。这个时候，可以让服务提供者方只注册服务到另一注册中心，而不从另一注册中心订阅服务。</p>
</blockquote>
<p><strong>使用说明</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">subscribe</span>=<span class="string">&quot;false&quot;</span> <span class="attr">address</span>=<span class="string">&quot;localhost:2181&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">dubbo:registry</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在服务端的  <code>dubbo:registry</code>  节点下使用  <code>subscribe=&quot;false&quot;</code>  来声明这个服务是只注册的服务。</p>
<p>这个时候消费端调用的时候是不能调用的。</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/272a429bc9a547108334d08a1188e774.png" alt="在这里插入图片描述"></p>
<h3 id="197-多协议机制"><a class="markdownIt-Anchor" href="#197-多协议机制">#</a> 1.9.7 多协议机制</h3>
<p>在前面我们使用的协议都是  <code>dubbo</code>  协议，但是  <code>dubbo</code>  除了支持这种协议外还支持其他的协议，比如， <code>rmi、hessian</code>  等，另外，而且还可以用多种协议同时暴露一种服务。</p>
<p><strong>使用方法</strong></p>
<p><strong>1、一种接口使用一种协议</strong></p>
<p>先声明多种协议</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--当前服务发布所依赖的协议；webserovice、Thrift、Hessain、http--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dubbo:protocol</span> <span class="attr">name</span>=<span class="string">&quot;dubbo&quot;</span> <span class="attr">port</span>=<span class="string">&quot;20880&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dubbo:protocol</span> <span class="attr">name</span>=<span class="string">&quot;rmi&quot;</span> <span class="attr">port</span>=<span class="string">&quot;1099&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后在发布接口的时候使用具体协议</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--服务发布的配置，需要暴露的服务接口--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">cluster</span>=<span class="string">&quot;failover&quot;</span> <span class="attr">retries</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">interface</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">ref</span>=<span class="string">&quot;providerService&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">cluster</span>=<span class="string">&quot;failover&quot;</span> <span class="attr">retries</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">interface</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">ref</span>=<span class="string">&quot;providerService&quot;</span> <span class="attr">protocol</span>=<span class="string">&quot;rmi&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>在输出日志中，就可以找到 <code>rmi</code>  发布的接口。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rmi://192.168.234.1:1099/com.sihai.dubbo.provider.service.ProviderService?anyhost=true&amp;application=provider&amp;bean.name=com.sihai.dubbo.provider.service.ProviderService&amp;cluster=failover&amp;dubbo=2.0.2&amp;generic=false&amp;interface=com.sihai.dubbo.provider.service.ProviderService&amp;methods=SayHello&amp;owner=sihai&amp;pid=796&amp;retries=2&amp;side=provider&amp;timestamp=1564281053185, dubbo version: 2.6.6, current host: 192.168.234.1</span><br></pre></td></tr></table></figure>
<p><strong>2、一种接口使用多种协议</strong><br>
声明协议和上面的方式一样，在发布接口的时候有一点不一样。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">cluster</span>=<span class="string">&quot;failover&quot;</span> <span class="attr">retries</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">interface</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">ref</span>=<span class="string">&quot;providerService&quot;</span> <span class="attr">protocol</span>=<span class="string">&quot;rmi,dubbo&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>说明： <code>protocol</code>  属性，可以用 <code>,</code>  隔开，使用多种协议。</p>
<h3 id="198-多注册中心"><a class="markdownIt-Anchor" href="#198-多注册中心">#</a> 1.9.8 多注册中心</h3>
<p><code>Dubbo</code>  支持同一服务向多注册中心同时注册，或者不同服务分别注册到不同的注册中心上去，甚至可以同时引用注册在不同注册中心上的同名服务。</p>
<p><strong>服务端多注册中心发布服务</strong></p>
<p>一个服务可以在不同的注册中心注册，当一个注册中心出现问题时，可以用其他的注册中心。</p>
<p><strong>注册</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--多注册中心--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">protocol</span>=<span class="string">&quot;zookeeper&quot;</span> <span class="attr">id</span>=<span class="string">&quot;reg1&quot;</span> <span class="attr">timeout</span>=<span class="string">&quot;10000&quot;</span> <span class="attr">address</span>=<span class="string">&quot;localhost:2181&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">protocol</span>=<span class="string">&quot;zookeeper&quot;</span> <span class="attr">id</span>=<span class="string">&quot;reg2&quot;</span> <span class="attr">timeout</span>=<span class="string">&quot;10000&quot;</span> <span class="attr">address</span>=<span class="string">&quot;localhost:2182&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">protocol</span>=<span class="string">&quot;zookeeper&quot;</span> <span class="attr">id</span>=<span class="string">&quot;reg3&quot;</span> <span class="attr">timeout</span>=<span class="string">&quot;10000&quot;</span> <span class="attr">address</span>=<span class="string">&quot;localhost:2183&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>发布服务</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--服务发布的配置，需要暴露的服务接口--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">cluster</span>=<span class="string">&quot;failover&quot;</span> <span class="attr">retries</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">interface</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">ref</span>=<span class="string">&quot;providerService&quot;</span> <span class="attr">registry</span>=<span class="string">&quot;reg1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">cluster</span>=<span class="string">&quot;failover&quot;</span> <span class="attr">retries</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">interface</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">ref</span>=<span class="string">&quot;providerService&quot;</span> <span class="attr">protocol</span>=<span class="string">&quot;rmi&quot;</span> <span class="attr">registry</span>=<span class="string">&quot;reg2&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>说明：使用 <code>registry=&quot;reg2&quot;</code>  指定该接口使用的注册中心，同时也可以使用多个 <code>，</code> 用，隔开，例如， <code>registry=&quot;reg1,,reg2&quot;</code> 。</p>
<p><strong>消费端多注册中心引用服务</strong></p>
<p>首先，先向不同注册中心注册；</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--多注册中心--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">protocol</span>=<span class="string">&quot;zookeeper&quot;</span> <span class="attr">id</span>=<span class="string">&quot;reg1&quot;</span> <span class="attr">timeout</span>=<span class="string">&quot;10000&quot;</span> <span class="attr">address</span>=<span class="string">&quot;localhost:2181&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">protocol</span>=<span class="string">&quot;zookeeper&quot;</span> <span class="attr">id</span>=<span class="string">&quot;reg2&quot;</span> <span class="attr">timeout</span>=<span class="string">&quot;10000&quot;</span> <span class="attr">address</span>=<span class="string">&quot;localhost:2182&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">protocol</span>=<span class="string">&quot;zookeeper&quot;</span> <span class="attr">id</span>=<span class="string">&quot;reg3&quot;</span> <span class="attr">timeout</span>=<span class="string">&quot;10000&quot;</span> <span class="attr">address</span>=<span class="string">&quot;localhost:2183&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>其次，不同的消费端服务引用使用不同的注册中心；</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--不同的服务使用不同的注册中心--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:reference</span> <span class="attr">cluster</span>=<span class="string">&quot;failover&quot;</span> <span class="attr">retries</span>=<span class="string">&quot;2&quot;</span> <span class="attr">check</span>=<span class="string">&quot;false&quot;</span> <span class="attr">id</span>=<span class="string">&quot;providerService&quot;</span></span></span><br><span class="line"><span class="tag">                     <span class="attr">interface</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span> <span class="attr">registry</span>=<span class="string">&quot;reg1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:reference</span> <span class="attr">cluster</span>=<span class="string">&quot;failover&quot;</span> <span class="attr">retries</span>=<span class="string">&quot;2&quot;</span> <span class="attr">check</span>=<span class="string">&quot;false&quot;</span> <span class="attr">id</span>=<span class="string">&quot;providerService2&quot;</span></span></span><br><span class="line"><span class="tag">                     <span class="attr">interface</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span> <span class="attr">registry</span>=<span class="string">&quot;reg2&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>说明：上面分别使用注册中心 <code>1</code>  和注册中心 <code>2</code> 。</p>
<h3 id="199-多版本"><a class="markdownIt-Anchor" href="#199-多版本">#</a> 1.9.9 多版本</h3>
<p>不同的服务是有版本不同的，版本可以更新并且升级，同时，不同的版本之间是不可以调用的。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--服务发布的配置，需要暴露的服务接口--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">cluster</span>=<span class="string">&quot;failover&quot;</span> <span class="attr">retries</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">interface</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">ref</span>=<span class="string">&quot;providerService&quot;</span> <span class="attr">registry</span>=<span class="string">&quot;reg1&quot;</span> <span class="attr">version</span>=<span class="string">&quot;1.0.0&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">cluster</span>=<span class="string">&quot;failover&quot;</span> <span class="attr">retries</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">interface</span>=<span class="string">&quot;com.sihai.dubbo.provider.service.ProviderService&quot;</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">ref</span>=<span class="string">&quot;providerService&quot;</span> <span class="attr">protocol</span>=<span class="string">&quot;rmi&quot;</span> <span class="attr">registry</span>=<span class="string">&quot;reg2&quot;</span> <span class="attr">version</span>=<span class="string">&quot;1.0.0&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>加入了版本控制。</p>
<h3 id="1910-日志管理"><a class="markdownIt-Anchor" href="#1910-日志管理">#</a> 1.9.10 日志管理</h3>
<p><code>dubbo</code>  也可以将日志信息记录或者保存到文件中的。</p>
<p>1、使用 <code>accesslog</code>  输出到 <code>log4j</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dubbo:protocol</span> <span class="attr">accesslog</span>=<span class="string">&quot;true&quot;</span> <span class="attr">name</span>=<span class="string">&quot;dubbo&quot;</span> <span class="attr">port</span>=<span class="string">&quot;20880&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:protocol</span> <span class="attr">accesslog</span>=<span class="string">&quot;true&quot;</span> <span class="attr">name</span>=<span class="string">&quot;rmi&quot;</span> <span class="attr">port</span>=<span class="string">&quot;1099&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>2、输出到文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dubbo:protocol</span> <span class="attr">accesslog</span>=<span class="string">&quot;http://localhost/log.txt&quot;</span> <span class="attr">name</span>=<span class="string">&quot;dubbo&quot;</span> <span class="attr">port</span>=<span class="string">&quot;20880&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dubbo:protocol</span> <span class="attr">accesslog</span>=<span class="string">&quot;http://localhost/log2.txt&quot;</span> <span class="attr">name</span>=<span class="string">&quot;rmi&quot;</span> <span class="attr">port</span>=<span class="string">&quot;1099&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="关于我"><a class="markdownIt-Anchor" href="#关于我">#</a> 关于我</h2>
<p>Brath 是一个热爱技术的 Java 程序猿，公众号「InterviewCoder」定期分享有趣有料的精品原创文章！</p>
<p><img src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E4%BA%8C%E7%BB%B4%E7%A0%81plus.png" alt="InterviewCoder"></p>
<p>非常感谢各位人才能看到这里，原创不易，文章如果有帮助可以关注、点赞、分享或评论，这都是对我的莫大支持！</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>【Dubbo】Dubbo详解，用心看这一篇文章就够了【重点】</p><p><a href="http://example.com/2023/04/27/【Dubbo】Dubbo详解，用心看这一篇文章就够了【重点】/">http://example.com/2023/04/27/【Dubbo】Dubbo详解，用心看这一篇文章就够了【重点】/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Brath</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2023-04-27</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2023-04-29</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="sharethis-inline-share-buttons"></div><script src="https://brath.cn" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>爱发电</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="https://brath.cloud/zfb.jpg" alt="支付宝"></span></a><a class="button donate" href="https://brath.cloud/%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E5%AE%9D%E4%BA%8C%E5%90%88%E4%B8%80.png" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>送我杯咖啡</span></a><a class="button donate" href="https://brath.cloud/%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E5%AE%9D%E4%BA%8C%E5%90%88%E4%B8%80.png" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="https://brath.cloud/wx.jpg" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2023/04/29/%E3%80%90%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E3%80%9123%20%E7%A7%8D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3%EF%BC%88%E5%85%A823%E7%A7%8D%EF%BC%89/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">【设计模式】23 种设计模式详解（全23种）</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2023/04/27/%E3%80%90MySql%E3%80%9121%E4%B8%AAMySQL%E8%A1%A8%E8%AE%BE%E8%AE%A1%E7%9A%84%E7%BB%8F%E9%AA%8C%E5%87%86%E5%88%99/"><span class="level-item">【MySql】21个MySQL表设计的经验准则</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="SOHUCS" sid="2023/04/27/【Dubbo】Dubbo详解，用心看这一篇文章就够了【重点】/"></div><script charset="utf-8" src="https://changyan.sohu.com/upload/changyan.js"></script><script>window.changyan.api.config({appid: 'cywzQRCbe',conf: '485cd826ef6d780dcea71d0f3b37304a'});</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-06T09:23:40.000Z">2023-05-06</time></p><p class="title"><a href="/2023/05/06/%E3%80%90%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E3%80%91%E6%89%8B%E5%86%99%E5%AE%9E%E7%8E%B0Map/">【数据结构】手写实现Hash表，并解决哈希冲突</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-06T07:53:40.000Z">2023-05-06</time></p><p class="title"><a href="/2023/05/06/%E3%80%90%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E3%80%91%E6%89%8B%E5%86%99%E5%AE%9E%E7%8E%B0ArrayList/">【数据结构】手写实现ArrayList</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-06T05:53:40.000Z">2023-05-06</time></p><p class="title"><a href="/2023/05/06/%E3%80%90%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E3%80%91%E6%89%8B%E5%86%99%E5%AE%9E%E7%8E%B0LinkedList/">【数据结构】手写实现LinkedList</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-05T05:58:11.000Z">2023-05-05</time></p><p class="title"><a href="/2023/05/05/%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E7%AE%97%E6%B3%95%E7%9A%84%E6%97%B6%E9%97%B4%E4%B8%8E%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/">【算法】算法的时间与空间复杂度</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-05T01:57:09.000Z">2023-05-05</time></p><p class="title"><a href="/2023/05/05/%E3%80%90IDEA%E3%80%91IDEA%E7%9A%84debug%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7%E8%AF%A6%E8%A7%A3/">【IDEA】IDEA的debug调试技巧详解</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/"><span class="level-start"><span class="level-item">2023</span></span><span class="level-end"><span class="level-item tag">37</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/"><span class="level-start"><span class="level-item">2022</span></span><span class="level-end"><span class="level-item tag">51</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/"><span class="level-start"><span class="level-item">2021</span></span><span class="level-end"><span class="level-item tag">44</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/"><span class="level-start"><span class="level-item">2020</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li></ul></div></div></div><!--!--><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://brath4.oss-cn-shenzhen.aliyuncs.com/picgo/%E4%BA%8C%E7%BB%B4%E7%A0%81plus.png" alt="InterviewCoder"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">InterviewCoder</p><p class="is-size-6 is-block">面试记官方公众号</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">139</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">0</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://mp.weixin.qq.com/s/jWs6lLHl5L-atXJhHc4YvA" target="_blank" rel="noopener">关注我</a></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://brath.cloud/me.png" alt="Brath"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Brath</p><p class="is-size-6 is-block">技能改变人生，知识改变命运。</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国·江苏·无锡</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">139</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">0</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/Guoqing815" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Guoqing815"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Gitee" href="https://gitee.com/Guoqing-Li"><i class="fab fa-gitee"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://schokolade.cn/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">泠灵(特别呜谢)</span></span><span class="level-right"><span class="level-item tag">schokolade.cn</span></span></a></li><li><a class="level is-mobile" href="https://gitee.com/Guoqing-Li" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Gitee(码云)</span></span><span class="level-right"><span class="level-item tag">gitee.com</span></span></a></li><li><a class="level is-mobile" href="https://blog.csdn.net/Brath?type=blog" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">CSDN</span></span><span class="level-right"><span class="level-item tag">blog.csdn.net</span></span></a></li><li><a class="level is-mobile" href="https://juejin.cn/user/settings/profile" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">掘金</span></span><span class="level-right"><span class="level-item tag">juejin.cn</span></span></a></li><li><a class="level is-mobile" href="https://oss.console.aliyun.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">AliCloud(阿里云)</span></span><span class="level-right"><span class="level-item tag">oss.console.aliyun.com</span></span></a></li><li><a class="level is-mobile" href="https://cloud.tencent.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">TencentCloud(腾讯云)</span></span><span class="level-right"><span class="level-item tag">cloud.tencent.com</span></span></a></li><li><a class="level is-mobile" href="https://www.zhipin.com/web/user/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">BOSS</span></span><span class="level-right"><span class="level-item tag">www.zhipin.com</span></span></a></li><li><a class="level is-mobile" href="https://www.bilibili.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bilibili(B站)</span></span><span class="level-right"><span class="level-item tag">www.bilibili.com</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://brath.cloud/me.png" alt="Brath-Blog" height="28"></a><p class="is-size-7"><span>&copy; 2023 Brath</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p><p class="is-size-7">© 2029</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>